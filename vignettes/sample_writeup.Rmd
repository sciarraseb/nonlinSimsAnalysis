---
title             : "Is timing everything? Measurement timing and the ability to accurately model longitudinal data"
shorttitle        : "Measurement timing"
format          : "pandoc"
header-includes:
  - \usepackage{nccmath}
  - \usepackage{caption}
  - \usepackage{longtable}
  - \usepackage{setspace}
  - \usepackage{booktabs}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage{amsthm}
  - \usepackage{setspace} #needed to doublespace caption text (using \doublespacing)
  - \usepackage[labelfont = {bf, up}]{caption} 
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
  - \usepackage{upgreek}  #required for non-italicized Greek letters
  - \usepackage{subcaption}
  - \captionsetup[figure]{labelfont={normalfont, bf}, singlelinecheck=false, labelsep=newline}
  - \DeclareCaptionJustification{double}{\DoubleSpacing}
  - \DeclareCaptionFont{figCaptionFont}{\fontfamily{phv}} #sets caption font to sans serif font of Helvetica 
  - \DeclareCaptionFont{figCaptionSize}{\footnotesize} #set caption font size to footnote 
  - \DeclareCaptionFont{figCaptionStyle}{\textup}  #set caption font to non-italicized font  
  - \DeclareCaptionLabelSeparator{captionSep}{\newline\newline} #separates figure label and figure title with required white space
  - \captionsetup[figure]{labelfont={figCaptionStyle, bf}, font = {figCaptionFont,figCaptionSize, figCaptionStyle}, labelsep = captionSep, justification=raggedright}
  - \captionsetup[table]{font = {figCaptionFont,figCaptionSize,figCaptionStyle}, labelfont={bf}, labelsep=captionSep, justification = raggedright, margin = {0cm,0cm}}
  - \newenvironment{helvenv}{\fontfamily{phv}\selectfont}{}
  
#environment numbering 
  - \setcounter{section}{0} 
  - \makeatletter \renewcommand\thesection{} \renewcommand\thesubsection{\@arabic\c@section.\@arabic\c@subsection} \makeatother
  
author: 
  - name          : "Sebastian Sciarra "
    affiliation   : "1"
    corresponding : yes    
    email         : "ssciarra@uoguelph.ca"
affiliation: 
  - id            : "1"
    institution   : "University of Guelph"
keywords          : "measurement timing, nonlinear "
wordcount         : "5554 words"
floatsintext      : yes
figsintext        : yes 
figurelist        : no
tablelist         : no
footnotelist      : no
numbersections    : yes
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa7"
csl               : "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
classoption       : "man"
output            : papaja::apa6_pdf
editor_options: 
  markdown: 
    wrap: 72
bibliography: dissertation_references.bib
---

```{r package_loading, include=F}
#load packages
library(easypackages)
packages <- c('devtools','tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'nonlinSims','papaja', 
              'ggbrace', 'cowplot')
libraries(packages)
load_all()
```

```{r pre_knitting_setup, echo=F, eval=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1A.csv')  
exp_2 <- read_csv(file = 'data/exp_2.csv')
exp_3 <- read_csv(file = 'data/exp_3.csv')

#data cleaning procedure for each data set
#filter out values for each parameter in each condition 
exp_1_filtered <- remove_outliers(data = exp_1)
exp_2_filtered <- remove_outliers(data = exp_2)
exp_3_filtered <- remove_outliers(data = exp_3)
  
#convert variance values to SD values for random effect parameters 
exp_1_cleaned <- convert_var_to_sd(data = exp_1_filtered)
exp_2_cleaned <- convert_var_to_sd(data = exp_2_filtered)
exp_3_cleaned <- convert_var_to_sd(data = exp_3_filtered)

#compute summary values 
param_summary_exp_1 <- compute_parameter_summary(data = exp_1_cleaned, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2_cleaned, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3_cleaned, exp_num = 3)

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/param_summary_exp_3.RData')
```

```{r obsolete_metadata_storing_importing, eval=F}
##store classes of each column 
col_types_exp_1 <- unlist(lapply(X = param_summary_exp_1, FUN = class))
col_types_exp_2 <- unlist(lapply(X = param_summary_exp_2, FUN = class))
col_types_exp_3 <- unlist(lapply(X = param_summary_exp_3, FUN = class))

#create data.frame that stores classes of data columns 
col_types_df <- data.frame('exp_num' = c(rep(x = 1, times = length(col_types_exp_1)),
                                         rep(x = 2, times = length(col_types_exp_2)),
                                         rep(x = 3, times = length(col_types_exp_3))), 
                           'variable_types' = c(col_types_exp_1, col_types_exp_2, col_types_exp_3))

#create data fame that stores levels of factor variables 
exp_1_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_1)
exp_2_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_2)
exp_3_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_3)

##store classes of each column 
col_types_exp_1 <- unlist(lapply(X = param_summary_exp_1, FUN = class))
col_types_exp_2 <- unlist(lapply(X = param_summary_exp_2, FUN = class))
col_types_exp_3 <- unlist(lapply(X = param_summary_exp_3, FUN = class))

#create data.frame that stores classes of data columns 
col_types_df <- data.frame('exp_num' = c(rep(x = 1, times = length(col_types_exp_1)),
                                         rep(x = 2, times = length(col_types_exp_2)),
                                         rep(x = 3, times = length(col_types_exp_3))), 
                           'variable_types' = c(col_types_exp_1, col_types_exp_2, col_types_exp_3))

#create data fame that stores levels of factor variables 
exp_1_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_1)
exp_2_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_2)
exp_3_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_3)

#write meta data + data for factor levels 
write_csv(x = col_types_df, file = 'data/col_types.csv')
write_csv(x = exp_1_factor_levels, file = 'data/exp_1_factor_levels.csv')
write_csv(x = exp_2_factor_levels, file = 'data/exp_2_factor_levels.csv')
write_csv(x = exp_3_factor_levels, file = 'data/exp_3_factor_levels.csv')

#read in .csv files with experimental data already in summarized version 
col_types_df <-read_csv(file = 'data/col_types.csv')
exp_1_factor_levels <- read_csv(file = 'data/exp_1_factor_levels.csv')
exp_2_factor_levels <- read_csv(file = 'data/exp_2_factor_levels.csv')
exp_3_factor_levels <- read_csv(file = 'data/exp_3_factor_levels.csv')

#relevel factors columns 
param_summary_exp_1 <- relevel_factors(param_summary_data = param_summary_exp_1, factor_levels_df = exp_1_factor_levels)
param_summary_exp_2 <- relevel_factors(param_summary_data = param_summary_exp_2, factor_levels_df = exp_2_factor_levels)
param_summary_exp_3 <- relevel_factors(param_summary_data = param_summary_exp_3, factor_levels_df = exp_3_factor_levels)
```

```{r pre_knitting_setup_unfiltered, echo=F, eval=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1A.csv')  
exp_2 <- read_csv(file = 'data/exp_2.csv')
exp_3 <- read_csv(file = 'data/exp_3.csv')

#convert variance values to SD values for random effect parameters 
exp_1_cleaned <- convert_var_to_sd(data = exp_1)
exp_2_cleaned <- convert_var_to_sd(data = exp_2)
exp_3_cleaned <- convert_var_to_sd(data = exp_3)

#compute summary values 
param_summary_exp_1 <- compute_parameter_summary(data = exp_1_cleaned, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2_cleaned, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3_cleaned, exp_num = 3)

#necessary factor conversions 
param_summary_exp_1$number_measurements <- factor(param_summary_exp_1$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_1$midpoint <- factor(param_summary_exp_1$midpoint, levels = c(80, 180,280))

param_summary_exp_2$number_measurements <- factor(param_summary_exp_2$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_2$sample_size <- factor(param_summary_exp_2$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

param_summary_exp_3$number_measurements <- factor(param_summary_exp_3$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_3$sample_size <- factor(param_summary_exp_3$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/uf_param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/uf_param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/uf_param_summary_exp_3.RData')
```

```{r knitting_setup, echo=F}
#filtered data 
#param_summary_exp_1 <- readRDS(file = 'data/param_summary_exp_1.RData')
#param_summary_exp_2 <- readRDS(file = 'data/param_summary_exp_2.RData')
#param_summary_exp_3 <- readRDS(file = 'data/param_summary_exp_3.RData')

#unfiltered data 
param_summary_exp_1 <- readRDS(file = 'data/uf_param_summary_exp_1.RData')
param_summary_exp_2 <- readRDS(file = 'data/uf_param_summary_exp_2.RData')
param_summary_exp_3 <- readRDS(file = 'data/uf_param_summary_exp_3.RData')

#create condition summary data sets 
cond_summary_exp_1 <- compute_condition_summary(param_summary_data = param_summary_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))
cond_summary_exp_2 <- compute_condition_summary(param_summary_data = param_summary_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))
cond_summary_exp_3 <- compute_condition_summary(param_summary_data = param_summary_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))

#create analytical versions of summary data 
exp_1_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_1, exp_num = 1)
exp_2_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_2, exp_num = 2)
exp_3_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_3, exp_num = 3)
```

# Results

## Pre-processing of data and model convergence

After simulations were conducted, non-converged models (and their corresponding parameter estimates) were removed from subsequent analyses. Tables \ref{tab:conv-exp-1}--\ref{tab:conv-exp-3} in [Appendix A][Appendix A: Convergence rates] provide the convergence success rates for each condition in each of the three simulation experiments. Model convergence was almost always above 90% and occurred in the following frequencies in each experiment: 

* Experiment 1: two instances of sub-90% model convergence rates (see Table \ref{tab:conv-exp-1})
* Experiment 2: two instances of sub-90% model convergence rates (see Table \ref{tab:conv-exp-2})
* Experiment 3: two instances of sub-90% model convergence rates (see Table \ref{tab:conv-exp-3})

\noindent
Note that all instances of sub-90% model convergence occurred when five measurements were taken. 


## Review of logistic function parameters

```{r logistic-interpretation-plot, eval=F}
#setup variables for logistic curve 
time <- seq(from = 1, to = 360, by = 1)
theta <- 3
alpha <- 3.32
beta <- 180
gamma <- 40

logistic_data <- data.frame('day' = time, 
                            'curve_score' = theta + (alpha - theta)/(1 + exp((beta - time)/gamma))) 

#make first and last values exactly equal to theta and alpha 
logistic_data$curve_score[c(1, 360)] <- c(theta, alpha)

baseline <- logistic_data$curve_score[logistic_data$day == 1]
halfway_value <- logistic_data$curve_score[logistic_data$day == beta]
triquarter_value <- logistic_data$curve_score[logistic_data$day == beta + gamma]
maximal_elevation <- logistic_data$curve_score[logistic_data$day == 360]

#df for points 
point_df <- data.frame('day' = c(1, beta, beta+gamma, 360), 
                       'curve_score' = c(baseline, halfway_value, triquarter_value, maximal_elevation), 
                       'beta_brace' = factor(c('beta', 'beta', 'NA', 'NA')),
                       'beta_label' = rep('d[beta]', times = 4), 
                       
                       'gamma_brace' = factor(c('NA', 'gamma', 'gamma', 'NA')), 
                       'gamma_label' = rep('d[gamma]', times = 4),
                       
                       'total_brace' = factor(c('total', 'NA', 'NA', 'total')), 
                       'total_label' = rep('d[total]', times = 4))

font_size <- 8
title_font <- 30
axis_text_size <- 20
axis_title_size <- 24

theta_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(A:~Baseline~(theta)))) + 
  #theta 
  geom_segment(x = 10, xend = 360, y = baseline, yend = baseline, linetype = 5, size = 1) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = baseline, yend = baseline, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text', x = 440, y = 3.05, label = 'Baseline \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 440, y = 3.00, label = 'theta == 3.00', parse = T, size = font_size) + 

   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))


alpha_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(B:~Maximal~elevation~(alpha)))) + 
  #theta 
  geom_segment(x = -3, xend = 360, y = maximal_elevation, yend = maximal_elevation, linetype = 5, size = 1) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = maximal_elevation, yend = maximal_elevation, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text',  x = 440, y = 3.27, label = 'Maximal \nelevation \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 440, y = 3.20, label = 'alpha == 3.32', parse = T, size = font_size) + 

   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))


beta_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label =  expression(bold(A:~Days~to~halfway~elevation~(beta)))) + 
  #theta 
    geom_segment(x = 130, xend = 175, y = 3.16, yend = 3.16, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 180, xend = 180, y = 3.16, yend = 2.98, linetype = 2, size = 1) + #vertical dashed line 
  annotate(geom = 'text', x = 55, y = 3.14, label = 'Days to halfway \nelevation', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 55, y = 3.08, label = 'beta == 180~days', parse = T, size = font_size) + 
  
   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))

gamma_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(D:~`Halfway-triquarter`~delta~(gamma)))) +
  
  #gamma 
  geom_segment(x = 175, xend = 215, y = 3.233, yend = 3.233, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 220, xend = 220, y = 3.233, yend = 2.98, linetype = 2, size = 1) + #vertical dashed line 
  annotate(geom = 'text', x = 100, y = 3.21, label = 'Halfway-triquarter \ndelta', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 105, y = 3.15, label = 'gamma == 40~days', parse = T, size = font_size) + 
  
  #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))

combined_plot <- ggarrange(theta_plot, alpha_plot, beta_plot, gamma_plot)
ggsave(plot = combined_plot, filename = 'Figures/combined_plot.pdf', width = 18, height = 12)


complete_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 1) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360))+
  annotate(geom = 'text', x = 50, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = 5) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 3) +

  #beta
  annotate(geom = 'text', x = 85, y = 3.15, label = 'Days to halfway \nelevation', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 90, y = 3.12, label = 'beta == 180~days', parse = T, size = font_size) +
  geom_segment(x = 130, xend = 175, y = 3.16, yend = 3.16, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 180, xend = 180, y = 3.16, yend = 2.98, linetype = 2, size = 0.3) + #vertical dashed line 
  
  #gamma
  annotate(geom = 'text', x = 97, y = 3.233, label = 'Halfway-triquarter delta', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 105, y = 3.21, label = 'gamma == 40~days', parse = T, size = font_size) + 
  geom_segment(x = 175, xend = 215, y = 3.233, yend = 3.233, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 220, xend = 220, y = 3.233, yend = 2.98, linetype = 2, size = 0.3)+  #vertical dashed line  
  
  coord_cartesian(clip = 'off') + 
  #theta 
  geom_segment(x = 10, xend = 360, y = baseline, yend = baseline, linetype = 3, size = 0.3) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = baseline, yend = baseline, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text', x = 425, y = 3.03, label = 'Baseline \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 425, y = 3.00, label = 'theta == 3.00', parse = T, size = font_size) + 

  #alpha 
  geom_segment(x = -3, xend = 360, y = maximal_elevation, yend = maximal_elevation, linetype = 3, size = 0.3) + #vertical dashed line  
  geom_segment(x = 400, xend = 365, y = maximal_elevation, yend = maximal_elevation, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) +      #horizontal arrow
  annotate(geom = 'text', x = 430, y = 3.30, label = 'Maximal \nelevation \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 430, y = 3.26, label = 'alpha == 3.32', parse = T, size = font_size) + 
  
   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold',size = title_font), 
        axis.title = element_text(size = 16), 
        axis.text = element_text(size = 13, colour = 'black'))
  
    ##brace information
  #stat_brace(data = point_df %>% filter(beta_brace == 'beta'), 
  #           mapping = aes(group = beta_brace, label = beta_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) + 
  #
  #stat_brace(data = point_df %>% filter(gamma_brace == 'gamma'), 
  #           mapping = aes(group = gamma_brace, label = gamma_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) +
  #
  #stat_brace(data = point_df %>% filter(total_brace == 'total'), 
  #           mapping = aes(group = total_brace, label = total_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) + 
  #
  #description box 
  #annotate(geom = 'rect', xmin = 235, xmax = 355, ymin = 3.02, ymax = 3.15, alpha = 0.1, color = 'black') + 
  #annotate(geom = 'text', x = 295, y = 3.13, label = 'd[total] == alpha~-~theta == 0.32', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.09, label = 'd[beta] == 0.5~(d[total]) == 0.16', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.06, label = 'd[gamma] == 0.23~(d[total]) == 0.07', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.03, label = 'd[beta]~+~d[gamma] == 0.73~(d[total]) == 0.23', parse = T, size = 4.5) + 

ggsave(plot = complete_plot, filename = 'Figures/complete_logistic_exp_plot.pdf', width = 9, height = 6)
```

Data in each experimental condition were generated using the the logistic function show below:

```{=tex}
\begin{align}
y = \uptheta + \frac{\upalpha - \uptheta}{{1 + e^\frac{\upbeta - time_i}{\upgamma}}}.
\end{align}
```

Figure \ref{fig:combined_plot}A shows that the baseline parameter ($\uptheta$) sets the starting value of the of curve, which 
in the current example has a value of 3.00 ($\uptheta$ = 3.00). Figure \ref{fig:combined_plot}B shows that the maximal 
elevation parameter ($\upalpha$) sets the ending value of the curve, which in the current example has a value of 3.32 ($\upalpha$ = 3.32).   Figure \ref{fig:combined_plot}C shows that the days-to-halfway elevation parameter ($\upbeta$) sets the number of days
needed to reach 50% of the difference between the baseline and maximal elevation. In the current example, the baseline-maximal elevation difference is 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32), and so the days-to-halfway elevation parameter defines the number of days needed
to reach a value of 3.16. Given that the days-to-halfway elevation parameter is set to 180 in the current example ($\upbeta = 180$), then 180 days
are neededto go from a value of 3.00 to a value of 3.16. Figure \ref{fig:combined_plot}D shows that the halfway-triquarter delta parameter ($\upgamma$) sets the number of days needed to go from halfway elevation to approximately 73% of the baseline-maximal elevation difference of 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32. Given that 73% of the baseline-maximal elevation difference is 0.23 and the halfway-triquarter delta 
is set to 40 days ($\upgamma = 40$), then 40 days are needed to go from the halfway point of 3.16 to the triquarter point of approximately 3.23. 

```{=tex}
\begin{figure}
  \caption{Description of Each Parameter of Four-Parameter Logistic Function}
  \label{fig:combined_plot}
  \includegraphics{Figures/combined_plot} \hfill{}
  \caption*{Note. \textup{Panel A shows that the baseline parameter ($\uptheta$) sets the starting value of the of curve, which 
in the current example has a value of 3.00 ($\uptheta$ = 3.00). Panel B shows that the maximal elevation parameter ($\upalpha$) sets the ending value of the curve, which in the current example has a value of 3.32 ($\upalpha$ = 3.32). Panel C shows that the days-to-halfway elevation parameter ($\upbeta$) sets the number of days needed to reach 50\% of the difference between the baseline and maximal elevation. In the current example, the baseline-maximal elevation difference is 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32), and so the days-to-halfway elevation parameter defines the number of days needed to reach a value of 3.16. Given that the days-to-halfway elevation parameter is set to 180 in the current example ($\upbeta = 180$), then 180 days are neededto go from a value of 3.00 to a value of 3.16. Panel D shows that the halfway-triquarter delta parameter ($\upgamma$) sets the number of days needed to go from halfway elevation to approximately 73\% of the baseline-maximal elevation difference of 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32. Given that 73\% of the baseline-maximal elevation difference is 0.23 and the halfway-triquarter delta is set to 40 days ($\upgamma = 40$), then 40 days are needed to go from the halfway point of 3.16 to the triquarter point of approximately 3.23).}}
\end{figure}
```


## A note on variability 

Variability in each parameter will be with the middle 95% of estimated values. Consider an example where 
variability in the days-to-halfway elevation parameter ($\upbeta$) is being modelled in an experimental condition. Figure \ref{fig:beta-variability-example} shows a probability density distribution of values estimated for the days-to-halfway elevation parameter ($\upbeta$) parameter. The region of the density distribution shaded in gray represents the middle 95% of values estimated for the days-to-halfway elevation parameter ($\upbeta$) and the upper and lower values of this region set the upper and lower values of the error bar that lies above the density distribution. 

Figure \ref{fig:beta-density-to-param-plot} shows an example of how variability in one parameter is modelled for multiple experimental conditions. In the current example where variability is being modelled in the days-to-halfway elevation parameter ($\upbeta$), densities are generated for each sample size-measurement number condition and the range covered by the middle 95% of values in each density is used to create an error bar. The plot at the bottom of Figure \ref{fig:beta-density-to-param-plot} is a **parameter estimation plot** for the days-to-halfway elevation parameter ($\upbeta$) and it shows the accuracy with which $\upbeta$ is modelled across all sample size-measurement number combinations when measurement spacing is equal.

```{r variability-histograms, eval=F}
exp_2 <- read_csv(file = 'data/exp_2.csv')

generate_param_density_plot(raw_exp_data = exp_2, param_summary_data = param_summary_exp_2, spacing = 'Equal', num_measurements = 5, sample_size = 30)

```
  
```{=tex}
\begin{figure}
  \caption{Density Distribution of Values Estimated for the Days-to-Halfway Elevation Parameter ($\upbeta$)}
  \label{fig:beta-histogram}
  \includegraphics{Figures/beta_fixed_Equal_5_30} \hfill{}
  \caption*{Note. \textup{Area shaded in gray represents the middle 95\% of estimated values. The upper and lower limits of the shaded areay define the upper and lower limits of the error bar on top of the density distribution.}}
\end{figure}
```

```{r beta-density-to-param-plot, eval=F}
num_measurements_levels <- as.numeric(levels(param_summary_exp_2$number_measurements))
sample_size_levels <- range(as.numeric(levels(param_summary_exp_2$sample_size)))
exp_2 <- read_csv(file = 'data/exp_2.csv')

for (num_measurements in num_measurements_levels) {
  
  for(sample_size in sample_size_levels){
    
    generate_param_density_plot(raw_exp_data = exp_2, param_summary_data = param_summary_exp_2, 
                                spacing = 'Equal', num_measurements = num_measurements,
                                sample_size = sample_size)
  }
}

```

```{=tex}
\begin{figure}
  \caption{Depicting of Modelling Procedure for Generating Error Bars on Parameter Estimation Accuracy}
  \label{fig:beta-density-to-param-plot}
  \includegraphics[height = 25cm, width = 10cm]{Figures/density_to_param_plot} \hfill{}
  \caption*{Note. \textup{Densities are generated for each experimental condition and the range covered by the middle 95\% of values in each density is used to create an error bar. The plot at the bottom is a \textbf{parameter estimation plot} for the days-to-halfway elevation parameter ($\upbeta$) and it shows the accuracy with which $\upbeta$ is estimated across all sample size-measurement number combinations when measurement spacing is equal.}}
\end{figure}
```


## Results primer

Figure \ref{fig:results_plot_primer) shows that each parameter of the logistic function (for a review, see Figure \ref{fig:combined_plot}) is modelled as a fixed and random effect. Values predicted for fixed-effect parameters are constant across all individuals, whereas values predicted for random-effect parameters are unique across individuals. In addition to the random- and fixed-effects estimated for each logistic function parameter, an error term ($\upepsilon$) is also estimated. For each experimental condition, parameter estimation plots will be created for each logistic function parameter that show the accuracy with which each parameter is modelled. 

One important point to mention is that the results of Experiments 1--3 will focus on the effects of experimental variables on day-unit parameters (days to halfway elevation[$\upbeta$] and halfway-triquarter delta[$\upgamma$]). Across all three experiments, experimental variables had little effect on the estimation of Likert-unit parameters (baseline [$\uptheta$]) and maximal elevation [$\upalpha$]), and so including their estimation plots add unnecessary length and complexity to the results sections of each experiment. Note that the parameter estimation plots have not been 
completely omitted from the report and have been included in [Appendix C][Appendix B: Parameter estimation plots for Likert-unit parameters]. 

```{=tex}
\begin{figure}[H]
  \caption{Set of Parameters Estimated in Each Simulation Experiment}
  \label{fig:results_plot_primer}
  \includegraphics[height = 33cm, width = 15cm]{Figures/logistic_results_plot} \hfill{}
  \caption*{Note. \textup{Each parameter of the logistic function (for a review, see Figure \ref{fig:combined_plot}) is modelled as a fixed and random effect. Values predicted for fixed-effect parameters are constant across all individuals, whereas values predicted for random-effect parameters are unique across individuals. In addition the random- and fixed-effects estimated for each logistic function parameter, an error term ($\upepsilon$) is also estimated. For each experimental condition, parameter estimation plots will be created for each logistic function parameter that show the accuracy with which each parameter is modelled.}}
\end{figure}
```

## Experiment 1

Experiment 1 investigated whether an optimal measurement spacing
schedule exists to handle uncertainty in the pattern of change. Three
variables were manipulated: measurement spacing, number of measurements,
and pattern of change. Measurement spacing was manipulated by creating
schedules defined by either equal, time-increasing, time-decreasing, or
middle-and-extreme spacing. The levels for number of measurements were
set to either 5, 7, 9, or 11 measurements, and the pattern of change was
manipulated such that the halfway point occurred at either 80, 180, or
280 days.

### Equal spacing

```{r plots-equal-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Equal spacing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -20, beta_upper = 20, ticks = 5)
```

```{r text-values-equal-exp1, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp1_plot_equal} shows the estimation accuracy for the day-unit parameters when equal spacing is used (error bars represent the middle 95% of estimated values and shaded horizontal lines indicate the population
values). Panels A--B show the parameter estimation plots for the fixed- and random-effect values of the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and $\upbeta_{randoom}$), respectively. Panels C--D show the parameter estimation plots for the fixed- and random-effect values of the triquarter-halfway delta parameter ($\upgamma_{fixed}$ and $\upgamma_{randoom}$), respectively. Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value.

The estimation for the fixed- and random-effect values of
the midpoint ($\upbeta_{fixed}$ and $\upbeta_{random}$; Figure
\ref{fig:exp1_plot_equal}F--G) and the satiation point
($\upgamma_{fixed}$ and $\upgamma_{random}$; Figure
\ref{fig:exp1_plot_equal}H--I) incur considerable variability when five
measurements are taken, but this variability largely diminishes when
seven or more measurements are taken. For example, when five
measurements are taken and the midpoint occurs at 80 days, the middle
95% of values estimated for the fixed-effect parameter of the satiation
point ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_equal}H) has a
plausible range that spans
`r gamma_equal_5_180$upper_ci - gamma_equal_5_180$lower_ci` days
(`r gamma_equal_5_180$upper_ci` to `r gamma_equal_5_180$lower_ci` days),
but the width of this range decreases to approximately
`r gamma_equal_7_180$upper_ci - gamma_equal_7_180$lower_ci` days when
seven measurements are taken (`r gamma_equal_7_180$upper_ci` to
`r gamma_equal_7_180$lower_ci` days).

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plot for Day-Unit Parameters With Equal Spacing}
  \label{fig:exp1_plot_equal}
  \includegraphics{Figures/exp1_plot_days_equal spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect parameter units are in standard deviation units and that sample size is fixed to 225 (\textit{N} = 225). Panels A--B show the parameter estimation plots for the fixed- and random-effect values of the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and $\upbeta_{randoom}$), respectively. Panels C--D show the parameter estimation plots for the fixed- and random-effect values of the triquarter-halfway delta parameter ($\upgamma_{fixed}$ and $\upgamma_{randoom}$), respectively. Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval increasing spacing

```{r plots-time-increasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -70, beta_upper = 60, ticks = 10)
```

```{r text-values-time-increasing-exp1, echoF}
beta_time_inc_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_increasing} shows the estimation accuracy
(in terms of Likert-based or day-based units)each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

As in the equal-spacing condition, estimation of Likert-unit parameters
appears to be unaffected, whereas the estimation of day-unit parameters
appears to incur considerable variability. Two general trends exist in
the estimates of day-based parameters. First, for the fixed-effect
midpoint and satiation point parameters ($\upbeta_{fixed}$ and
$\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G),
variability increases exponentially when five measurements are taken and
the and the midpoint moves from 80 to 280 days. As an example, the
middle 95% of values estimated for the fixed-effect midpoint parameter
($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F) has
widths of `r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci`
(`r beta_time_inc_5_80$upper_ci` days to `r beta_time_inc_5_80$lower_ci`
days) and
`r beta_time_inc_5_180$upper_ci - beta_time_inc_5_180$lower_ci` days
(`r beta_time_inc_5_180$lower_ci` days to
`r beta_time_inc_5_180$upper_ci` days) when the midpoint occurs at 80
and 180 days, respectively, but the width increases to
`r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
(`r beta_time_inc_5_280$lower_ci` days to
`r beta_time_inc_5_280$upper_ci` days) when the midpoint occurs at 280
days. Second, the large amount of variability observed for the
fixed-effect midpoint and satiation point parameters largely disappears
when seven or more measurements are taken. As an example, the wide range
of `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
for the fixed-effect midpoint parameter decreases to
`r beta_time_inc_7_280$upper_ci - beta_time_inc_7_280$lower_ci` days
when seven measurements are taken (see (Figure
\ref{fig:exp1_plot_time_increasing}F)).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Increasing Spacing}
  \label{fig:exp1_plot_time_increasing}
  \includegraphics{Figures/exp1_plot_days_time-interval increasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval decreasing spacing

```{r plots-time-decreasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -60, beta_upper = 70, ticks = 10)
```

```{r text-values-time-decreasing-exp1, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_decreasing} shows the estimation accuracy
(in terms of Likert-based or day-based units)each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

As in the equal-spacing condition, estimation of Likert-unit parameters
appears to be unaffected, whereas the estimation of day-unit parameters
appears to incur considerable variability. Two general trends exist in
the estimates of day-based parameters. First, for the fixed-effect
midpoint and satiation point parameters ($\upbeta_{fixed}$ and
$\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G),
variability increases exponentially when five measurements are taken and
the midpoint moves from 280 to 80 days. As an example, the middle 95% of
values estimated for the fixed-effect midpoint parameter
($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_decreasing}F) has
widths of
`r beta_time_dec_5_280$upper_ci - beta_time_dec_5_280$lower_ci`
(`r beta_time_dec_5_280$upper_ci` days to
`r beta_time_dec_5_280$lower_ci` days) and
`r beta_time_dec_5_180$upper_ci - beta_time_dec_5_180$lower_ci` days
(`r beta_time_dec_5_180$lower_ci` days to
`r beta_time_dec_5_180$upper_ci` days) when the midpoint occurs at 280
and 180 days, respectively, but the width increases to
`r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days
(`r beta_time_inc_5_80$lower_ci` days to `r beta_time_inc_5_80$upper_ci`
days) when the midpoint occurs at 80 days. Second, the large amount of
variability observed for the fixed-effect midpoint and satiation point
parameters largely disappears when seven or more measurements are taken.
As an example, the wide range of
`r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days for
the fixed-effect midpoint parameter decreases to
`r beta_time_dec_7_280$upper_ci - beta_time_dec_7_280$lower_ci` days
when seven measurements are taken (see (Figure
\ref{fig:exp1_plot_time_increasing}F)).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Decreasing Spacing}
  \label{fig:exp1_plot_time_decreasing}
  \includegraphics{Figures/exp1_plot_days_time-interval decreasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Middle-and-extreme spacing

```{r plots-mid-ext-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -20, beta_upper = 20, ticks = 5)
```

```{r text-values-mid-ext-exp1, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_mid_ext} shows the estimation accuracy
(in terms of Likert-based or day-based units) each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Middle-and-Extreme Spacing}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp1_plot_days_time-interval decreasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```


### Summary of Experiment 1 
```{r plot-summary-exp1, include=F}

day_parms_exp_1_index <- which(str_detect(string = param_summary_exp_1$parameter, pattern = 'beta|gamma'))
day_param_exp_1 <- param_summary_exp_1[day_parms_exp_1_index, ]

cond_summary_exp_1 <- compute_condition_summary(param_summary_data = day_param_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))

generate_summary_facet_plot(condition_data = cond_summary_exp_1, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp2_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'midpoint', x_axis_name = 'Midpoint location (days)')


day_parms_exp_2_index <- which(str_detect(string = param_summary_exp_2$parameter, pattern = 'beta|gamma'))
day_param_exp_2 <- param_summary_exp_2[day_parms_exp_2_index, ]

cond_summary_exp_2 <- compute_condition_summary(param_summary_data = day_param_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))

generate_summary_facet_plot(condition_data = cond_summary_exp_2, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp2_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)')

day_parms_exp_3_index <- which(str_detect(string = param_summary_exp_3$parameter, pattern = 'beta|gamma'))
day_param_exp_3 <- param_summary_exp_3[day_parms_exp_3_index, ]

cond_summary_exp_3 <- compute_condition_summary(param_summary_data = day_param_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))

generate_summary_facet_plot(condition_data = cond_summary_exp_3, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp3_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)', facet_var = 'time_structuredness')


```


```{=tex}
\begin{figure}
  \caption{Parameter Estimate Accuracy Across Measurement Spacing Conditions in Experiment 1}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp1_summary_plot} \hfill{}
  \caption*{Note.}
\end{figure}
```




## Experiment 2

Experiment 2 investigated whether an optimal measurement spacing
schedule exists to handle uncertainty in the pattern of change. Three
variables were manipulated: measurement spacing, number of measurements,
and pattern of change. Measurement spacing was manipulated by creating
schedules defined by either equal, time-increasing, time-decreasing, or
middle-and-extreme spacing. The levels for number of measurements were
set to either 5, 7, 9, or 11 measurements, and the pattern of change was
manipulated such that the halfway point occurred at either 80, 180, or
280 days.

### Equal spacing

```{r plots-equal-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Equal spacing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2A_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-equal-exp2, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp2_plot_equal} shows the estimation accuracy (in terms
of Likert-based or day-based units)each of the nine estimated parameters
when equal spacing is used (error bars represent the middle 95% of
estimated values and shaded horizontal lines indicate the population
value). Panels A--E show the estimation accuracy for parameters measured
in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of
1--5) and Panels F--I show the estimation accuracy for parameters
measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F,
estimates for $\upbeta_{fixed}$ are centered around their corresponding
population values (80, 180, and 280 days), and so the y-axis represents
error (in number of days) from the population value.

Estimation of Likert-unit parameters appears to be unaffected, whereas
the estimation of day-unit parameters appears to incur considerable
variability. The estimation for the fixed- and random-effect values of
the midpoint ($\upbeta_{fixed}$ and $\upbeta_{random}$; Figure
\ref{fig:exp1_plot_equal}F--G) and the satiation point
($\upgamma_{fixed}$ and $\upgamma_{random}$; Figure
\ref{fig:exp1_plot_equal}H--I) incur considerable variability when five
measurements are taken, but this variability largely diminishes when
seven or more measurements are taken. For example, when five
measurements are taken and the midpoint occurs at 80 days, the middle
95% of values estimated for the fixed-effect parameter of the satiation
point ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_equal}H) has a
plausible range that spans
`r gamma_equal_5_180$upper_ci - gamma_equal_5_180$lower_ci` days
(`r gamma_equal_5_180$upper_ci` to `r gamma_equal_5_180$lower_ci` days),
but the width of this range decreases to approximately
`r gamma_equal_7_180$upper_ci - gamma_equal_7_180$lower_ci` days when
seven measurements are taken (`r gamma_equal_7_180$upper_ci` to
`r gamma_equal_7_180$lower_ci` days).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Equal Spacing in Experiment 2}
  \label{fig:exp2_plot_equal}
  \includegraphics{Figures/exp2_plot_days_equal spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval increasing spacing

```{r plots-time-increasing-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)

```

```{r text-values-time-increasing-exp2, echoF}
beta_time_inc_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp2_plot_time_increasing} shows the estimation accuracy
(in terms of Likert-based or day-based units)each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

As in the equal-spacing condition, estimation of Likert-unit parameters
appears to be unaffected, whereas the estimation of day-unit parameters
appears to incur considerable variability. Two general trends exist in
the estimates of day-based parameters. First, for the fixed-effect
midpoint and satiation point parameters ($\upbeta_{fixed}$ and
$\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G),
variability increases exponentially when five measurements are taken and
the and the midpoint moves from 80 to 280 days. As an example, the
middle 95% of values estimated for the fixed-effect midpoint parameter
($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F) has
widths of `r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci`
(`r beta_time_inc_5_80$upper_ci` days to `r beta_time_inc_5_80$lower_ci`
days) and
`r beta_time_inc_5_180$upper_ci - beta_time_inc_5_180$lower_ci` days
(`r beta_time_inc_5_180$lower_ci` days to
`r beta_time_inc_5_180$upper_ci` days) when the midpoint occurs at 80
and 180 days, respectively, but the width increases to
`r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
(`r beta_time_inc_5_280$lower_ci` days to
`r beta_time_inc_5_280$upper_ci` days) when the midpoint occurs at 280
days. Second, the large amount of variability observed for the
fixed-effect midpoint and satiation point parameters largely disappears
when seven or more measurements are taken. As an example, the wide range
of `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
for the fixed-effect midpoint parameter decreases to
`r beta_time_inc_7_280$upper_ci - beta_time_inc_7_280$lower_ci` days
when seven measurements are taken (see (Figure
\ref{fig:exp1_plot_time_increasing}F)).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Increasing Spacing in Experiment 2}
  \label{fig:exp2_plot_time_increasing}
  \includegraphics{Figures/exp2_plot_days_time-interval increasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval decreasing spacing

```{r plots-time-decreasing-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 195,
                               ticks = 5)
```

```{r text-values-time-decreasing-exp2, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp2_plot_time_decreasing} shows the estimation accuracy
(in terms of Likert-based or day-based units)each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

As in the equal-spacing condition, estimation of Likert-unit parameters
appears to be unaffected, whereas the estimation of day-unit parameters
appears to incur considerable variability. Two general trends exist in
the estimates of day-based parameters. First, for the fixed-effect
midpoint and satiation point parameters ($\upbeta_{fixed}$ and
$\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G),
variability increases exponentially when five measurements are taken and
the midpoint moves from 280 to 80 days. As an example, the middle 95% of
values estimated for the fixed-effect midpoint parameter
($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_decreasing}F) has
widths of
`r beta_time_dec_5_280$upper_ci - beta_time_dec_5_280$lower_ci`
(`r beta_time_dec_5_280$upper_ci` days to
`r beta_time_dec_5_280$lower_ci` days) and
`r beta_time_dec_5_180$upper_ci - beta_time_dec_5_180$lower_ci` days
(`r beta_time_dec_5_180$lower_ci` days to
`r beta_time_dec_5_180$upper_ci` days) when the midpoint occurs at 280
and 180 days, respectively, but the width increases to
`r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days
(`r beta_time_inc_5_80$lower_ci` days to `r beta_time_inc_5_80$upper_ci`
days) when the midpoint occurs at 80 days. Second, the large amount of
variability observed for the fixed-effect midpoint and satiation point
parameters largely disappears when seven or more measurements are taken.
As an example, the wide range of
`r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days for
the fixed-effect midpoint parameter decreases to
`r beta_time_dec_7_280$upper_ci - beta_time_dec_7_280$lower_ci` days
when seven measurements are taken (see (Figure
\ref{fig:exp1_plot_time_increasing}F)).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Decreasing Spacing in Experiment 2}
  \label{fig:exp2_plot_time_decreasing}
  \includegraphics{Figures/exp2_plot_days_time-interval decreasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Middle-and-extreme spacing

```{r plots-mid-ext-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-mid-ext-exp2, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_mid_ext} shows the estimation accuracy
(in terms of Likert-based or day-based units) each of the nine estimated
parameters when time-increasing spacing is used (error bars represent
the middle 95% of estimated values and shaded horizontal lines indicate
the population value). Panels A--E show the estimation accuracy for
parameters measured in Likert scale units ($\uptheta$ and $\upalpha$;
measured on a range of 1--5) and Panels F--I show the estimation
accuracy for parameters measured in day units ($\upbeta$ and
$\upgamma$). Note that, in Panel F, estimates for $\upbeta_{fixed}$ are
centered around their corresponding population values (80, 180, and 280
days), and so the y-axis represents error from the population value (in
number of days).

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Middle-and-Extreme Spacing in Experiment 2}
  \label{fig:exp2_plot_time_mid_ext}
  \includegraphics{Figures/exp2_plot_days_middle-and-extreme spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Summary of Experiment 2
```{r plot-summary-exp2, include=F}
generate_summary_facet_plot(condition_data = cond_summary_exp_2, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp2_', 
                            y_axis_var = 'mean_perc_error', y_axis_name = 'Parameter bias (percentage error)', 
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)')

```


```{=tex}
\begin{figure}
  \caption{Parameter Estimate Accuracy Across Measurement Spacing Conditions in Experiment 1}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp2_summary_plot} \hfill{}
  \caption*{Note.}
\end{figure}
```





## Experiment 3

Experiment 3 investigated whether an optimal measurement spacing
schedule exists to handle uncertainty in the pattern of change. Three
variables were manipulated: measurement spacing, number of measurements,
and pattern of change. Measurement spacing was manipulated by creating
schedules defined by either equal, time-increasing, time-decreasing, or
middle-and-extreme spacing. The levels for number of measurements were
set to either 5, 7, 9, or 11 measurements, and the pattern of change was
manipulated such that the halfway point occurred at either 80, 180, or
280 days.

### Time-structured data

```{r plots-time-structured-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'time_structured',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-time-structured-exp3, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp3_plot_time_structured} shows the estimation accuracy (in terms
of Likert-based or day-based units)each of the nine estimated parameters
when equal spacing is used (error bars represent the middle 95% of
estimated values and shaded horizontal lines indicate the population
value). Panels A--E show the estimation accuracy for parameters measured
in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of
1--5) and Panels F--I show the estimation accuracy for parameters
measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F,
estimates for $\upbeta_{fixed}$ are centered around their corresponding
population values (80, 180, and 280 days), and so the y-axis represents
error (in number of days) from the population value.


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Structured Data Experiment 3}
  \label{fig:exp3_plot_days_time_structured}
  \includegraphics{Figures/exp3_plot_days_time_structured} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-unstructured data (fast response)

```{r plots-fast-response-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'fast_response',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-fast-response-exp3, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp3_plot_equal} shows the estimation accuracy (in terms
of Likert-based or day-based units)each of the nine estimated parameters
when equal spacing is used (error bars represent the middle 95% of
estimated values and shaded horizontal lines indicate the population
value). Panels A--E show the estimation accuracy for parameters measured
in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of
1--5) and Panels F--I show the estimation accuracy for parameters
measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F,
estimates for $\upbeta_{fixed}$ are centered around their corresponding
population values (80, 180, and 280 days), and so the y-axis represents
error (in number of days) from the population value.


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Unstructured (Fast Response Rate) Data Experiment 3}
  \label{fig:exp3_plot_days_time_structured}
  \includegraphics{Figures/exp3_plot_days_fast_response} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```


### Time-unstructured data (slow response)

```{r plots-slow-response-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'slow_response',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-slow-response-exp3, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp3_plot_equal} shows the estimation accuracy (in terms
of Likert-based or day-based units)each of the nine estimated parameters
when equal spacing is used (error bars represent the middle 95% of
estimated values and shaded horizontal lines indicate the population
value). Panels A--E show the estimation accuracy for parameters measured
in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of
1--5) and Panels F--I show the estimation accuracy for parameters
measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F,
estimates for $\upbeta_{fixed}$ are centered around their corresponding
population values (80, 180, and 280 days), and so the y-axis represents
error (in number of days) from the population value.


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Unstructured (Slow Response Rate) Data Experiment 3}
  \label{fig:exp3_plot_days_time_structured}
  \includegraphics{Figures/exp3_plot_days_slow_response} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```


### Summary of Experiment 3
```{r plot-summary-exp3, include=F}
generate_summary_facet_plot(condition_data = cond_summary_exp_3, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp3_', 
                            y_axis_var = 'mean_perc_error', y_axis_name = 'Parameter bias (percentage error)', 
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)', 
                            facet_var = 'time_structuredness')

```


```{=tex}
\begin{figure}
  \caption{Parameter Estimate Accuracy Across Measurement Spacing Conditions in Experiment 1}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp2_summary_plot} \hfill{}
  \caption*{Note.}
\end{figure}
```






# Appendix

## Appendix A: Convergence rates 
\newpage
```{r convergence-rates, echo=F}
exp_1_conv <- generate_conv_success_data(condition_data = cond_summary_exp_1, first_col = 'measurement_spacing', second_col = 'number_measurements', wide_var = 'midpoint', exp_num = 1, recode_var = 'measurement_spacing')

exp_2_conv <- generate_conv_success_data(condition_data = cond_summary_exp_2, first_col = 'measurement_spacing', second_col = 'number_measurements', wide_var = 'sample_size', exp_num = 2, recode_var = 'measurement_spacing')

exp_3_conv <- generate_conv_success_data(condition_data = cond_summary_exp_3, first_col = 'time_structuredness', second_col = 'number_measurements', wide_var = 'sample_size', exp_num = 3, recode_var = 'time_structuredness')
```

\newpage
```{r conv-exp-1, echo=F}
print_conv_table(table_ready_data = exp_1_conv, 
                 caption_name = 'Convergence Success in Experiment 1', 
                 col_header_name = c('Days-to-halfway elevation'), 
                 IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
                 column_names = c('80', '180', '280'))
```

\newpage
```{r conv-exp-2, echo=F}
print_conv_table(table_ready_data = exp_2_conv, 
                 caption_name = 'Convergence Success in Experiment 2', 
                 col_header_name = c('Sample size (\\\\textit{N})'), 
                 IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
                 column_names = c('30', '50', '100', '200', '500', '1000'))
```

\newpage
```{r conv-exp-3, echo=F}
print_conv_table(table_ready_data = exp_3_conv, 
                 caption_name = 'Convergence Success in Experiment 3', 
                 col_header_name = c('Sample size (\\\\textit{N})'), 
                 IV_names =  c('Time Structuredness', 'Number of Measurements'), 
                 column_names = c('30', '50', '100', '200', '500', '1000'))
```

## Appendix B: Parameter estimation plots for Likert-unit parameters
## Appendix c: Parameter estimate tables

### Experiment 1

```{r exp-table-generation, echo=F}
exp_1_tables <- create_table_data_sets(param_summary_data = param_summary_exp_1, 
                                       wide_var = 'midpoint', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_2_tables <- create_table_data_sets(param_summary_data = param_summary_exp_2, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_3_tables <- create_table_data_sets(param_summary_data = param_summary_exp_3, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'time_structuredness') 

#remove measurement spacing columns 
col_to_remove <- which(str_detect(string = names(exp_3_tables$estimate_table), pattern = 'measurement_spacing'))

exp_3_tables$estimate_table <- exp_3_tables$estimate_table[, -col_to_remove]
exp_3_tables$removed_value_table <- exp_3_tables$removed_value_table[ , -col_to_remove]
```

```{r exp1-alpha-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'theta|alpha', 
            caption_name = 'Parameter Values Estimated in Experiment 1', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)',
                                '$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c('80', '180', '280'))
```

\addtocounter{table}{-1}

```{r exp1-beta-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'beta|gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)',
                                '$\\\\upgamma_{fixed}$(satiation point)', '$\\\\upgamma_{random}$(satiation point)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

\addtocounter{table}{-1}

```{r exp1-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'),
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

### Experiment 2

```{r exp2-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-alpha-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-beta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'beta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upgamma_{fixed}$(midpoint)', '$\\\\upgamma_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```


# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}
:::

```{=tex}
\endgroup
```
