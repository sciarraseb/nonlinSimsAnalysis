---
title             : "Is timing everything? Measurement timing and the ability to accurately model longitudinal data"
shorttitle        : "Measurement timing"
format          : "pandoc"
header-includes:
  - \usepackage{nccmath}
  - \usepackage{caption}
  - \usepackage{longtable}
  - \usepackage{setspace}
  - \usepackage{booktabs}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage{amsthm}
  - \usepackage{setspace} #needed to doublespace caption text (using \doublespacing)
  - \usepackage[labelfont = {bf, up}]{caption} 
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
  - \usepackage{upgreek}  #required for non-italicized Greek letters
  - \usepackage{subcaption}
  - \captionsetup[figure]{labelfont={normalfont, bf}, singlelinecheck=false, labelsep=newline}
  - \DeclareCaptionJustification{double}{\DoubleSpacing}
  - \DeclareCaptionFont{figCaptionFont}{\fontfamily{phv}} #sets caption font to sans serif font of Helvetica 
  - \DeclareCaptionFont{figCaptionSize}{\footnotesize} #set caption font size to footnote 
  - \DeclareCaptionFont{figCaptionStyle}{\textup}  #set caption font to non-italicized font  
  - \DeclareCaptionLabelSeparator{captionSep}{\newline\newline} #separates figure label and figure title with required white space
  - \captionsetup[figure]{labelfont={figCaptionStyle, bf}, font = {figCaptionFont,figCaptionSize, figCaptionStyle}, labelsep = captionSep, justification=raggedright}
  - \captionsetup[table]{font = {figCaptionFont,figCaptionSize,figCaptionStyle}, labelfont={bf}, labelsep=captionSep, justification = raggedright, margin = {0cm,0cm}}
  - \newenvironment{helvenv}{\fontfamily{phv}\selectfont}{}
  - \raggedbottom #ensures text starts from top of page and any white space is at the botom

  
#environment numbering 
  - \setcounter{section}{0} 
  - \makeatletter \renewcommand\thesection{} \renewcommand\thesubsection{\@arabic\c@section.\@arabic\c@subsection} \makeatother
  
author: 
  - name          : "Sebastian Sciarra "
    affiliation   : "1"
    corresponding : yes    
    email         : "ssciarra@uoguelph.ca"
affiliation: 
  - id            : "1"
    institution   : "University of Guelph"
keywords          : "measurement timing, nonlinear "
wordcount         : "5554 words"
floatsintext      : yes
figsintext        : yes 
figurelist        : no
tablelist         : no
footnotelist      : no
numbersections    : yes
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa7"
csl               : "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
classoption       : "man"
output            : papaja::apa6_pdf
editor_options: 
  markdown: 
    wrap: 72
bibliography: dissertation_references.bib
---

```{r package_loading, include=F}
#load packages
library(easypackages)
packages <- c('devtools','tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'nonlinSims','papaja', 
              'ggbrace', 'cowplot')
libraries(packages)
load_all()
```

```{r pre_knitting_setup, echo=F, eval=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1A.csv')  
exp_2 <- read_csv(file = 'data/exp_2.csv')
exp_3 <- read_csv(file = 'data/exp_3.csv')

#data cleaning procedure for each data set
#filter out values for each parameter in each condition 
exp_1_filtered <- remove_outliers(data = exp_1)
exp_2_filtered <- remove_outliers(data = exp_2)
exp_3_filtered <- remove_outliers(data = exp_3)
  
#convert variance values to SD values for random effect parameters 
exp_1_cleaned <- convert_var_to_sd(data = exp_1_filtered)
exp_2_cleaned <- convert_var_to_sd(data = exp_2_filtered)
exp_3_cleaned <- convert_var_to_sd(data = exp_3_filtered)

#compute summary values 
param_summary_exp_1 <- compute_parameter_summary(data = exp_1_cleaned, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2_cleaned, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3_cleaned, exp_num = 3)

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/param_summary_exp_3.RData')
```

```{r obsolete_metadata_storing_importing, eval=F}
##store classes of each column 
col_types_exp_1 <- unlist(lapply(X = param_summary_exp_1, FUN = class))
col_types_exp_2 <- unlist(lapply(X = param_summary_exp_2, FUN = class))
col_types_exp_3 <- unlist(lapply(X = param_summary_exp_3, FUN = class))

#create data.frame that stores classes of data columns 
col_types_df <- data.frame('exp_num' = c(rep(x = 1, times = length(col_types_exp_1)),
                                         rep(x = 2, times = length(col_types_exp_2)),
                                         rep(x = 3, times = length(col_types_exp_3))), 
                           'variable_types' = c(col_types_exp_1, col_types_exp_2, col_types_exp_3))

#create data fame that stores levels of factor variables 
exp_1_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_1)
exp_2_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_2)
exp_3_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_3)

##store classes of each column 
col_types_exp_1 <- unlist(lapply(X = param_summary_exp_1, FUN = class))
col_types_exp_2 <- unlist(lapply(X = param_summary_exp_2, FUN = class))
col_types_exp_3 <- unlist(lapply(X = param_summary_exp_3, FUN = class))

#create data.frame that stores classes of data columns 
col_types_df <- data.frame('exp_num' = c(rep(x = 1, times = length(col_types_exp_1)),
                                         rep(x = 2, times = length(col_types_exp_2)),
                                         rep(x = 3, times = length(col_types_exp_3))), 
                           'variable_types' = c(col_types_exp_1, col_types_exp_2, col_types_exp_3))

#create data fame that stores levels of factor variables 
exp_1_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_1)
exp_2_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_2)
exp_3_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_3)

#write meta data + data for factor levels 
write_csv(x = col_types_df, file = 'data/col_types.csv')
write_csv(x = exp_1_factor_levels, file = 'data/exp_1_factor_levels.csv')
write_csv(x = exp_2_factor_levels, file = 'data/exp_2_factor_levels.csv')
write_csv(x = exp_3_factor_levels, file = 'data/exp_3_factor_levels.csv')

#read in .csv files with experimental data already in summarized version 
col_types_df <-read_csv(file = 'data/col_types.csv')
exp_1_factor_levels <- read_csv(file = 'data/exp_1_factor_levels.csv')
exp_2_factor_levels <- read_csv(file = 'data/exp_2_factor_levels.csv')
exp_3_factor_levels <- read_csv(file = 'data/exp_3_factor_levels.csv')

#relevel factors columns 
param_summary_exp_1 <- relevel_factors(param_summary_data = param_summary_exp_1, factor_levels_df = exp_1_factor_levels)
param_summary_exp_2 <- relevel_factors(param_summary_data = param_summary_exp_2, factor_levels_df = exp_2_factor_levels)
param_summary_exp_3 <- relevel_factors(param_summary_data = param_summary_exp_3, factor_levels_df = exp_3_factor_levels)
```

```{r pre_knitting_setup_unfiltered, echo=F, eval=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1A.csv')  
exp_2 <- read_csv(file = 'data/exp_2.csv')
exp_3 <- read_csv(file = 'data/exp_3.csv')

#convert estimates of random effects from variances to SDs

#compute parameter summary statistics  
param_summary_exp_1 <- compute_parameter_summary(data = exp_1, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3, exp_num = 3)

#necessary factor conversions 
param_summary_exp_1$number_measurements <- factor(param_summary_exp_1$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_1$midpoint <- factor(param_summary_exp_1$midpoint, levels = c(80, 180,280))

param_summary_exp_2$number_measurements <- factor(param_summary_exp_2$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_2$sample_size <- factor(param_summary_exp_2$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

param_summary_exp_3$number_measurements <- factor(param_summary_exp_3$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_3$sample_size <- factor(param_summary_exp_3$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/uf_param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/uf_param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/uf_param_summary_exp_3.RData')
```

```{r knitting_setup, echo=F}
#unfiltered data 
param_summary_exp_1 <- readRDS(file = 'data/uf_param_summary_exp_1.RData')
param_summary_exp_2 <- readRDS(file = 'data/uf_param_summary_exp_2.RData')
param_summary_exp_3 <- readRDS(file = 'data/uf_param_summary_exp_3.RData')

#create condition summary data sets 
cond_summary_exp_1 <- compute_condition_summary(param_summary_data = param_summary_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))
cond_summary_exp_2 <- compute_condition_summary(param_summary_data = param_summary_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))
cond_summary_exp_3 <- compute_condition_summary(param_summary_data = param_summary_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))
#create analytical versions of summary data 
exp_1_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_1, exp_num = 1)
exp_2_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_2, exp_num = 2)
exp_3_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_3, exp_num = 3)
```

\newpage
\vspace*{-\topskip}
\vspace*{\fill}
\nointerlineskip


# Experiment 1

\nointerlineskip
\vfill
\newpage

## Overview of data processing and modelling procedure
### Pre-processing of data and model convergence

Prior to presenting results, I will detail how data were processed for each experiment.  After collecting outputted from the simulations, non-converged models (and their corresponding parameter estimates) were removed from subsequent
analyses. Tables \ref{tab:conv-exp-1}--\ref{tab:conv-exp-3} in [Appendix
A](#appendix-a-convergence-rates) provide the convergence success rates
for each condition in each of the three simulation experiments. Model
convergence was almost always above 90% and occurred in the following
frequencies in each experiment:

-   Experiment 1: two instances of sub-90% model convergence rates (see
    Table \ref{tab:conv-exp-1})
-   Experiment 2: two instances of sub-90% model convergence rates (see
    Table \ref{tab:conv-exp-2})
-   Experiment 3: two instances of sub-90% model convergence rates (see
    Table \ref{tab:conv-exp-3})

\noindent Note that all instances of sub-90% model convergence occurred
when five measurements were taken.

### Review of logistic function parameters

```{r logistic-interpretation-plot, eval=F}
#setup variables for logistic curve 
time <- seq(from = 1, to = 360, by = 1)
theta <- 3
alpha <- 3.32
beta <- 180
gamma <- 40

logistic_data <- data.frame('day' = time, 
                            'curve_score' = theta + (alpha - theta)/(1 + exp((beta - time)/gamma))) 

#make first and last values exactly equal to theta and alpha 
logistic_data$curve_score[c(1, 360)] <- c(theta, alpha)

baseline <- logistic_data$curve_score[logistic_data$day == 1]
halfway_value <- logistic_data$curve_score[logistic_data$day == beta]
triquarter_value <- logistic_data$curve_score[logistic_data$day == beta + gamma]
maximal_elevation <- logistic_data$curve_score[logistic_data$day == 360]

#df for points 
point_df <- data.frame('day' = c(1, beta, beta+gamma, 360), 
                       'curve_score' = c(baseline, halfway_value, triquarter_value, maximal_elevation), 
                       'beta_brace' = factor(c('beta', 'beta', 'NA', 'NA')),
                       'beta_label' = rep('d[beta]', times = 4), 
                       
                       'gamma_brace' = factor(c('NA', 'gamma', 'gamma', 'NA')), 
                       'gamma_label' = rep('d[gamma]', times = 4),
                       
                       'total_brace' = factor(c('total', 'NA', 'NA', 'total')), 
                       'total_label' = rep('d[total]', times = 4))

font_size <- 8
title_font <- 30
axis_text_size <- 20
axis_title_size <- 24

theta_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(A:~Baseline~(theta)))) + 
  #theta 
  geom_segment(x = 10, xend = 360, y = baseline, yend = baseline, linetype = 5, size = 1) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = baseline, yend = baseline, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text', x = 440, y = 3.05, label = 'Baseline \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 440, y = 3.00, label = 'theta == 3.00', parse = T, size = font_size) + 

   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))


alpha_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(B:~Maximal~elevation~(alpha)))) + 
  #theta 
  geom_segment(x = -3, xend = 360, y = maximal_elevation, yend = maximal_elevation, linetype = 5, size = 1) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = maximal_elevation, yend = maximal_elevation, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text',  x = 440, y = 3.27, label = 'Maximal \nelevation \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 440, y = 3.20, label = 'alpha == 3.32', parse = T, size = font_size) + 

   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))


beta_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label =  expression(bold(C:~Days~to~halfway~elevation~(beta)))) + 
  #theta 
    geom_segment(x = 130, xend = 175, y = 3.16, yend = 3.16, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 180, xend = 180, y = 3.16, yend = 2.98, linetype = 2, size = 1) + #vertical dashed line 
  annotate(geom = 'text', x = 55, y = 3.14, label = 'Days to halfway \nelevation', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 55, y = 3.08, label = 'beta == 180~days', parse = T, size = font_size) + 
  
   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))

gamma_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 2) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360)) +
  annotate(geom = 'text', x = 80, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = font_size) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 5) +
  coord_cartesian(clip = 'off') + 
  
  ggtitle(label = expression(bold(D:~`Halfway-triquarter`~delta~(gamma)))) +
  
  #gamma 
  geom_segment(x = 175, xend = 215, y = 3.233, yend = 3.233, size = 1, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 220, xend = 220, y = 3.233, yend = 2.98, linetype = 2, size = 1) + #vertical dashed line 
  annotate(geom = 'text', x = 100, y = 3.21, label = 'Halfway-triquarter \ndelta', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 105, y = 3.15, label = 'gamma == 40~days', parse = T, size = font_size) + 
  
  #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold', size = title_font,  hjust = 0), 
        axis.title = element_text(size = axis_title_size), 
        axis.text = element_text(size = axis_text_size, colour = 'black'), 
        plot.tag = element_text(face = 'bold'))

combined_plot <- ggarrange(theta_plot, alpha_plot, beta_plot, gamma_plot)
ggsave(plot = combined_plot, filename = 'Figures/combined_plot.pdf', width = 18, height = 12)


complete_plot <- ggplot(data = logistic_data, aes(x = day, y = curve_score)) + 
  geom_line(size = 1) + 
  theme_classic(base_family = 'Helvetica') +
  scale_y_continuous(name = 'Curve value', limits = c(3, 3.35), breaks = c(3, 3.16, 3.23, 3.32)) + 
  scale_x_continuous(name = 'Day', breaks = c(0, beta, beta + gamma, 360))+
  annotate(geom = 'text', x = 50, y = 3.28, label = 'y == theta + frac(alpha - theta, 1 + e^(frac(beta-time, gamma)))', parse = T, size = 5) + 
  geom_point(data = point_df, mapping = aes(x = day, y = curve_score), size = 3) +

  #beta
  annotate(geom = 'text', x = 85, y = 3.15, label = 'Days to halfway \nelevation', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 90, y = 3.12, label = 'beta == 180~days', parse = T, size = font_size) +
  geom_segment(x = 130, xend = 175, y = 3.16, yend = 3.16, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 180, xend = 180, y = 3.16, yend = 2.98, linetype = 2, size = 0.3) + #vertical dashed line 
  
  #gamma
  annotate(geom = 'text', x = 97, y = 3.233, label = 'Halfway-triquarter delta', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 105, y = 3.21, label = 'gamma == 40~days', parse = T, size = font_size) + 
  geom_segment(x = 175, xend = 215, y = 3.233, yend = 3.233, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  geom_segment(x = 220, xend = 220, y = 3.233, yend = 2.98, linetype = 2, size = 0.3)+  #vertical dashed line  
  
  coord_cartesian(clip = 'off') + 
  #theta 
  geom_segment(x = 10, xend = 360, y = baseline, yend = baseline, linetype = 3, size = 0.3) + #horizontal dashed line  
  geom_segment(x = 400, xend = 365, y = baseline, yend = baseline, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) + #horizontal arrow
  annotate(geom = 'text', x = 425, y = 3.03, label = 'Baseline \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 425, y = 3.00, label = 'theta == 3.00', parse = T, size = font_size) + 

  #alpha 
  geom_segment(x = -3, xend = 360, y = maximal_elevation, yend = maximal_elevation, linetype = 3, size = 0.3) + #vertical dashed line  
  geom_segment(x = 400, xend = 365, y = maximal_elevation, yend = maximal_elevation, size = 0.2, arrow = arrow(length = unit(0.3, 'cm'))) +      #horizontal arrow
  annotate(geom = 'text', x = 430, y = 3.30, label = 'Maximal \nelevation \n(y-axis)', size = font_size, fontface = 'bold') +
  annotate(geom = 'text', x = 430, y = 3.26, label = 'alpha == 3.32', parse = T, size = font_size) + 
  
   #themes
  theme_classic(base_family = 'Helvetica', base_size = 13) +
  theme(plot.margin = unit(c(0, 1, 0.1, 0.1), units="cm"), 
        plot.title = element_text(face='bold',size = title_font), 
        axis.title = element_text(size = 16), 
        axis.text = element_text(size = 13, colour = 'black'))
  
    ##brace information
  #stat_brace(data = point_df %>% filter(beta_brace == 'beta'), 
  #           mapping = aes(group = beta_brace, label = beta_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) + 
  #
  #stat_brace(data = point_df %>% filter(gamma_brace == 'gamma'), 
  #           mapping = aes(group = gamma_brace, label = gamma_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) +
  #
  #stat_brace(data = point_df %>% filter(total_brace == 'total'), 
  #           mapping = aes(group = total_brace, label = total_label), labelsize = 4.5, parse = T,  width = 15, rotate = 90) + 
  #
  #description box 
  #annotate(geom = 'rect', xmin = 235, xmax = 355, ymin = 3.02, ymax = 3.15, alpha = 0.1, color = 'black') + 
  #annotate(geom = 'text', x = 295, y = 3.13, label = 'd[total] == alpha~-~theta == 0.32', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.09, label = 'd[beta] == 0.5~(d[total]) == 0.16', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.06, label = 'd[gamma] == 0.23~(d[total]) == 0.07', parse = T, size = 4.5) + 
  #annotate(geom = 'text', x = 295, y = 3.03, label = 'd[beta]~+~d[gamma] == 0.73~(d[total]) == 0.23', parse = T, size = 4.5) + 

ggsave(plot = complete_plot, filename = 'Figures/complete_logistic_exp_plot.pdf', width = 9, height = 6)
```

Prior to presenting the results, I will provide a recap of of the data-generating procedure used across all the simulation experiments. Data in each experimental condition were generated using the the
logistic function shown below:

```{=tex}
\begin{align}
y = \uptheta + \frac{\upalpha - \uptheta}{{1 + e^\frac{\upbeta - time_i}{\upgamma}}}.
\end{align}
```
(ref:borenstein2009) @borenstein2009

Figure \ref{fig:combined_plot}A shows that the baseline parameter
($\uptheta$) sets the starting value of the curve, which in the
current example has a value of 3.00 ($\uptheta$ = 3.00). Figure
\ref{fig:combined_plot}B shows that the maximal elevation parameter
($\upalpha$) sets the ending value of the curve, which in the current
example has a value of 3.32 ($\upalpha$ = 3.32). Note that a difference
of 0.32 was selected to represent the average effect size in
organizational research [@bosco2015].
\footnote{The average effect size in organizational research is $r = .16$. Using the formula for converting correlation coefficients to Cohen's $\mathit{d}$ values, a value of $r = .16$ corresponds to Cohen's $\mathit{d}$ = 0.32 ((ref:borenstein2009)).}
Figure \ref{fig:combined_plot}C shows that the days-to-halfway elevation
parameter ($\upbeta$) sets the number of days needed to reach 50% of the
difference between the baseline and maximal elevation. In the current
example, the baseline-maximal elevation difference is 0.32
($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32), and so the days-to-halfway
elevation parameter defines the number of days needed to reach a value
of 3.16. Given that the days-to-halfway elevation parameter is set to
180 in the current example ($\upbeta = 180$), then 180 days are needed
to go from a value of 3.00 to a value of 3.16. Figure
\ref{fig:combined_plot}D shows that the halfway-triquarter delta
parameter ($\upgamma$) sets the number of days needed to go from halfway
elevation to approximately 73% of the baseline-maximal elevation
difference of 0.32. Given that 73% of the baseline-maximal elevation
difference is 0.23 and the halfway-triquarter delta is set to 40 days
($\upgamma = 40$), then 40 days are needed to go from the halfway point
of 3.16 to the triquarter point of approximately 3.23.

```{=tex}
\begin{figure}[H]
  \caption{Description of Each Parameter of Four-Parameter Logistic Function}
  \label{fig:combined_plot}
  \includegraphics{Figures/combined_plot} \hfill{}
  \caption*{Note. \textup{Panel A shows that the baseline parameter ($\uptheta$) sets the starting value of the of curve, which 
in the current example has a value of 3.00 ($\uptheta$ = 3.00). Panel B shows that the maximal elevation parameter ($\upalpha$) sets the ending value of the curve, which in the current example has a value of 3.32 ($\upalpha$ = 3.32). Panel C shows that the days-to-halfway elevation parameter ($\upbeta$) sets the number of days needed to reach 50\% of the difference between the baseline and maximal elevation. In the current example, the baseline-maximal elevation difference is 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32), and so the days-to-halfway elevation parameter defines the number of days needed to reach a value of 3.16. Given that the days-to-halfway elevation parameter is set to 180 in the current example ($\upbeta = 180$), then 180 days are neededto go from a value of 3.00 to a value of 3.16. Panel D shows that the halfway-triquarter delta parameter ($\upgamma$) sets the number of days needed to go from halfway elevation to approximately 73\% of the baseline-maximal elevation difference of 0.32 ($\upalpha - \uptheta$ = 3.32 - 3.00 = 0.32). Given that 73\% of the baseline-maximal elevation difference is 0.23 and the halfway-triquarter delta is set to 40 days ($\upgamma = 40$), then 40 days are needed to go from the halfway point of 3.16 to the triquarter point of approximately 3.23).}}
\end{figure}
```
### Presentation of variability

Prior to presenting results, I will explain how variability in each parameter will be calculated and depicted. Variability in each parameter will be represented by the range covered by the middle 95% of estimated
values. Consider an example where variability in the days-to-halfway
elevation parameter ($\upbeta$) is being modelled in an experimental
condition. Figure \ref{fig:beta-variability-example} shows a density distribution of values estimated for the days-to-halfway
elevation parameter ($\upbeta$) parameter. The region of the density
distribution shaded in gray represents the middle 95% of values
estimated for the days-to-halfway elevation parameter ($\upbeta$) and
the upper and lower values of this region set the upper and lower values
of the error bar that lies above the density distribution. Moving forward, I will use error bars to represent this variability because
using density distributions for each of the nine parameters in each experimental condition would be impractical. 

Figure \ref{fig:beta-histogram} shows an example of how
variability in one parameter is modelled for multiple experimental
conditions. In the current example where variability is being modelled
in the days-to-halfway elevation parameter ($\upbeta$), density distributions are
generated for each sample size-measurement number condition and the
range covered by the middle 95% of values in each density distribution is used to
create an error bar. The plot at the bottom of Figure
\ref{fig:beta-density-to-param-plot} is a **parameter estimation plot**
for the days-to-halfway elevation parameter ($\upbeta$) and it shows the
accuracy with which $\upbeta$ is modelled across all sample
size-measurement number combinations when measurement spacing is equal. This style of error bar will be used to represent variability 
for each parameter in each experimental condition. 

```{r variability-histograms, eval=F}
exp_2 <- read_csv(file = 'data/exp_2.csv')

generate_param_density_plot(raw_exp_data = exp_2, param_summary_data = param_summary_exp_2, spacing = 'Equal', num_measurements = 5, sample_size = 30)

```

```{=tex}
\begin{figure}
  \caption{Density Distribution of Values Estimated for the Days-to-Halfway Elevation Parameter ($\upbeta$)}
  \label{fig:beta-histogram}
  \includegraphics[height = 8cm, width = 20cm]{Figures/beta_fixed_Equal_5_30} \hfill{}
  \caption*{Note. \textup{Area shaded in gray represents the middle 95\% of estimated values. The upper and lower limits of the shaded areay define the upper and lower limits of the error bar on top of the density distribution.}}
\end{figure}
```

```{r beta-density-to-param-plot, eval=F}
num_measurements_levels <- as.numeric(levels(param_summary_exp_2$number_measurements))
sample_size_levels <- range(as.numeric(levels(param_summary_exp_2$sample_size)))
exp_2 <- read_csv(file = 'data/exp_2.csv')

for (num_measurements in num_measurements_levels) {
  
  for(sample_size in sample_size_levels){
    
    generate_param_density_plot(raw_exp_data = exp_2, param_summary_data = param_summary_exp_2, 
                                spacing = 'Equal', num_measurements = num_measurements,
                                sample_size = sample_size)
  }
}
```

```{=tex}
\begin{figure}
  \caption{Depiction of Modelling Procedure for Generating Error Bars on Parameter Estimation Plots}
  \label{fig:beta-density-to-param-plot}
  \includegraphics[height = 25cm, width = 10cm]{Figures/density_to_param_plot} \hfill{}
  \caption*{Note. \textup{Density distributions are generated for each experimental condition and the range covered by the middle 95\% of values in each frequnecy distribution is used to create an error bar. The plot at the bottom is a \textbf{parameter estimation plot} for the days-to-halfway elevation parameter ($\upbeta$) and it shows the accuracy with which $\upbeta$ is estimated across all sample size-measurement number combinations when measurement spacing is equal.}}
\end{figure}
```

### Modelling procedure

Because a considerable number of parameters are estimated in each experimental condition, I will review how the parameters will be modelled. Figure \ref{fig:results-plot-primer} shows that each parameter of the
logistic function (for each parameter, see Figure \ref{fig:combined_plot}) is
modelled as a fixed and random effect. Values predicted for fixed-effect
parameters are constant across all individuals, whereas values predicted
for random-effect parameters are unique across individuals. In addition
to the random- and fixed-effects estimated for each logistic function
parameter, an error term ($\upepsilon$) is also estimated. For each
experimental condition, parameter estimation plots will be created for
each logistic function parameter showing how accurately each
parameter is modelled.

One important point to mention is that the results of Experiments 1--3
will focus on the effects of experimental variables on day-unit
parameters (days-to-halfway elevation [$\upbeta$] and halfway-triquarter
delta parameters[$\upgamma$]. Across all three experiments, experimental
variables had little effect on the estimation of Likert-unit parameters
(baseline [$\uptheta$] and maximal elevation [$\upalpha$]), and so
including their estimation plots adds unnecessary length and complexity
to the results sections of each experiment. Note that the parameter
estimation plots have been included in [Appendix C](#appendix-b-parameter-estimation-plots-for-likert-unit-parameters).

```{=tex}
\begin{figure}[H]
  \caption{Set of Parameters Estimated in Each Simulation Experiment}
  \label{fig:results-plot-primer}
  \includegraphics[height = 33cm, width = 15cm]{Figures/logistic_results_plot} \hfill{}
  \caption*{Note. \textup{Each parameter of the logistic function (for a review, see Figure \ref{fig:combined_plot}) is modelled as a fixed and random effect. Values predicted for fixed-effect parameters are constant across all individuals, whereas values predicted for random-effect parameters are unique across individuals. In addition the random- and fixed-effects estimated for each logistic function parameter, an error term ($\upepsilon$) is also estimated. For each experimental condition, parameter estimation plots will be created for each logistic function parameter that show the accuracy with which each parameter is modelled.}}
\end{figure}
```

### Interpreting a parameter estimation plot

Given that a considerable number of parameter estimation plots will be used to explain the results of each experiment, I will provide an overview of how to interpret parameter estimation plots. Figure \ref{fig:param-estimation-ex} shows a parameter estimation plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Estimates for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) parameter are shown across all measurement number-sample size combinations and the shaded gray line indicates the population value set for the parameter ($\upbeta_{fixed}$ = 180). The black shapes (squares, circles, triangles, diamonds) indicate the average estimated value and the error bars show the range of values covered by the middle 95% of estimated parameters (for a review, see [Presentation of variability][Presentation of variability]). Parameter estimation plots show two markers of estimation accuracy: systematic bias and variability. **Systematic bias** describes the extent to which an estimate either over- or underestimates the population value. Looking at the parameter estimation plot in Figure \ref{fig:param-estimation-ex}, systematic bias isrepresented by the extent to which a black shape falls off from the gray line (i.e., the population value). **Variability** is described by the length of the error bars in the parameter estimation plot. In the current example, systematic bias is very low because all of the average estimated values lie close to the population value (i.e., shaded gray line) and variability decreases monotonically as sample size increases. 


```{=tex}
\begin{figure}
  \caption{Parameter Estimation Plot for Fixed-Effect Days-to-Halfway Elevation Parameter ($\upbeta_{fixed}$)}
  \label{fig:param-estimation-ex}
  \includegraphics[height = 33cm, width = 15cm]{Figures/param_estimation_ex} \hfill{}
  \caption*{Note. \textup{The shaded gray line indicates the population value set for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Estimates for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) parameter are shown across all measurement number-sample size combinations and the shaded gray line indicates the population value set for the parameter ($\upbeta_{fixed}$ = 180). The black shapes (squares, circles, triangles, diamonds) indicate the average estimated value and the error bars show the range of values covered by the middle 95\% of estimated parameters. Parameter estimation plots show two markers of estimation accuracy: systematic bias and variability. \textbf{Systematic bias} describes the extent to which an estimate either over- or underestimates the population value. In the parameter estimation plot, systematic bias is represented by the extent to which a black shape falls off from the gray line (i.e., the population value). \textbf{Variability} is described by the length of the error bars in the parameter estimation plot. In the current example, systematic bias is very low because all of the average estimated values lie close to the population value (i.e., shaded gray line) and variability decreases monotonically as sample size increases.}}
\end{figure}
```



## Results of Experiment 1

Experiment 1 investigated the extent to which measurement spacing 
schedules could accurately model logistic function parameters under different patterns of change. Three
variables were manipulated: measurement spacing, number of measurements,
and pattern of change. Measurement spacing was manipulated by creating
schedules defined by either equal, time-increasing, time-decreasing, or
middle-and-extreme spacing. Number of measurements was manipulated to take on a value of either 5, 7, 9, or 11 measurements. Pattern of change was
manipulated such that the days-to-halfway elevation parameter ($\upbeta$) occurred at either 80, 180, or 280 days.

### Equal spacing

```{r plots-equal-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Equal spacing',
                                x_axis_name = 'Day to halfway elevation', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -20, beta_upper = 20, ticks = 5)
```

```{r text-values-equal-exp1, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp1_plot_equal} shows the parameter estimation plots for the
day-unit parameters when equal spacing was used (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. Note that,
in Panel A, estimates for $\upbeta_{fixed}$ are centered around their
corresponding population values (80, 180, and 280 days), and so the
y-axis represents error (in number of days) from the population value.

Two general patterns of results emerged in the estimation of day-unit parameters with equal spacing. First, estimation of all day-unit parameters except the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) incurred
considerable variability when five measurements were taken (as indicated by the longer error bars), but this
variability largely diminished when seven or more measurements were
taken. For example, when five measurements were taken and the population value set for
the days-to-halfway elevation parameter was 80, the error bar length for the fixed-effect triquarter-halfway delta
parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_equal}H) spanned approximately
`r gamma_equal_5_180$upper_ci - gamma_equal_5_180$lower_ci` days
(upper bound of `r gamma_equal_5_180$upper_ci` to a upper bound of `r gamma_equal_5_180$lower_ci` days),
but the length of this error bar decreased to approximately `r gamma_equal_7_180$upper_ci - gamma_equal_7_180$lower_ci` days when seven measurements were taken (upper bound of `r gamma_equal_7_180$upper_ci` to a lower bound `r gamma_equal_7_180$lower_ci` days).


```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Equal Spacing in Experiment 1}
  \label{fig:exp1_plot_equal}
  \includegraphics{Figures/exp1_plot_days_equal spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00. Note that random-effect parameter units are in standard deviation units and that sample size is fixed to 225 (\textit{N} = 225). Panels A--B show the parameter estimation plots for the fixed- and random-effect values of the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively. Panels C--D show the parameter estimation plots for the fixed- and random-effect values of the triquarter-halfway delta parameter ($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

\newpage
### Time-interval increasing spacing

```{r plots-time-increasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                                x_axis_name = 'Day to halfway elevation', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -70, beta_upper = 60, ticks = 10)
```

```{r text-values-time-increasing-exp1, echoF}
beta_time_inc_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_increasing} shows the parameter estimation plots
for the day-unit parameters when time-interval increasing spacing was
used (error bars represent the middle 95% of estimated values and shaded
horizontal lines indicate the population values). Panels A--B show the
parameter estimation plots for the fixed- and random-effect values of
the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and
$\upbeta_{random}$), respectively. Panels C--D show the parameter
estimation plots for the fixed- and random-effect values of the
triquarter-halfway delta parameter ($\upgamma_{fixed}$ and
$\upgamma_{random}$), respectively. Note that, in Panel A, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population
values (80, 180, and 280 days), and so the y-axis represents error (in
number of days) from the population value.

Two general patterns of results emerged in the estimation of day-unit parameters with time-interval increasing spacing. First, for all day-unit parameters except the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$), variability increased considerably when five measurements were taken (as indicated by the long error bars) and the population value set for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) increased from 80 to 280. As an example, the error bar length for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure
\ref{fig:exp1_plot_time_increasing}A) spanned approximately
`r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci`
(upper bound of `r beta_time_inc_5_80$upper_ci` days to a lower bound of `r beta_time_inc_5_80$lower_ci`
days) and `r beta_time_inc_5_180$upper_ci - beta_time_inc_5_180$lower_ci` days
(upper bound of `r beta_time_inc_5_180$lower_ci` days to a lower bound of `r beta_time_inc_5_180$upper_ci` days) when the parameter had a
population value of 80 and 180 days, respectively, but the length
increased to `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
(upper bound of `r beta_time_inc_5_280$upper_ci` days to a lower bound of `r beta_time_inc_5_280$lower_ci` days) when 280 days were
needed to reach the halfway-elevation point. Second, the large amounts
of variability observed for the parameters when five measurements were
taken largely disappeared when seven or more measurements were taken. As an
example, the long error bar range of `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days
for the fixed-effect days-to-halfway elevation
parameter ($\upbeta_{fixed}$) when 280 days were needed to reach the
halfway-elevation point decreased
to a shorter length of `r beta_time_inc_7_280$upper_ci - beta_time_inc_7_280$lower_ci` days
when seven measurements were taken (see Figure
\ref{fig:exp1_plot_time_increasing}A).

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Time-Interval Increasing Spacing in Experiment 1}
  \label{fig:exp1_plot_time_increasing}
  \includegraphics{Figures/exp1_plot_days_time-interval increasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval decreasing spacing

```{r plots-time-decreasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                                x_axis_name = 'Day to halfway elevation', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -60, beta_upper = 70, ticks = 10)
```

```{r text-values-time-decreasing-exp1, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 7, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_decreasing} shows the parameter estimation plots
for the day-unit parameters when time-interval decreasing spacing was
used (error bars represent the middle 95% of estimated values and shaded
horizontal lines indicate the population values). Panels A--B show the
parameter estimation plots for the fixed- and random-effect values of
the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and
$\upbeta_{random}$), respectively. Panels C--D show the parameter
estimation plots for the fixed- and random-effect values of the
triquarter-halfway delta parameter ($\upgamma_{fixed}$ and
$\upgamma_{random}$), respectively. Note that, in Panel A, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population
values (80, 180, and 280 days), and so the y-axis represents error (in
number of days) from the population value.

Two general patterns of results emerged in the estimation of day-unit parameters with time-interval decreasing spacing. First, for all day-unit parameters except the random-effect halfway-triquarter delta ($\upgamma_{random}$), variability increased considerably when five measurements were taken (as indicated by the long error bar) and the population value set for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) decreased from 280 to 80 days. As an
example, the error bar for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure
\ref{fig:exp1_plot_time_decreasing}A) spanned approximately
`r beta_time_dec_5_280$upper_ci - beta_time_dec_5_280$lower_ci`(upper bound of `r beta_time_dec_5_280$upper_ci` days to a lower bound of
`r beta_time_dec_5_280$lower_ci` days) and
`r beta_time_dec_5_180$upper_ci - beta_time_dec_5_180$lower_ci` days
(upper bound of `r beta_time_dec_5_180$upper_ci` days to a lower bound of `r beta_time_inc_5_180$lower_ci` days) when the parameter had a
population value of 280 and 180 days, respectively, but the length
increased to `r beta_time_dec_5_80$upper_ci - beta_time_dec_5_80$lower_ci` days (upper bound of `r beta_time_dec_5_80$upper_ci` days to a lower bound of `r beta_time_dec_5_80$lower_ci`
days) when 80 days were needed to reach the halfway-elevation point.
Second, the large amounts of variability observed for the parameters
when five measurements were taken largely disappeared when seven or more
measurements were taken. As an example, the long error bar range of
`r beta_time_dec_5_80$upper_ci - beta_time_dec_5_80$lower_ci` days
observed in estimating the fixed-effect days-to-halfway elevation
parameter ($\upbeta_{fixed}$) when 80 days were needed to reach the
halfway-elevation point decreased to a shorter length of 
`r beta_time_dec_7_80$upper_ci - beta_time_dec_7_80$lower_ci` days when
seven measurements were taken (see Figure
\ref{fig:exp1_plot_time_decreasing}A).

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Time-Interval Decreasing Spacing in Experiment 1}
  \label{fig:exp1_plot_time_decreasing}
  \includegraphics{Figures/exp1_plot_days_time-interval decreasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Middle-and-extreme spacing

```{r plots-mid-ext-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                                x_axis_name = 'Days to halfway elevation', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -80, beta_upper = 70, ticks = 10)
```

```{r text-values-mid-ext-exp1, echoF}
beta_mid_ext_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_mid_ext_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_mid_ext_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_mid_ext_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 7, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))


beta__rand_mid_ext_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 7, midpoint == 280, grepl('beta\\[random\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta__rand_mid_ext_7_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 7, midpoint == 80, grepl('beta\\[random\\]', parameter)) %>%
  select(midpoint, lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_mid_ext} shows the parameter estimation plots
for the day-unit parameters when middle-and-extreme spacing was used
(error bars represent the middle 95% of estimated values and shaded
horizontal lines indicate the population values). Panels A--B show the
parameter estimation plots for the fixed- and random-effect values of
the days-to-halfway elevation parameter ($\upbeta_{fixed}$ and
$\upbeta_{random}$), respectively. Panels C--D show the parameter
estimation plots for the fixed- and random-effect values of the
triquarter-halfway delta parameter ($\upgamma_{fixed}$ and
$\upgamma_{random}$), respectively. Note that, in Panel A, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population
values (80, 180, and 280 days), and so the y-axis represents error (in
number of days) from the population value.

Two general patterns of results emerged in the estimation of day-unit parameters with middle-and-extreme spacing. First, for all the day-unit parameters
except the random effect of the halfway-triquarter delta parameter
($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_mid_ext}D), variability
increases considerably when five measurements were taken and the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) had population values of 80 or 280. As an example, the error bar length for the
fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_mid_ext}A) spanned approximately
`r beta_mid_ext_5_180$upper_ci - beta_mid_ext_5_180$lower_ci` days
(upper bound of `r beta_mid_ext_5_180$upper_ci` days and a lower bound
of `r beta_mid_ext_5_180$lower_ci` days) when the parameter had a
population value of 180, but the length increased to
`r beta_mid_ext_5_80$upper_ci - beta_mid_ext_5_80$lower_ci` days (upper
bound of `r beta_mid_ext_5_80$upper_ci` days and a lower bound of
`r beta_mid_ext_5_80$lower_ci` days) when the parameter had a population
value of 80 and
`r beta_mid_ext_5_280$upper_ci - beta_mid_ext_5_280$lower_ci` days
(upper bound of `r beta_mid_ext_5_280$upper_ci` days and a lower bound
of `r beta_mid_ext_5_280$lower_ci` days) when the parameter had a
population value of 280. Second, the large amounts of variability
observed for the parameters when five measurements were taken largely
disappeared when seven or more measurements were taken. As an example, the
long error bar range of approximately
`r beta_mid_ext_5_280$upper_ci - beta_mid_ext_5_280$lower_ci` days
observed when for the fixed-effect days-to-halfway elevation parameter
($\upbeta_{fixed}$) when five measurements were taken and the parameter had a a population value of 280 decreased to shorter error bar length of
`r beta_mid_ext_7_280$upper_ci - beta_mid_ext_7_280$lower_ci` days when seven
measurements were taken (see Figure \ref{fig:exp1_plot_time_mid_ext}C). Note
that the variability observed when seven measurements were taken for the
random-effect days-to-halfway elevation parameter
($\upbeta_{random}$) was still considerably high when the fixed-effect days-to-halfway elevation parameter
($\upbeta_{fixed}$) had population values of 80 and 280, with respective ranges of `r beta__rand_mid_ext_7_80$upper_ci - beta__rand_mid_ext_7_80$lower_ci` and `r beta__rand_mid_ext_7_280$upper_ci - beta__rand_mid_ext_7_280$lower_ci` days for parameter estimates.

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Middle-and-Extreme Spacing in Experiment 1}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp1_plot_days_middle-and-extreme spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00. Sample size is fixed to 225 (\textit{N} = 225). In Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```


## Discussion of Experiment 1 


```{r plot-summary-exp1, include=F, eval=F}

day_parms_exp_1_index <- which(str_detect(string = param_summary_exp_1$parameter, pattern = 'beta|gamma'))
day_param_exp_1 <- param_summary_exp_1[day_parms_exp_1_index, ]

cond_summary_exp_1 <- compute_condition_summary(param_summary_data = day_param_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))

generate_summary_facet_plot(condition_data = cond_summary_exp_1, lower_y_limit = 0, upper_y_limit = 30, ticks = 5, exp_num = 'Figures/exp1_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'midpoint', x_axis_name = 'Days to halfway elevation')



day_parms_exp_2_index <- which(str_detect(string = param_summary_exp_2$parameter, pattern = 'beta|gamma'))
day_param_exp_2 <- param_summary_exp_2[day_parms_exp_2_index, ]

cond_summary_exp_2 <- compute_condition_summary(param_summary_data = day_param_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))

generate_summary_facet_plot(condition_data = cond_summary_exp_2, lower_y_limit = 0, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp2_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)')

day_parms_exp_3_index <- which(str_detect(string = param_summary_exp_3$parameter, pattern = 'beta|gamma'))
day_param_exp_3 <- param_summary_exp_3[day_parms_exp_3_index, ]

cond_summary_exp_3 <- compute_condition_summary(param_summary_data = day_param_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))

generate_summary_facet_plot(condition_data = cond_summary_exp_3, lower_y_limit = 0, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp3_', 
                            y_axis_var = 'mean_sd', y_axis_name = 'Parameter variability (standard deviations)',
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)', facet_var = 'time_structuredness')


```


\newpage
\vspace*{-\topskip}
\vspace*{\fill}
\nointerlineskip

# Experiment 2

\nointerlineskip
\vfill
\newpage

Experiment 2 investigated the extent to which measurement spacing 
schedules could accurately model logistic function parameters under various measurement number-sample size conditions. Three
variables were manipulated: measurement spacing, number of measurements,
and sample size. Measurement spacing was manipulated by creating
schedules defined by either equal, time-interval increasing, time-interval decreasing, or
middle-and-extreme spacing.middle-and-extreme spacing. Number of measurements was manipulated to take on a value of either 5, 7, 9, or 11 measurements. Sample size was manipulated to take on a value of either 30, 50, 100, 200, 500, or 1000. 

### Equal spacing

```{r plots-equal-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Equal spacing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r density-plot, include=F}
compute_ind_param_error_bar_range <- function(param_search_name, param_data) {
  
  #extract estimates from single parameter
  ind_param_data <-  param_data %>%
    filter(str_detect(string = param_data$parameter, pattern = param_search_name)) %>% 
    pull(estimate)
  
  param_range <- as.numeric(compute_middle_95_estimate(param_data = ind_param_data))
  
  return(param_range)
}

compute_density <- function(error_bar_range, group, param_name, density_data) { 
  
  density_data <- density_data[density_data$group == group , ]
  
  density_lower_x <- min(which(density_data$x >= error_bar_range[1]))
  density_upper_x <- max(which(density_data$x <= error_bar_range[2]))
  
  day_values <- density_data$x[density_lower_x:density_upper_x]
  
  
  density_df <- data.frame('parameter' = param_name,
                           'day_value' = day_values,
                           'probability' = density_data$y[density_lower_x:density_upper_x], 
                           'max_density_value' = max(density_data$y),
                           'lower_ci' = error_bar_range[1], 
                           'upper_ci' = error_bar_range[2])

    return(density_df)
}


##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_2 <- read_csv('data/exp_2.csv') %>% filter(code == 0) #load data 
exp_2 <- convert_raw_var_to_sd(raw_data = exp_2) #var to sd conversion 

parameter_names <- c(bquote(expr = bold(A:~gamma[fixed]~"(N=500, 5 measurements)")),
                     bquote(expr = bold(B:~beta[random]~"(N=500, 5 measurements)")),
                     bquote(expr = bold(C:~gamma[fixed]~"(N=1000, 5 measurements)")),
                     bquote(expr = bold(D:~beta[random]~"(N=1000, 5 measurements)")))
                     
#1) Extract estimates for four parameter gamma_fixed and beta_rand when N =500 or 1000, num_measurements == 5, spacing == equal. 
##Convert to long format, with parameter name going into unique column and estimate becoming new column 
param_data <- exp_2 %>%
  filter(number_measurements == 5, measurement_spacing == 'equal', sample_size %in% c(500, 1000)) %>%
  select(locate_ivs(exp_2),'gamma_fixed', 'beta_rand') %>%
  pivot_longer(cols = c(gamma_fixed, beta_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', sample_size:name) 

#2) Replace parameter values with tag labels. 
param_data$parameter <- factor(param_data$parameter, 
                               levels = c("500_gamma_fixed", "500_beta_rand",
                                          "1000_gamma_fixed", "1000_beta_rand"), 
                               labels = parameter_names)

base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

param_search_names <- c("A\\:", "B\\:", "C\\:", "D\\:")

param_error_bar_ranges <- lapply(X = param_search_names, compute_ind_param_error_bar_range, param_data = param_data)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


example_plot <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 2, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(3,scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(4, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.90, by = 0.10),
                                                                                                   limits = c(0, .90))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 60, margin = unit(c(t = 0, r = 0, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = example_plot, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_exp2.pdf')

```

```{r text-values-equal-exp2, echoF}
#fixed-effect halfway-triquarter delta (5, 100)
gamma_fixed_equal_5_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 100, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (5, 100)
beta_fixed_equal_5_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter(7, 100)
gamma_fixed_equal_7_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 7, sample_size == 100, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp2_plot_equal} shows the parameter estimation plots for the
day-unit parameters when equal spacing was used (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Two general patterns of results emerged in the estimation of day-unit parameters with equal spacing. First, for the fixed- and random-effects of the
halfway-triquarter delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$), variability was considerably high with five measurements and a sample size no larger than 200. For example, the error bar length for the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$) spanned approximately `r gamma_fixed_equal_5_100$upper_ci -gamma_fixed_equal_5_100$lower_ci` days (upper bound of `r gamma_fixed_equal_5_100$upper_ci` days to a lower bound of `r gamma_fixed_equal_5_100$lower_ci` days) with
five measurements and a sample size of 100. Variability for the fixed- and random-effects of the days-to-halfway elevation parameters ($\beta_{fixed}$ and $\beta_{random}$) was considerably lower than the variability for the halfway-triquarter delta parameters. As an example, the error bar length for the  fixed-effect days-to-halfway elevation parameter($\beta_{fixed}$) spanned approximately `r beta_fixed_equal_5_100$upper_ci - beta_fixed_equal_5_100$lower_ci` days (upper bound of `r beta_fixed_equal_5_100$upper_ci` days to a lower bound of `r beta_fixed_equal_5_100$lower_ci` days) with five measurements and a sample size of 100. Second, variability across all day-unit parameters was nearly trivial across all sample size levels with seven measurements. For example, the error bar length for the the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$) spanned approximately `r gamma_fixed_equal_7_100$upper_ci - gamma_fixed_equal_7_100$lower_ci` (upper bound of `r gamma_fixed_equal_7_100$upper_ci` days to a lower bound of `r gamma_fixed_equal_7_100$lower_ci` days) days with seven measurements and a sample size of 100.

```{r density-ranges, echo=F}
#fixed-effect days-to-halfway elevation parameter (5, 500)
beta_fixed_equal_5_500 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 500, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (5, 500)
beta_fixed_equal_5_1000 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Equal spacing', number_measurements == 5, sample_size == 1000, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

One additional point to mention concerns a counterintuitive increase in variability with an increase in sample size in the random-effect days-to-halfway
elevation ($\beta_{random}$) and the fixed-effect halfway-triquarter delta ($\upgamma_{fixed}$) parameters (see the squared regions in Figures \ref{fig:density_plots_exp2}B--C). With five measurements, the error bar lengths of the random-effect days-to-halfway elevation ($\beta_{random}$) and the
fixed-effect halfway-triquarter delta ($\upgamma_{fixed}$) parameters increased as sample size increased from 500 to 1000. To explain this counterintuitive
increase in variability, Figure \ref{fig:density_plots_exp2} shows the densities for the random-effect days-to-halfway elevation ($\beta_{random}$, Figure \ref{fig:density_plots_exp2}B and \ref{fig:density_plots_exp2}D) and the fixed-effect halfway-triquarter delta ($\upgamma_{fixed}$, Figure \ref{fig:density_plots_exp2}A and Figure \ref{fig:density_plots_exp2}C) parameters for sample sizes of 500 and 1000 with five measurements (shaded regions in gray represent the the middle 95% of estimated values). Although variability increased with sample size, the increase occurred due to the presence of a few low-value outliers. For example, the error bar range for the fixed-effect halfway-triquarter delta ($\upgamma_{fixed}$) spanned
approximately `r beta_fixed_equal_5_500$upper_ci - beta_fixed_equal_5_500$lower_ci` days (upper bound of `r beta_fixed_equal_5_500$upper_ci` days to lower bound of `r beta_fixed_equal_5_500$lower_ci` days) with a sample size of 500 and five measurements, but the error bar range
increased to `r beta_fixed_equal_5_1000$upper_ci - beta_fixed_equal_5_1000$lower_ci` days (upper bound of `r beta_fixed_equal_5_1000$upper_ci` days to lower bound of `r beta_fixed_equal_5_1000$lower_ci` days) when the sample size increased to 1000, as a few low-value outliers decreased the lower bound of the error bar. 


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Equal Spacing in Experiment 2}
  \label{fig:exp2_plot_equal}
  \includegraphics{Figures/exp2_plot_days_equal spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

```{=tex}
\begin{figure}[H]
  \caption{Density Plots of the Fixed-Effect Halfway-Triquarter Delta ($\upgamma_{fixed}$) and Random-Effect Days-to-Halfway Elevation Parameters ($\upbeta_{random}$)in Experiment 2}
  \label{fig:density_plots_exp2}
  \includegraphics{Figures/density_plots_exp2.pdf} \hfill{}
  \caption*{Note. \textup{Regions shaded in in gray represent the the middle 95\% of estimated values and the width of the shaded regions is indicated by the horizontal error bars. For both the fixed-effect halfway-triquarter delta ($\upgamma_{fixed}$) and random-effect days-to-halfway elevation parameters ($\upbeta_{random}$) parameters, error bar lengths increase with sample size due to the presence of a few low-level outliers with a sample size of 1000.}}
\end{figure}
```

### Time-interval increasing spacing

```{r plots-time-increasing-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-time-increasing-exp2, echoF}
#fixed-effect days-to-halfway elevation parameter (5, 100)
beta_fixed_time_inc_5_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 5, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (7, 100)
beta_fixed_time_inc_7_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval increasing', number_measurements == 7, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp2_plot_time_increasing} shows the parameter estimation plots for the
day-unit parameters when equal spacing was used (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Two general patterns of results emerged in the estimation of day-unit parameters with time-interval increasing spacing. First, for all day-unit parameters except the random-effect 
halfway-triquarter delta parameter ($\upgamma_{random}$), variability was considerably high with five measurements and a sample size no larger than 200. For example, the error bar length for the fixed-effect days-to-halfway elevation parameter ($\beta_{fixed}$) spanned approximately `r beta_fixed_time_inc_5_100$upper_ci - beta_fixed_time_inc_5_100$lower_ci` days (upper bound of `r beta_fixed_time_inc_5_100$upper_ci` days to lower bound of `r beta_fixed_time_inc_5_100$lower_ci` days) with five measurements and a sample size of 100. Second, variability across all day-unit parameters was nearly trivial with seven measurements across all sample size levels. For example, the error bar length for the fixed-effect days-to-halfway elevation parameter ($\beta_{fixed}$) spanned approximately `r beta_fixed_time_inc_7_100$upper_ci - beta_fixed_time_inc_7_100$lower_ci` days (upper bound of `r beta_fixed_time_inc_7_100$upper_ci` days to a lower bound of `r beta_fixed_time_inc_7_100$lower_ci` days) with seven measurements and a sample size of 100.

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Increasing Spacing in Experiment 2}
  \label{fig:exp2_plot_time_increasing}
  \includegraphics{Figures/exp2_plot_days_time-interval increasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-interval decreasing spacing

```{r plots-time-decreasing-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 155, beta_upper = 195,
                               ticks = 5)
```

```{r text-values-time-decreasing-exp2, echoF}
#fixed-effect days-to-halfway elevation parameter (5, 100)
beta_fixed_time_dec_5_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 5, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (7, 100)
beta_fixed_time_dec_7_100 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Time-interval decreasing', number_measurements == 7, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp2_plot_time_decreasing} shows the parameter estimation plots for the
day-unit parameters when equal spacing was used (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Two general patterns of results emerged in the estimation of day-unit parameters with time-interval decreasing spacing. First, for all day-unit parameters except the random-effect 
halfway-triquarter delta parameter ($\upgamma_{random}$), variability was considerably high with five measurements and a sample size no larger than 200. For example, the error bar length for the fixed-effect days-to-halfway elevation parameter ($\beta_{fixed}$) spanned approximately `r beta_fixed_time_dec_5_100$upper_ci - beta_fixed_time_dec_5_100$lower_ci` days (upper bound of `r beta_fixed_time_dec_5_100$upper_ci` days to lower bound of `r beta_fixed_time_dec_5_100$lower_ci` days) with five measurements and a sample size of 100. Second, variability across all day-unit parameters was nearly trivial with seven measurements across all sample size levels. For example, the error bar length for the fixed-effect days-to-halfway elevation parameter ($\beta_{fixed}$) spanned approximately `r beta_fixed_time_dec_7_100$upper_ci - beta_fixed_time_dec_7_100$lower_ci` days (upper bound of `r beta_fixed_time_dec_7_100$upper_ci` days to a lower bound of `r beta_fixed_time_dec_7_100$lower_ci` days) with seven measurements and a sample size of 100.

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Interval Decreasing Spacing in Experiment 2}
  \label{fig:exp2_plot_time_decreasing}
  \includegraphics{Figures/exp2_plot_days_time-interval decreasing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Middle-and-extreme spacing

```{r plots-mid-ext-exp2, include=F}
generate_day_likert_facet_plot(analytical_data = exp_2_analytical, 
                               target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp2_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-mid-ext-exp2, echoF}
#fixed-effect days-to-halfway elevation parameter (5, 30)
beta_fixed_mid_ext_5_30 <- exp_2_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme spacing', number_measurements == 5, sample_size == 30, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp1_plot_time_mid_ext} shows the parameter estimation plots for the
day-unit parameters when equal spacing was used (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

In addition to showing little to no systematic bias, parameter estimates also showed little to no variability with middle-and-extreme measurement spacing. The longest error bar length 
across all day-unit parameters across all sample size-measurement-number conditions occurred for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), with an error 
bar length of `r beta_fixed_mid_ext_5_30$upper_ci - beta_fixed_mid_ext_5_30$lower_ci` days (upper bound of `r beta_fixed_mid_ext_5_30$upper_ci` days to a lower bound of `r beta_fixed_mid_ext_5_30$lower_ci` days) with five measurements and a sample size of 30. 


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Middle-and-Extreme Spacing in Experiment 2}
  \label{fig:exp2_plot_time_mid_ext}
  \includegraphics{Figures/exp2_plot_days_middle-and-extreme spacing} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows:  $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

## Summary of Experiment 2

```{r plot-summary-exp2, include=F, eval=F}
generate_summary_facet_plot(condition_data = cond_summary_exp_2, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp2_', 
                            y_axis_var = 'mean_perc_error', y_axis_name = 'Parameter bias (percentage error)', 
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)')

```

## Discussion of Experiment 2 

\newpage
\vspace*{-\topskip}
\vspace*{\fill}
\nointerlineskip


# Experiment 3

\nointerlineskip
\vfill
\newpage

(ref:coulombe2016) @coulombe2016

Experiment 3 investigated the extent to which time structuredness, when not accounted for, affected the ability to accurately model logistic function parameters under various measurement number-sample size conditions. Three variables were manipulated: time structuredness, number of measurements, and sample size. Time structuredness was manipulated by defining response 
rates such that 80% of participants responded within a period of 0 (time-structured data), 4.32, or 10.80 days. \footnote{The resposne rate values used in defining the three time structuredness conditions were chosen to resemble values used in previous research ((ref:coulombe2016)).} Number of measurements was manipulated to take on a value of either 5, 7, 9, or 11 measurements. Sample size was manipulated to take on a value of either 30, 50, 100, 200, 500, or 1000. Note that measurement spacing is fixed to equal across all conditions. 

## Results of Experiment 3 
### Time-structured data

```{r plots-time-structured-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'time_structured',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-time-structured-exp3, echoF}
#fixed-effect halfway-triquarter delta (5, 100)
gamma_fixed_equal_5_100 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'time_structured', number_measurements == 5, sample_size == 100, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (5, 100)
beta_fixed_equal_5_100 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'time_structured', number_measurements == 5, sample_size == 100, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter(7, 100)
gamma_fixed_equal_7_100 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'time_structured', number_measurements == 7, sample_size == 100, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))  
```

Figure \ref{fig:exp3_plot_days_time_structured} shows the parameter estimation plots for the
day-unit parameters with time-structured data (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Two general patterns of results emerged in the estimation of day-unit parameters with equal spacing. First, for the fixed- and random-effects of the
halfway-triquarter delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$), variability was considerably high with five measurements and a sample size no larger than 200. For example, the error bar length for the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$) spanned approximately `r gamma_fixed_equal_5_100$upper_ci -gamma_fixed_equal_5_100$lower_ci` days (upper bound of `r gamma_fixed_equal_5_100$upper_ci` days to a lower bound of `r gamma_fixed_equal_5_100$lower_ci` days) with
five measurements and a sample size of 100. Variability for the fixed- and random-effects of the days-to-halfway elevation parameters ($\beta_{fixed}$ and $\beta_{random}$) was considerably lower than the variability for the halfway-triquarter delta parameters. As an example, the error bar length for the  fixed-effect days-to-halfway elevation parameter($\beta_{fixed}$) spanned approximately `r beta_fixed_equal_5_100$upper_ci - beta_fixed_equal_5_100$lower_ci` days (upper bound of `r beta_fixed_equal_5_100$upper_ci` days to a lower bound of `r beta_fixed_equal_5_100$lower_ci` days) with five measurements and a sample size of 100. Second, variability across all day-unit parameters was nearly trivial across all sample size levels with seven measurements. For example, the error bar length for the the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$) spanned approximately `r gamma_fixed_equal_7_100$upper_ci - gamma_fixed_equal_7_100$lower_ci` (upper bound of `r gamma_fixed_equal_7_100$upper_ci` days to a lower bound of `r gamma_fixed_equal_7_100$lower_ci` days) days with seven measurements and a sample size of 100.

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Structured Data Experiment 3}
  \label{fig:exp3_plot_days_time_structured}
  \includegraphics{Figures/exp3_plot_days_time_structured} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows:  $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-unstructured data (fast response)

```{r plots-fast-response-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'fast_response',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-fast-response-exp3, echoF}
#fixed-effect triquarter-halfway delta parameter (5, 1000)
gamma_fixed_fast_5_1000 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'fast_response', number_measurements == 5, sample_size == 1000, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect triquarter-halfway delta parameter (5, 200)
gamma_random_fast_5_200 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'fast_response', number_measurements == 5, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#random-effect triquarter-halfway delta parameter (5, 200)
gamma_random_fast_5_200 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'fast_response', number_measurements == 5, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 

#random-effect triquarter-halfway delta parameter (7, 200)
gamma_random_fast_7_200 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'fast_response', number_measurements == 7, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp3_plot_days_fast_response} shows the parameter estimation plots for the
day-unit parameters with time-unstructured data defined by fast response rates (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Four general patterns of results emerged in the estimation of day-unit parameters with time-unstructured data defined by fast response rates. First, variability across all sample sizes for the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) remained high with five measurements. For example, the error bar length for the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) had a length of `r gamma_fixed_fast_5_1000$upper_ci - gamma_fixed_fast_5_1000$lower_ci` days (upper bound of `r gamma_fixed_fast_5_1000$upper_ci` days to lower bound of `r gamma_fixed_fast_5_1000$upper_ci` days) with a sample size of 1000 with 5 measurements. Note that the same pattern of variability existed to a lesser extent for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Second, variability for the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) remained high with five measurements and a sample size no larger than 200. For example, the error bar length for the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) had a length of `r gamma_random_fast_5_200$upper_ci - gamma_random_fast_5_200$lower_ci` days (upper bound of `r gamma_random_fast_5_200$upper_ci` days to lower bound of `r gamma_random_fast_5_200$lower_ci` days) with a sample size of 200 and five measurements. Third, estimation of the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) incurred bias with five measurements and a sample size no larger than 200. For example, the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) had an average estimated value of `r gamma_random_fast_5_200$estimate` days with a sample size of 200 with five measurements. Fourth, variability and bias across all day-unit parameters was nearly trivial across all sample size levels with seven measurements. For example, the error bar length for the the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) spanned approximately `r gamma_random_fast_7_200$upper_ci - gamma_random_fast_7_200$lower_ci` (upper bound of `r gamma_random_fast_7_200$upper_ci` days to a lower bound of `r gamma_random_fast_7_200$lower_ci` days) days with seven measurements and a sample size of 200 and had an average estimated value of `r gamma_random_fast_7_200$estimate` days (relative to a population value of 4.00). 


```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Unstructured Data (Fast Response Rate) Experiment 3}
  \label{fig:exp3_plot_days_fast_response}
  \includegraphics{Figures/exp3_plot_days_fast_response} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows:  $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Time-unstructured data (slow response)

```{r plots-slow-response-exp3, include=F}
generate_day_likert_facet_plot(analytical_data = exp_3_analytical, 
                               target_col = 'time_structuredness', target_value = 'slow_response',
                               x_axis_name = 'Sample size (*N*)', 
                               x_axis_var = 'sample_size', exp_num = 'exp3_', beta_lower = 165, beta_upper = 205,
                               ticks = 5)
```

```{r text-values-slow-response-exp3, echoF}
#fixed-effect triquarter-halfway delta parameter (5, 1000)
gamma_fixed_slow_5_1000 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 5, sample_size == 1000, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect triquarter-halfway delta parameter (5, 200)
gamma_random_slow_5_200 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 5, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

#fixed-effect days-to-halfway elevation parameter (5, 100)
beta_fixed_slow_5_100 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 5, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_fixed_slow_5_30 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 5, sample_size == 30, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 

beta_fixed_slow_11_1000 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 11, sample_size == 1000, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 

#random-effect triquarter-halfway delta parameter (5, 100)
gamma_random_slow_5_100 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 5, sample_size == 100, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 

#random-effect triquarter-halfway delta parameter (7, 100)
gamma_random_slow_7_200 <- exp_3_analytical$days %>% 
  filter(time_structuredness == 'slow_response', number_measurements == 7, sample_size == 200, grepl('gamma\\[random\\]', parameter)) %>%
  select(lower_ci, upper_ci, estimate) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp3_plot_days_fast_response} shows the parameter estimation plots for the
day-unit parameters with time-unstructured data defined by fast response rates (error bars represent the
middle 95% of estimated values and shaded horizontal lines indicate the
population values). Panels A--B show the parameter estimation plots for
the fixed- and random-effect values of the days-to-halfway elevation
parameter ($\upbeta_{fixed}$ and $\upbeta_{random}$), respectively.
Panels C--D show the parameter estimation plots for the fixed- and
random-effect values of the triquarter-halfway delta parameter
($\upgamma_{fixed}$ and $\upgamma_{random}$), respectively. 

Five general patterns of results emerged in the estimation of day-unit parameters with time-unstructured data defined by fast response rates. First, variability across all sample sizes for the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) remained high with five measurements. For example, the error bar length for the the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) spanned approximately `r gamma_fixed_slow_5_1000$upper_ci - gamma_fixed_slow_5_1000$lower_ci` days (upper bound of `r gamma_fixed_slow_5_1000$upper_ci` days to lower bound of `r gamma_fixed_slow_5_1000$upper_ci` days) with a sample size of 1000 and five measurements. Note that the same pattern of variability existed to a lesser extent for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$).
Second, variability for the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) remained high with five measurements and a sample size no larger than 200. For example, the error bar length for the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) had a length of `r gamma_random_slow_5_200$upper_ci - gamma_random_slow_5_200$lower_ci` days (upper bound of `r gamma_random_slow_5_200$upper_ci` days to lower bound of `r gamma_random_slow_5_200$lower_ci` days) with a sample size of 200 and five measurements. Third, estimation of the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) incurred bias with five measurements and a sample size no larger than 100. For example, the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) had an average estimated value of `r gamma_random_slow_5_100$estimate` days with a sample size of 100 with five measurements. Fourth, estimation of the fixed-effect days-to halfway elevation parameter ($\upbeta_{fixed}$) incurred bias under all sample size-measurement number conditions. For example, the fixed-effect days-to halfway elevation parameter ($\upbeta_{fixed}$) had an average estimated value of `r beta_fixed_slow_5_30$estimate` days with a sample size of 30 and five measurements and an average estimated value of `r beta_fixed_slow_11_1000$estimate` days with a sample size of 1000 and 11 measurements (relative to a population value of 180.00). Fifth, variability and bias across all day-unit parameters (except the fixed-effect days-to-halfway elevation parameter [$\upbeta_{fixed}$]) was nearly trivial across all sample size levels with seven measurements. For example, the error bar length for the the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) spanned approximately `r gamma_random_slow_7_200$upper_ci - gamma_random_slow_7_200$lower_ci` (upper bound of `r gamma_random_slow_7_200$upper_ci` days to a lower bound of `r gamma_random_slow_7_200$lower_ci` days) days with seven measurements and a sample size of 200 and had an average estimated value of `r gamma_random_slow_7_200$estimate` days (relative to a population value of 4 days). 

```{=tex}
\begin{figure}[H]
  \caption{Summary of Day-Unit Parameter Estimates for Time-Unstructured Data (Slow Response Rate) Experiment 3}
  \label{fig:exp3_plot_days_slow_response}
  \includegraphics{Figures/exp3_plot_days_slow_response} \hfill{}
  \caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Note that random-effect units are in standard deviation units. See Table \ref{tab:exp3-alpha-theta-param-est} for specific values estimated for each parameter.}}
\end{figure}
```

### Summary of Experiment 3

```{r plot-summary-exp3, include=F, eval=F}
generate_summary_facet_plot(condition_data = cond_summary_exp_3, lower_y_limit = -6, upper_y_limit = 20, ticks = 2, exp_num = 'Figures/exp3_', 
                            y_axis_var = 'mean_perc_error', y_axis_name = 'Parameter bias (percentage error)', 
                            x_axis_var = 'sample_size', x_axis_name = 'Sample size (*N*)', 
                            facet_var = 'time_structuredness')

```

```{=tex}
\begin{figure}
  \caption{Parameter Estimate Accuracy Across Measurement Spacing Conditions in Experiment 1}
  \label{fig:exp3_plot_summary}
  \includegraphics{Figures/exp2_summary_plot} \hfill{}
  \caption*{Note.}
\end{figure}
```
# Appendix

## Appendix A: Convergence rates {#appendix-a-convergence-rates}

\newpage

```{r convergence-rates, echo=F}
exp_1_conv <- generate_conv_success_data(condition_data = cond_summary_exp_1, first_col = 'measurement_spacing', second_col = 'number_measurements', wide_var = 'midpoint', exp_num = 1, recode_var = 'measurement_spacing')

cond_summary_exp_1 %>% 
  mutate(measurement_spacing = fct_recode(measurement_spacing,
                                      'Equal' = 'bold(A:~Equal)',
                                      'Time-interval increasing' = ' bold(B:~`Time-Interval`~Increasing)',
                                      'Time-interval decreasing' = 'bold(C:~`Time-Interval`~Decreasing)',
                                      'Middle-and-extreme' = 'bold(D:~`Middle-and-Extreme`)'))
        
exp_2_conv <- generate_conv_success_data(condition_data = cond_summary_exp_2, first_col = 'measurement_spacing', second_col = 'number_measurements', wide_var = 'sample_size', exp_num = 2, recode_var = 'measurement_spacing')

exp_3_conv <- generate_conv_success_data(condition_data = cond_summary_exp_3, first_col = 'time_structuredness', second_col = 'number_measurements', wide_var = 'sample_size', exp_num = 3, recode_var = 'time_structuredness')
```

\newpage

```{r conv-exp-1, echo=F}
print_conv_table(table_ready_data = exp_1_conv, 
                 caption_name = 'Convergence Success in Experiment 1', 
                 col_header_name = c('Days-to-halfway elevation'), 
                 IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
                 column_names = c('80', '180', '280'))
```

\newpage

```{r conv-exp-2, echo=F}
print_conv_table(table_ready_data = exp_2_conv, 
                 caption_name = 'Convergence Success in Experiment 2', 
                 col_header_name = c('Sample size (\\\\textit{N})'), 
                 IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
                 column_names = c('30', '50', '100', '200', '500', '1000'))
```

\newpage

```{r conv-exp-3, echo=F}
print_conv_table(table_ready_data = exp_3_conv, 
                 caption_name = 'Convergence Success in Experiment 3', 
                 col_header_name = c('Sample size (\\\\textit{N})'), 
                 IV_names =  c('Time Structuredness', 'Number of Measurements'), 
                 column_names = c('30', '50', '100', '200', '500', '1000'))
```

## Appendix B: Parameter estimation plots for Likert-unit parameters {#appendix-b-parameter-estimation-plots-for-likert-unit-parameters}

## Appendix c: Parameter estimate tables

### Experiment 1

```{r exp-table-generation, echo=F}
exp_1_tables <- create_table_data_sets(param_summary_data = param_summary_exp_1, 
                                       wide_var = 'midpoint', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_2_tables <- create_table_data_sets(param_summary_data = param_summary_exp_2, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_3_tables <- create_table_data_sets(param_summary_data = param_summary_exp_3, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'time_structuredness') 

#remove measurement spacing columns 
col_to_remove <- which(str_detect(string = names(exp_3_tables$estimate_table), pattern = 'measurement_spacing'))

exp_3_tables$estimate_table <- exp_3_tables$estimate_table[, -col_to_remove]
exp_3_tables$removed_value_table <- exp_3_tables$removed_value_table[ , -col_to_remove]
```

```{r exp1-alpha-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'theta|alpha', 
            caption_name = 'Parameter Values Estimated in Experiment 1', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)',
                                '$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c('80', '180', '280'))
```

\addtocounter{table}{-1}

```{r exp1-beta-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'beta|gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)',
                                '$\\\\upgamma_{fixed}$(satiation point)', '$\\\\upgamma_{random}$(satiation point)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

\addtocounter{table}{-1}

```{r exp1-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'),
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

### Experiment 2

```{r exp2-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-alpha-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-beta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'beta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upgamma_{fixed}$(midpoint)', '$\\\\upgamma_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}

```{r exp2-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

### Experiment 3 


# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}
:::

```{=tex}
\endgroup
```
