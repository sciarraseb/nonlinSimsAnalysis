---
title             : "Is timing everything? Measurement timing and the ability to accurately model longitudinal data"
shorttitle        : "Measurement timing"
format          : "pandoc"
header-includes:
  - \usepackage{nccmath}
  - \usepackage{caption}
  - \usepackage{longtable}
  - \usepackage{setspace}
  - \usepackage{booktabs}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage{amsthm}
  - \usepackage{setspace} #needed to doublespace caption text (using \doublespacing)
  - \usepackage[labelfont = {bf, up}]{caption} 
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
  - \usepackage{upgreek}  #required for non-italicized Greek letters
  - \usepackage{subcaption}
  - \captionsetup[figure]{labelfont={normalfont, bf}, singlelinecheck=false, labelsep=newline}
  - \DeclareCaptionJustification{double}{\DoubleSpacing}
  - \DeclareCaptionFont{figCaptionFont}{\fontfamily{phv}} #sets caption font to sans serif font of Helvetica 
  - \DeclareCaptionFont{figCaptionSize}{\footnotesize} #set caption font size to footnote 
  - \DeclareCaptionFont{figCaptionStyle}{\textup}  #set caption font to non-italicized font  
  - \DeclareCaptionLabelSeparator{captionSep}{\newline\newline} #separates figure label and figure title with required white space
  - \captionsetup[figure]{labelfont={figCaptionStyle, bf}, font = {figCaptionFont,figCaptionSize, figCaptionStyle}, labelsep = captionSep, justification=raggedright}
  - \captionsetup[table]{font = {figCaptionFont,figCaptionSize,figCaptionStyle}, labelfont={bf}, labelsep=captionSep, justification = raggedright, margin = {0cm,0cm}}
  - \newenvironment{helvenv}{\fontfamily{phv}\selectfont}{}
  
#environment numbering 
  - \setcounter{section}{0} 
  - \makeatletter \renewcommand\thesection{} \renewcommand\thesubsection{\@arabic\c@section.\@arabic\c@subsection} \makeatother
  
author: 
  - name          : "Sebastian Sciarra "
    affiliation   : "1"
    corresponding : yes    
    email         : "ssciarra@uoguelph.ca"
affiliation:
  - id            : "1"
    institution   : "University of Guelph"
keywords          : "measurement timing, nonlinear "
wordcount         : "5554 words"
floatsintext      : yes
figsintext        : yes 
figurelist        : no
tablelist         : no
footnotelist      : no
numbersections    : yes
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa7"
csl               :   "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
classoption       : "man"
output            : papaja::apa6_pdf
editor_options: 
  markdown: 
    wrap: 72
---




```{r package_loading, include=F}
#load packages
library(easypackages)
packages <- c('devtools','tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'nonlinSims','papaja')
libraries(packages)
load_all()
```

```{r pre_knitting_setup, echo=F, eval=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1A.csv') 
exp_2 <- read_csv(file = 'data/exp_2.csv')
exp_3 <- read_csv(file = 'data/exp_3.csv')

#data cleaning procedure for each data set
#filter out values for each parameter under each condition 
exp_1_filtered <- remove_outliers(data = exp_1)
exp_2_filtered <- remove_outliers(data = exp_2)
exp_3_filtered <- remove_outliers(data = exp_3)
  
#convert variance values to SD values for random effect parameters 
exp_1_cleaned <- convert_var_to_sd(data = exp_1_filtered)
exp_2_cleaned <- convert_var_to_sd(data = exp_2_filtered)
exp_3_cleaned <- convert_var_to_sd(data = exp_3_filtered)

#compute summary values 
param_summary_exp_1 <- compute_parameter_summary(data = exp_1_cleaned, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2_cleaned, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3_cleaned, exp_num = 3)

#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/param_summary_exp_3.RData')
```

```{r obsolete_metadata_storing_importing, echo=F, eval=F}
#store classes of each column 
col_types_exp_1 <- unlist(lapply(X = param_summary_exp_1, FUN = class))
col_types_exp_2 <- unlist(lapply(X = param_summary_exp_2, FUN = class))
col_types_exp_3 <- unlist(lapply(X = param_summary_exp_3, FUN = class))

#create data.frame that stores classes of data columns 
col_types_df <- data.frame('exp_num' = c(rep(x = 1, times = length(col_types_exp_1)),
                                         rep(x = 2, times = length(col_types_exp_2)),
                                         rep(x = 3, times = length(col_types_exp_3))), 
                           'variable_types' = c(col_types_exp_1, col_types_exp_2, col_types_exp_3))

#create data fame that stores levels of factor variables 
exp_1_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_1)
exp_2_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_2)
exp_3_factor_levels <- extract_factor_levels(param_summary_data = param_summary_exp_3)

#write summary data  
write_csv(x = param_summary_exp_1, file = 'data/param_summary_exp_1.csv')
write_csv(x = param_summary_exp_2, file = 'data/param_summary_exp_2.csv')
write_csv(x = param_summary_exp_3, file = 'data/param_summary_exp_3.csv')

#write meta data + data for factor levels 
write_csv(x = col_types_df, file = 'data/col_types.csv')
write_csv(x = exp_1_factor_levels, file = 'data/exp_1_factor_levels.csv')
write_csv(x = exp_2_factor_levels, file = 'data/exp_2_factor_levels.csv')
write_csv(x = exp_3_factor_levels, file = 'data/exp_3_factor_levels.csv')

#read in .csv files with experimental data already in summarized version 
col_types_df <-read_csv(file = 'data/col_types.csv')
exp_1_factor_levels <- read_csv(file = 'data/exp_1_factor_levels.csv')
exp_2_factor_levels <- read_csv(file = 'data/exp_2_factor_levels.csv')
exp_3_factor_levels <- read_csv(file = 'data/exp_3_factor_levels.csv')

#import summary data files 
param_summary_exp_1 <- read.csv(file = 'data/param_summary_exp_1.csv', colClasses = col_types_df$variable_types[col_types_df$exp_num == 1])
param_summary_exp_2 <- read.csv(file = 'data/param_summary_exp_2.csv',  colClasses = col_types_df$variable_types[col_types_df$exp_num == 2])
param_summary_exp_3 <- read.csv(file = 'data/param_summary_exp_3.csv', colClasses = col_types_df$variable_types[col_types_df$exp_num == 3])

#relevel factors columns 
param_summary_exp_1 <- relevel_factors(param_summary_data = param_summary_exp_1, factor_levels_df = exp_1_factor_levels)
param_summary_exp_2 <- relevel_factors(param_summary_data = param_summary_exp_2, factor_levels_df = exp_2_factor_levels)
param_summary_exp_3 <- relevel_factors(param_summary_data = param_summary_exp_3, factor_levels_df = exp_3_factor_levels)
```

```{r knitting_setup, echo = F}
param_summary_exp_1 <- readRDS(file = 'data/param_summary_exp_1.RData')
param_summary_exp_2 <- readRDS(file = 'data/param_summary_exp_2.RData')
param_summary_exp_3 <- readRDS(file = 'data/param_summary_exp_3.RData')

#create condition summary data sets 
cond_summary_exp_1 <- compute_condition_summary(param_summary_data = param_summary_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))
cond_summary_exp_2 <- compute_condition_summary(param_summary_data = param_summary_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))
cond_summary_exp_3 <- compute_condition_summary(param_summary_data = param_summary_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))

#create analytical versions of summary data 
exp_1_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_1, exp_num = 1)
exp_2_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_2, exp_num = 2)
exp_3_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_3, exp_num = 3)
```

# Results

## Experiment 1

### Equal spacing

```{r plots-equal-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Equal',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -20, beta_upper = 20, ticks = 5)
```

```{r text-values-equal-exp1, echoF}
gamma_equal_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 5, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

gamma_equal_7_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Equal', number_measurements == 7, midpoint == 80, grepl('gamma\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci)) 
```

Figure \ref{fig:exp1_plot_equal} shows the estimation accuracy (in terms of Likert-based or day-based units)each of the nine estimated parameters when equal spacing is used (error bars represent the middle 95% of estimated values and shaded horizontal lines indicate the population value).
Panels A--E show the estimation accuracy for parameters measured in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of 1--5)
and Panels F--I show the estimation accuracy for parameters measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. 

Estimation of Likert-unit parameters appears to be unaffected, whereas the estimation of day-unit parameters appears to incur considerable variability. The estimation for the
fixed- and random-effect values of the midpoint ($\upbeta_{fixed}$ and $\upbeta_{random}$; Figure \ref{fig:exp1_plot_equal}F--G)
and the satiation point ($\upgamma_{fixed}$ and $\upgamma_{random}$; Figure \ref{fig:exp1_plot_equal}H--I) incur considerable variability when five measurements are taken, but
this variability largely diminishes when seven or more measurements are taken. For example, when five measurements are taken and the midpoint occurs at 80 days, the middle 95% of values estimated for the fixed-effect parameter of the satiation point ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_equal}H) has a plausible range that spans `r gamma_equal_5_180$upper_ci - gamma_equal_5_180$lower_ci` days (`r gamma_equal_5_180$upper_ci` to `r gamma_equal_5_180$lower_ci` days), but the width of this range decreases to approximately `r gamma_equal_7_180$upper_ci - gamma_equal_7_180$lower_ci` days when seven measurements are taken (`r gamma_equal_7_180$upper_ci` to `r gamma_equal_7_180$lower_ci` days). 

\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Equal Spacing}
  \label{fig:exp1_plot_equal}
  \includegraphics{Figures/exp1_plot_likert_equal} \hfill{}
\end{figure}
\addtocounter{figure}{-1}
\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Equal Spacing (continued)}
  \includegraphics{Figures/exp1_plot_days_equal} \hfill{}
\caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\uptheta_{fixed}$ = 3.00, $\upalpha_{fixed}$ = 3.32, $\upbeta_{fixed}$ = 180.00, $\upgamma_{fixed}$ = 20.00, $\uptheta_{random}$ = 0.05, $\upalpha_{random}$ = 0.05, $\upbeta_{random}$ = 10.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel F, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviations. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:exp1-alpha-theta-removed} for the number of values removed for each parameter.}}
\end{figure}

### Time-increasing spacing

```{r plots-time-increasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time increasing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -70, beta_upper = 60, ticks = 10)
```

```{r text-values-time-increasing-exp1, echoF}
beta_time_inc_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_inc_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time increasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_increasing} shows the estimation accuracy (in terms of Likert-based or day-based units)each of the nine estimated parameters
when time-increasing spacing is used (error bars represent the middle 95% of estimated values and shaded horizontal lines indicate the population value).
Panels A--E show the estimation accuracy for parameters measured in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of 1--5)
and Panels F--I show the estimation accuracy for parameters measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error from the population
value (in number of days). 

As in the equal-spacing condition, estimation of Likert-unit parameters appears to be unaffected, whereas the estimation of day-unit parameters appears to incur considerable variability. Two general trends exist in the estimates of day-based parameters. First, for the fixed-effect midpoint and satiation point parameters ($\upbeta_{fixed}$ and $\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G), variability increases exponentially when five measurements are taken and the and the midpoint moves from 80 to 280 days. As an example, the middle 95% of values estimated for the fixed-effect midpoint parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F) has widths of `r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` (`r beta_time_inc_5_80$upper_ci` days to `r beta_time_inc_5_80$lower_ci` days) and  `r beta_time_inc_5_180$upper_ci - beta_time_inc_5_180$lower_ci` days (`r beta_time_inc_5_180$lower_ci` days to `r beta_time_inc_5_180$upper_ci` days) when the midpoint occurs at 80 and 180 days, respectively, but the width increases to `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days (`r beta_time_inc_5_280$lower_ci` days to `r beta_time_inc_5_280$upper_ci` days) when the midpoint occurs at 280 days. Second, the large amount of variability observed for the fixed-effect midpoint and satiation point parameters largely disappears when seven or more measurements are taken. As an example, the wide range of `r beta_time_inc_5_280$upper_ci - beta_time_inc_5_280$lower_ci` days for the fixed-effect midpoint parameter  decreases to `r beta_time_inc_7_280$upper_ci - beta_time_inc_7_280$lower_ci` days when seven measurements are taken (see (Figure \ref{fig:exp1_plot_time_increasing}F)).  

\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Time-Increasing Spacing}
  \label{fig:exp1_plot_time_increasing}
  \includegraphics{Figures/exp1_plot_likert_time increasing} \hfill{}
\end{figure}
\addtocounter{figure}{-1}
\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Time-Increasing Spacing (continued)}
  \includegraphics{Figures/exp1_plot_days_time increasing} \hfill{}
\caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\uptheta_{fixed}$ = 3.00, $\upalpha_{fixed}$ = 3.32, $\upbeta_{fixed}$ = 180.00, $\upgamma_{fixed}$ = 20.00, $\uptheta_{random}$ = 0.05, $\upalpha_{random}$ = 0.05, $\upbeta_{random}$ = 10.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel F, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviations. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:exp1-alpha-theta-removed} for the number of values removed for each parameter.}}
\end{figure}



### Time-decreasing spacing

```{r plots-time-decreasing-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time decreasing',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -60, beta_upper = 70, ticks = 10)
```

```{r text-values-time-decreasing-exp1, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_decreasing} shows the estimation accuracy (in terms of Likert-based or day-based units)each of the nine estimated parameters
when time-increasing spacing is used (error bars represent the middle 95% of estimated values and shaded horizontal lines indicate the population value).
Panels A--E show the estimation accuracy for parameters measured in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of 1--5)
and Panels F--I show the estimation accuracy for parameters measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error from the population
value (in number of days). 

As in the equal-spacing condition, estimation of Likert-unit parameters appears to be unaffected, whereas the estimation of day-unit parameters appears to incur considerable variability. Two general trends exist in the estimates of day-based parameters. First, for the fixed-effect midpoint and satiation point parameters ($\upbeta_{fixed}$ and $\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_increasing}F--G), variability increases exponentially when five measurements are taken and the midpoint moves from 280 to 80 days. As an example, the middle 95% of values estimated for the fixed-effect midpoint parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_decreasing}F) has widths of `r beta_time_dec_5_280$upper_ci - beta_time_dec_5_280$lower_ci` (`r beta_time_dec_5_280$upper_ci` days to `r beta_time_dec_5_280$lower_ci` days) and `r beta_time_dec_5_180$upper_ci - beta_time_dec_5_180$lower_ci` days (`r beta_time_dec_5_180$lower_ci` days to `r beta_time_dec_5_180$upper_ci` days) when the midpoint occurs at 280 and 180 days, respectively, but the width increases to `r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days (`r beta_time_inc_5_80$lower_ci` days to `r beta_time_inc_5_80$upper_ci` days) when the midpoint occurs at 80 days. Second, the large amount of variability observed for the fixed-effect midpoint and satiation point parameters largely disappears when seven or more measurements are taken. As an example, the wide range of `r beta_time_inc_5_80$upper_ci - beta_time_inc_5_80$lower_ci` days for the fixed-effect midpoint parameter decreases to `r beta_time_dec_7_280$upper_ci - beta_time_dec_7_280$lower_ci` days when seven measurements are taken (see (Figure \ref{fig:exp1_plot_time_increasing}F)).  

\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Time-Decreasing Spacing}
  \label{fig:exp1_plot_time_decreasing}
  \includegraphics{Figures/exp1_plot_likert_time decreasing} \hfill{}
\end{figure}
\addtocounter{figure}{-1}
\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Time-Decreasing Spacing (continued)}
  \includegraphics{Figures/exp1_plot_days_time decreasing} \hfill{}
\caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\uptheta_{fixed}$ = 3.00, $\upalpha_{fixed}$ = 3.32, $\upbeta_{fixed}$ = 180.00, $\upgamma_{fixed}$ = 20.00, $\uptheta_{random}$ = 0.05, $\upalpha_{random}$ = 0.05, $\upbeta_{random}$ = 10.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel F, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviations. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:exp1-alpha-theta-removed} for the number of values removed for each parameter.}}
\end{figure}


### Middle-and-extreme spacing

```{r plots-mid-ext-exp1, include=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Middle-and-extreme',
                                x_axis_name = 'Midpoint location (days)', 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -20, beta_upper = 20, ticks = 10)
```

```{r text-values-mid-ext-exp1, echoF}
beta_time_dec_5_80 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 80, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_180 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_5_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Middle-and-extreme', number_measurements == 5, midpoint == 280, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))

beta_time_dec_7_280 <- exp_1_analytical$days %>% 
  filter(measurement_spacing == 'Time decreasing', number_measurements == 7, midpoint == 180, grepl('beta\\[fixed\\]', parameter)) %>%
  select(lower_ci, upper_ci) %>%
  mutate(lower_ci = as.integer(lower_ci), 
         upper_ci = as.integer(upper_ci))
```

Figure \ref{fig:exp1_plot_time_mid_ext} shows the estimation accuracy (in terms of Likert-based or day-based units)each of the nine estimated parameters
when time-increasing spacing is used (error bars represent the middle 95% of estimated values and shaded horizontal lines indicate the population value).
Panels A--E show the estimation accuracy for parameters measured in Likert scale units ($\uptheta$ and $\upalpha$; measured on a range of 1--5)
and Panels F--I show the estimation accuracy for parameters measured in day units ($\upbeta$ and $\upgamma$). Note that, in Panel F, estimates for
$\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error from the population
value (in number of days). 

\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Middle-and-Extreme Spacing}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp1_plot_likert_middle-and-extreme} \hfill{}
\end{figure}
\addtocounter{figure}{-1}
\begin{figure}[H]
  \caption{Summary of Parameter Estimates for Middle-and-Extreme Spacing (continued)}
  \includegraphics{Figures/exp1_plot_days_middle-and-extreme} \hfill{}
\caption*{Note. \textup{Errors bars represent the middle 95\% of estimated values. Gray horizontal lines in each panel represent the population value for each parameter. Population values for each parameter are as follows: $\uptheta_{fixed}$ = 3.00, $\upalpha_{fixed}$ = 3.32, $\upbeta_{fixed}$ = 180.00, $\upgamma_{fixed}$ = 20.00, $\uptheta_{random}$ = 0.05, $\upalpha_{random}$ = 0.05, $\upbeta_{random}$ = 10.00, $\upgamma_{random}$ = 4.00, $\upepsilon$ = 0.03. Sample size is fixed to 225 (\textit{N} = 225). In Panel F, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Note that random-effect units are in standard deviations. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:exp1-alpha-theta-removed} for the number of values removed for each parameter.}}
\end{figure}

# Appendix
## Appendix A: Parameter estimate tables
### Experiment 1
```{r exp-table-generation, echo=F}
exp_1_tables <- create_table_data_sets(param_summary_data = param_summary_exp_1, 
                                       wide_var = 'midpoint', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_2_tables <- create_table_data_sets(param_summary_data = param_summary_exp_2, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'number_measurements')

exp_3_tables <- create_table_data_sets(param_summary_data = param_summary_exp_3, 
                                       wide_var = 'sample_size', first_col = 'measurement_spacing', second_col = 'time_structuredness') 

#remove measurement spacing columns 
col_to_remove <- which(str_detect(string = names(exp_3_tables$estimate_table), pattern = 'measurement_spacing'))

exp_3_tables$estimate_table <- exp_3_tables$estimate_table[, -col_to_remove]
exp_3_tables$removed_value_table <- exp_3_tables$removed_value_table[ , -col_to_remove]
```

```{r exp1-alpha-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'theta|alpha', 
            caption_name = 'Parameter Values Estimated in Experiment 1', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)',
                                '$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c('80', '180', '280'))
```

\addtocounter{table}{-1}
```{r exp1-beta-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'beta|gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)',
                                '$\\\\upgamma_{fixed}$(satiation point)', '$\\\\upgamma_{random}$(satiation point)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

\addtocounter{table}{-1}
```{r exp1-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_1_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'),
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

### Experiment 2

```{r exp2-theta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-alpha-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-beta-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'beta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-gamma-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upgamma_{fixed}$(midpoint)', '$\\\\upgamma_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-epsilon-param-est, echo=F}
print_param_table(table_ready_data = exp_2_tables$estimate_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```



## Appendix B: Number of values removed from data cleaning procedure

### Experiment 1
```{r exp1-alpha-theta-removed, echo=F}
print_param_table(table_ready_data = exp_1_tables$removed_value_table, parameter_name = 'theta|alpha', 
            caption_name = 'Number of Removed Values for Each Parameter Estimated in Experiment 1', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)',
                                '$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

\addtocounter{table}{-1}
```{r exp1-beta-gamma-removed, echo=F}
print_param_table(table_ready_data = exp_1_tables$removed_value_table, parameter_name = 'beta|gamma', 
            caption_name = 'Number of Removed Values for Each Parameter Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)',
                                '$\\\\upgamma_{fixed}$(satiation point)', '$\\\\upgamma_{random}$(satiation point)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

\addtocounter{table}{-1}
```{r exp1-epsilon-removed, echo=F}
print_param_table(table_ready_data = exp_1_tables$removed_value_table, parameter_name = 'epsilon', 
            caption_name = 'Number of Removed Values for Each Parameter Estimated in Experiment 1 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'),
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c(80, 180, 280))
```

### Experiment 2 

```{r exp2-theta-removed, echo=F}
print_param_table(table_ready_data = exp_2_tables$removed_value_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2', 
            col_header_name = c('$\\\\uptheta_{fixed}$(lower plateau)', '$\\\\uptheta_{random}$(lower plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-alpha-removed, echo=F}
print_param_table(table_ready_data = exp_2_tables$removed_value_table, parameter_name = 'theta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upalpha_{fixed}$(upper plateau)', '$\\\\upalpha_{random}$(upper plateau)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-beta-removed, echo=F}
print_param_table(table_ready_data = exp_2_tables$removed_value_table, parameter_name = 'beta', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upbeta_{fixed}$(midpoint)', '$\\\\upbeta_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-gamma-removed, echo=F}
print_param_table(table_ready_data = exp_2_tables$removed_value_table, parameter_name = 'gamma', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upgamma_{fixed}$(midpoint)', '$\\\\upgamma_{random}$(midpoint)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```

\addtocounter{table}{-1}
```{r exp2-epsilon-removed, echo=F}
print_param_table(table_ready_data = exp_2_tables$removed_value_table, parameter_name = 'epsilon', 
            caption_name = 'Parameter Values Estimated in Experiment 2 (continued)', 
            col_header_name = c('$\\\\upepsilon$(error)'), 
            IV_names =  c('Measurement Spacing', 'Number of Measurements'), 
            column_names = c("30", "50", "100", "200", "500", "1000"))
```


# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
