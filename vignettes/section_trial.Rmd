---
shorttitle        : "Measurement timing"
format          : "pandoc"
header-includes:
  - \usepackage{nccmath}
  - \usepackage{caption}
  - \usepackage{textcomp} #for copyright symbol on title page
  - \usepackage{longtable}
  - \usepackage{makecell}
  - \usepackage[section]{placeins}
  - \usepackage{setspace}
  - \usepackage{biblatex}
  - \usepackage{booktabs}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{xcolor}
  - \usepackage{amsthm} 
  - \usepackage{amsmath} ##needed for argmax
  - \usepackage{bm}  #thicker bold in math 
  - \DeclareMathOperator*{\argmax}{arg\,max}
  - \usepackage{setspace} #needed to doublespace caption text (using \doublespacing)
  - \usepackage[labelfont = {bf, up}]{caption} 
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
  - \usepackage{upgreek}  #required for non-italicized Greek letters
  - \usepackage{subcaption}
  - \captionsetup[figure]{labelfont={normalfont, bf}, singlelinecheck=false, labelsep=newline}
  - \DeclareCaptionFont{figCaptionFont}{\fontfamily{phv}\doublespacing} #sets caption font to sans serif font of Helvetica 
  - \DeclareCaptionFont{figCaptionSize}{\footnotesize} #set caption font size to footnote 
  - \DeclareCaptionFont{tabCaptionSize}{\small} #caption size for table title
  - \DeclareCaptionFont{figCaptionStyle}{\textup}  #set caption font to non-italicized font  
  - \DeclareCaptionLabelSeparator{captionSep}{\newline} #separates figure label and figure title with required white space
  - \captionsetup[figure]{labelfont={figCaptionStyle, bf}, font = {figCaptionFont,figCaptionSize, figCaptionStyle}, labelsep = captionSep, justification= raggedright}
  - \captionsetup[table]{labelfont={tabCaptionSize, bf}, font = {figCaptionFont, tabCaptionSize, figCaptionStyle}, labelsep = captionSep, justification= raggedright}
  - \newenvironment{helvenv}{\fontfamily{phv}\selectfont}{}
  - \raggedbottom #ensures text starts from top of page and any white space is at the botom

#both are needed to change font type of table footnotes
  - \usepackage{anyfontsize}
  - \AtBeginEnvironment{ThreePartTable}{\fontfamily{phv} \fontsize{10.5pt}{12pt}\selectfont} 
  - \AtBeginEnvironment{tablenotes}{\fontsize{10pt}{12pt}\selectfont} 

#environment numbering 
  - \setcounter{section}{0} 
  - \makeatletter \renewcommand\thesection{}\renewcommand\thesubsection{\@arabic\c@section.\@arabic\c@subsection} \makeatother

#set table line widths 
  - \setlength\cmidrulewidth{1pt}
  - \setlength\lightrulewidth{1pt}

  - \newtheorem{theorem}{Theorem}
  - \newtheorem{example}[theorem]{Example}
  - \renewcommand\theadfont{}
  #modifies heading levels of 4-5 to follow apa7
  - |
    \makeatletter
    \renewcommand{\paragraph}{\@startsection{paragraph}{4}{\parindent}%
      {0\baselineskip \@plus 0.2ex \@minus 0.2ex}%
      {-1em}%
      {\normalfont\normalsize\bfseries\typesectitle}}
    
    \renewcommand{\subparagraph}[1]{\@startsection{subparagraph}{5}{1em}%
      {0\baselineskip \@plus 0.2ex \@minus 0.2ex}%
      {-\z@\relax}%
      {\normalfont\normalsize\bfseries\itshape\hspace{\parindent}{#1}\textit{\addperi}}{\relax}}
    \makeatother
  
  
author: 
  - name          : "Sebastian Sciarra "
    affiliation   : "1"
    corresponding : yes    
    email         : "ssciarra@uoguelph.ca"
affiliation: 
  - id            : "1"
    institution   : "University of Guelph"
keywords          : "measurement timing, nonlinear "
wordcount         : "5554 words"
floatsintext      : yes
linkcolor         : blue
figsintext        : yes 
figurelist        : no
tablelist         : no
footnotelist      : no
numbersections    : yes
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa7"
csl               : "`r system.file('rmd', 'apa7.csl', package = 'papaja')`"
classoption       : "man"
output            : papaja::apa6_pdf
keep_tex: true
editor_options: 
  markdown: 
    wrap: 72
bibliography: dissertation_references.bib
---
```{r package_loading, include=F}
#load packages
library(easypackages)
packages <- c('devtools','tidyverse', 'RColorBrewer', 'parallel', 'data.table', 'kableExtra', 'ggtext', 'egg', 'nonlinSims','papaja', 
              'ggbrace', 'cowplot')
libraries(packages)
load_all()
```

```{r pre_knitting_setup_unfiltered, echo=F, eval=F, include=F}
#code should be computed before knitting to decrease knitting time 
#load data from experiments
exp_1 <- read_csv(file = 'data/exp_1_data.csv') %>% filter(code == 0)
exp_2 <- read_csv(file = 'data/exp_2_data.csv')
exp_3 <- read_csv(file = 'data/exp_3_data.csv')

#compute parameter summary statistics  
exp_1_long <- exp_1 %>%
    filter(code == 0) %>%
    #place parameter estimates in one column
    pivot_longer(cols = contains(c('theta', 'alpha', 'beta', 'gamma', 'epsilon')),
                 names_to = 'parameter', values_to = 'estimate') %>%
    filter(parameter == 'beta_fixed') %>%
    mutate(pop_value = midpoint)

exp_1_ordered <- order_param_spacing_levels(data = exp_1_long)

exp_1_ordered %>%
      #compute statistics for each parameter for each experimental variable
      group_by(parameter, .dots = locate_ivs(exp_1_ordered)) %>%
      summarize(
       lower_ci = compute_middle_95_estimate(param_data = estimate)[1],
       upper_ci = compute_middle_95_estimate(param_data = estimate)[2])

compute_parameter_summary(data = exp_1, exp_num = '1')

param_summary_exp_1 <- compute_parameter_summary(data = exp_1, exp_num = 1)
param_summary_exp_2 <- compute_parameter_summary(data = exp_2, exp_num = 2)
param_summary_exp_3 <- compute_parameter_summary(data = exp_3, exp_num = 3)

#necessary factor conversions 
param_summary_exp_1$number_measurements <- factor(param_summary_exp_1$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_1$midpoint <- factor(param_summary_exp_1$midpoint, levels = c(80, 180,280))

param_summary_exp_2$number_measurements <- factor(param_summary_exp_2$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_2$sample_size <- factor(param_summary_exp_2$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

param_summary_exp_3$number_measurements <- factor(param_summary_exp_3$number_measurements, levels = c(5, 7, 9,11))
param_summary_exp_3$sample_size <- factor(param_summary_exp_3$sample_size, levels = c(30, 50, 100, 200, 500, 1000))

#write data sets 
#save parameter summary files as RData files so that metadata are correctly stored (e.g., factor levels, variable types)
saveRDS(object = param_summary_exp_1, file = 'data/uf_param_summary_exp_1.RData')
saveRDS(object = param_summary_exp_2, file = 'data/uf_param_summary_exp_2.RData')
saveRDS(object = param_summary_exp_3, file = 'data/uf_param_summary_exp_3.RData')
```


```{r knitting_setup, echo=F, message = F, warning = F}
#import raw data files (needed for computing variances)
exp_1_raw <- convert_raw_var_to_sd(raw_data = read_csv('data/exp_1_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "measurement_spacing", "midpoint"), factor)
  
exp_2_raw <-convert_raw_var_to_sd(raw_data = read_csv('data/exp_2_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "measurement_spacing", "sample_size"), factor)

exp_3_raw <-convert_raw_var_to_sd(raw_data = read_csv('data/exp_3_data.csv')) %>%
  mutate_at(.vars = c("number_measurements", "time_structuredness", "sample_size"), factor)

#unfiltered data 
param_summary_exp_1 <- readRDS(file = 'data/uf_param_summary_exp_1.RData')
param_summary_exp_2 <- readRDS(file = 'data/uf_param_summary_exp_2.RData')
param_summary_exp_3 <- readRDS(file = 'data/uf_param_summary_exp_3.RData')

#create analytical versions of summary data + converts vars to sds
exp_1_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_1, exp_num = '1')
exp_2_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_2, exp_num = '2')
exp_3_analytical <- generate_likert_days_data_sets(summary_data = param_summary_exp_3, exp_num = '3')

combined_analytical_exp_1 <- rbind(exp_1_analytical$likert, exp_1_analytical$days)
combined_analytical_exp_2 <- rbind(exp_2_analytical$likert, exp_2_analytical$days)
combined_analytical_exp_3 <- rbind(exp_3_analytical$likert, exp_3_analytical$days)

#create condition summary data sets 
cond_summary_exp_1 <- compute_condition_summary(param_summary_data = combined_analytical_exp_1, facet_var = 'measurement_spacing', 
                          ind_vars = c('number_measurements', 'measurement_spacing', 'midpoint'))
cond_summary_exp_2 <- compute_condition_summary(param_summary_data = combined_analytical_exp_2, facet_var = 'measurement_spacing', 
                  ind_vars = c('number_measurements', 'measurement_spacing', 'sample_size'))

cond_summary_exp_3 <- compute_condition_summary(param_summary_data = combined_analytical_exp_3, facet_var = 'time_structuredness', 
                          ind_vars = c('number_measurements', 'sample_size', 'time_structuredness'))
```

## Results and Discussion

In the sections that follow, I organize the results by presenting them for each spacing schedule (equal, time-interval increasing, time-interval decreasing, middle-and-extreme). Importantly, only the results for the day-unit parameters will be presented (i.e., fixed- and random-effect days-to-halfway elevation and halfway-triquarter delta parameters [$\upbeta_{fixed}$, $\upbeta_{random}$, $\upgamma_{fixed}$, $\upgamma_{random}$, respectively]). The results for the likert-unit parameters (i.e., fixed- and random-effect baseline and maximal elevation parameters [$\uptheta_{fixed}$, $\uptheta_{random}$, $\upalpha_{fixed}$, $\upalpha_{random}$, respectively]) were largely trivial and so are presented in [Appendix C](#appendix-c)). 

For each spacing schedule, I first provide a concise summary of the results and then provide a detailed report of the estimation accuracy of each day-unit parameter of the logistic function. Because the lengths of the detailed reports are considerable, I provide concise summaries before the detailed reports to establish a framework to interpret the detailed reports. The detailed report of each spacing schedule present the results of each day-unit's parameter estimation plot,  modelling accuracy under each nature-of-change value, and then provide a qualitative summary.

### Equal Spacing

#### Concise Summary 

For equal spacing, Table \ref{tab:summary-table-equal-spacing-exp1} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp1_plot_equal} for the corresponding parameter estimation plots). Text within the 'Low Bias' and 'High Precision' columns indicates the number of measurements needed to, respectively, achieve low bias and high precision across all manipulated nature-of-change values. Bolded text in the 'Low Bias' and 'Qualitative Summary' columns indicates the measurement number that, respectively, achieves low bias and the greatest improvements in bias and precision across all day-unit parameters and manipulated nature-of-change values. The 'Error Bar Length' column indicates the error bar length that results from using the measurement number that achieves the greatest improvements in bias and precision. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values.

With respect to bias under equal spacing, it is low in all cells for every day-unit parameter except the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$), where bias is low across all manipulated nature-of-change values with 11 measurements. Therefore, with equal spacing, low bias can be achieved in the estimation of all day-unit parameters using either using eleven measurements. 

With respect to precision under equal spacing, a pattern different from that with bias occurs. For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), precision is high across all cells. For the fixed-effect triquarter-halfway delta prameter ($\upgamma_{fixed}$), precision is high across all manipulated nature-of-change values using nine or more measurements. For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$]), precision is low in all cells. Therefore, with equal spacing, although the fixed-effect day-unit parameters can be estimated with high precision across all manipulated nature-of-change values using nine or more measurements, no manipulated measurement number allows the random-effect day-unit parameters to be modelled with high precision.  

In summarizing the results for equal spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using nine or more measurements (see [bias](#bias-equal-exp1)). High precision is never achieved in the estimation of all day-unit parameters with any manipulated measurement (see [precision](#precision-equal-exp1)). With respect to modelling accuracy across the manipulated nature-of-change values, equal spacing obtains the greatest modelling accuracy with a nature-of-change value of 180 (see [nature-of-change modelling accuracy]({#nature-change-equal-exp1})). Although it may be discouraging that no manipulated measurement number under equal spacing achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters are achieved with moderate measurement numbers. With equal spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved using seven measurements(for discussion, see [qualitative summary](#qualitative-equal-exp1)). 

```{r summary-table-equal-spacing-exp1, echo=F}
errorbar_lengths <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Equal spacing', num_measurements = 7)

summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_equal}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_equal}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_equal}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_equal}D)}'), 
                            'Low Bias' = c('All cells', 
                                           'All cells', 
                                           'All cells', 
                                           '\\textbf{NM $\\boldsymbol{\\ge}$ 9}'), 
                            
                            'High Precision' = c('All cells', 
                                            'NM $\\ge$ 9', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Summary' = c('Largest improvements in precision with NM = 7', 
                                                      'Largest improvements in precision with NM = 7', 
                                                      'Largest improvements in precision with NM = 7', 
                                                      'Largest improvements in bias and precision with \\textbf{NM = 7}'),
                            'Error Bar Length' = errorbar_lengths$errorbar_length, 
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c(rep('l', times = ncol(summary_table))), 
    caption = 'Concise Summary of Results for Equal Spacing in Experiment 1') %>%
    #header
  column_spec(column = 1, width = '2cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '4cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Summary' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.2pc}',
           general = "Bolded text in the `Low Bias' and `Qualitative Summary' columns indicates the number of measurements needed to, respectively, achieve low bias and the greatest improvements in bias and precision across all day-unit parameters (high precision not achieved in the estimation of all day-unit parameters with equal spacing). `Error Bar Length' indicates the longest error bar length that results from using the measurement number in the `Qualitative Summary` column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\{80, 180, 280\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```


#### Detailed Report

For equal spacing, Figure \ref{fig:exp1_plot_equal} and Table \ref{tab:omega-exp1-equal} show the results. Figure \ref{fig:exp1_plot_equal} shows the parameter estimation plots for each day-unit parameter and  Table \ref{tab:omega-exp1-equal} provides the partial $\upomega^2$ values for each independent variable of each day-unit parameter. In Figure \ref{fig:exp1_plot_equal}, error bars represent the middle 95% of estimated values, blue horizontal lines indicate the population values for each parameter (with population values of $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00), and gray bands specify the acceptable margins of error (i.e., 10% of the parameter's population value). I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20% of the parameter's population value as indicative of low-precision estimation. Panels A--B show the parameter estimation plots for the fixed- and random-effect days-to-halfway elevation parameters ($\upbeta_{fixed}$ and $\upbeta_{random}$, respectively). Panels C--D show the parameter estimation plots for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively). Note that random-effect parameter units are in standard deviation units. Importantly, across all population values used for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180. 

##### Bias {#bias-equal-exp1}

For all simulations pertaining to equal spacing (see Figure \ref{fig:exp1_plot_equal}), instances of high bias only occur in the estimation of the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_equal}D). The gray bands indicate the $\pm 10\%$ margin of error. I classified dots that fell outside the gray band as biased and these dots remained unfilled. Note that the gray 10% margin of error bands for the random-effect parameters in Figures \ref{fig:exp1_plot_equal}C--D are difficult to see because 10% of the parameters' population values yield small values relative to the range of the y-axis (i.e., 10% of 4.00 is 0.40 and 10% of 10 is 1.00, which are both small relative to the y-axis range of 55). 

For the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_equal}D), dots fall outside the gray 10% margin of error band the five-measurements line (squares) with all manipulated nature-of-change values and on the seven-measurements line (circles) with nature-of-change values of 180 and 280.  Therefore, using equal spacing, random-effect halfway-triquarter delta parameter ($\upgamma_{random}$)---along with all the day-unit parameters---can be estimated with low bias across all manipulated nature of change values using nine or more measurements. 

```{r plots-equal-exp1, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Equal spacing',
                                x_axis_name = expression("Nature of Change (Population Value Set for"~beta[fixed]~')'), 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -30, beta_upper = 25, beta_ticks = 5)

```


```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Equal Spacing in Experiment 1}
  \label{fig:exp1_plot_equal}
  \includegraphics{Figures/exp1_plot_days_equal spacing} \hfill{}
\end{figure}
\begin{figure}[H]
\caption*{Note. \textup{Panel A: Parameter estimation plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Parameter estimation plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Parameter estimation plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Parameter estimation plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating cells with variability greater than 20\% of the parameter's population value. I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20\% of the parameter's population value as indicative of low-precision estimation. Note that random-effect parameter units are in standard deviation units. Importantly, across all nature-of-change values (i.e., population values used for $\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:omega-exp1-equal} for $\upomega^2$ effect size values.}}
\end{figure}
```

\newpage 
```{r omega-exp1-equal, echo=F}
print_bias_var_omega_table(exp_data = exp_1_raw, target_col = 'measurement_spacing', target_value = 'equal', 
ind_vars = c('number_measurements', 'midpoint'), 
ind_var_acronyms = c('NM', 'NC', 'NM x NC'), 
caption = 'Partial $\\upomega^2$ Values for Manipulated Variables With Equal Spacing in Experiment 1',
footnote = 'NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, NC = nature of change (population value set for $\\\\upbeta_{fixed}$ $\\\\in$ \\\\{80, 180, 280\\\\}), NM x NC = interaction between number of measurements and population value set for $\\\\upbeta_{fixed}$. $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter.', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_equal}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_equal}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_equal}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_equal}D)'))
```
 

##### Precision {#precision-equal-exp1}

For all simulations pertaining to equal spacing (see Figure \ref{fig:exp2_plot_equal}), instances of low precision occur for all day-unit parameters except the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_equal}A). I considered precision to be low if the length of an error bar covered a range of values larger than 20% of the parameter's population value. Error bars indicating low precision are coloured in light blue. 

For the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp2_plot_equal}B), error bar lengths are longer than the 20% acceptable amount with five measurements (squares) across all manipulated nature-of-change values (shown on x-axis) and with seven measurements (circles) for a nature-of-change value of 180. Therefore, using equal spacing, high precision can be achieved in the estimation of the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) across all manipulated nature-of-change values using nine or more measurements. 

For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] in Figure \ref{fig:exp1_plot_equal}C and the random-effect halfway-triquarter delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp2_plot_equal}D), error bar lengths are longer than the 20% acceptable amount across all the cells. Therefore, with equal spacing, precision is low for the estimation of the random-effect day-unit parameters across all the manipulated nature-of-change values. 

In summary, with equal spacing, high precision is achieved in the estimation of the fixed-effect day-unit parameters across all manipulated nature of change values with nine or more measurements, but no manipulated measurement number achieves high precision in the estimation of the random-effect day-unit parameters. 

##### Modelling Accuracy Across Nature-of-Change Values {#nature-change-equal-exp1}

For equal spacing, Table \ref{tab:errorbar-equal-nc} lists the error bar lengths for each day-unit parameter and nature-of-change value. Although modelling accuracy is determined by bias and precision, results for bias are not discussed or computed because the differences in bias across the nature-of-change values are negligible. Note that error bar lengths are computed by computing the average length across all manipulated number-of-measurement values. The column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths under equal spacing. Across all the manipulated nature-of-change values, errorbar lengths are shortest with a nature-of-change value of 180. 

One important result to discuss concerns the error bar length of the random-effect triquarter-halfway elevation parameter($\upgamma_{random}$) across the nature-of-change values. In contrast to the error bar lengths for all the other day-unit parameters, the error bar length for the triquarter-halfway elevation parameter ($\upgamma_{random}$) is longest with a nature-of-change value of 180. Figure \ref{fig:density_gamma_equal} shows the density plots of the triquarter-halfway elevation parameter ($\upgamma_{random}$) for each nature-of-change value. Regions shaded in in gray represent the the middle 95% of estimated values and the width of the shaded regions is indicated by the length of the horizontal error bars. As originally presented in Table \ref{tab:errorbar-equal-nc}, Figure \ref{fig:density_gamma_equal}B shows that the error bar lengths are longest the nature-of-change value is 180. 

In looking across the density plots in Figure \ref{fig:density_gamma_equal}, it becomes clear that the error bar lengths are longest with a nature-of-change value of 180 because of the existence of high-value outliers. Importantly, the high-value outliers in the density plot of the random-effect triquarter-halfway parameter ($\upgamma_{random}$) with a nature-of-change value of 180 (Figure \ref{fig:density_gamma_equal}B) correspond to the maximum possible value that was set in the model specification (specifically, a maximum value of $\upgamma_{random}$) = 45.00). Table \ref{tab:equal-gamma-outlier} lists the number of maximum-value estimates that result for the random-effect triquarter-halfway parameter ($\upgamma_{random}$) for each nature-of-change value. With a nature-of-change value of 180, 36 maximum-value estimates are obtained. With nature-of-change values of 80 and 280, no maximum-value estimates are obtained. Therefore, the error bar length with a nature-of-change value of 180 may be artificially inflated because of the presence of maximum-value estimates. 

For equal spacing, Figure \ref{fig:density_gamma_equal_fixed} shows the density plots of the random-effect triquarter-halfway parameter ($\upgamma_{random}$) with the maximum-value estimates removed. Although the error bar length with a nature-of-change value of 180 has decreased relative to the length in Figure \ref{fig:density_gamma_equal}B, it is still longer than the error bar lengths with the other nature-of-change values of 80 and 180 due to the existence of high-value estimates. Therefore, with equal spacing with a nature-of-change value of 180, precision is counterintuitively lower for the estimation of the triquarter-halfway parameter ($\upgamma_{random}$) than with other nature-of-change values because the parameter estimation procedure converges on more high-value estimates. 

```{r errorbar-equal-nc, echo=F}
param_midpoint_equal <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'Equal')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)

param_midpoint_equal$parameter <- factor(x = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_equal}A)', 
                                        '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_equal}B)', 
                                        '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_equal}C)', 
                                       '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_equal}D)'))

param_midpoint_equal$`180`<- c(as.character(round(param_midpoint_equal$`180`[1:3], digits = 2)),
                                   paste(as.character(round(param_midpoint_equal$`180`[4], digits = 2)), '\\textsuperscript{a}', sep = ''))
  
kbl(x = param_midpoint_equal, format = 'latex',digits = 2, 
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c('l', rep('c', times = ncol(param_midpoint_equal) - 1)), col.names = c('Parameter', '80', '180', '280'), 
    caption = 'Error Bar Lengths Across Nature-of-Change Values Under Equal Spacing in Experiment 1') %>%
      #header
    add_header_above(header = c(' ' = 1, 'Population Value of $\\\\upbeta_{fixed}$' = 3), escape = F) %>%
    column_spec(column = 3, background = '#DFDEDE') %>%
    column_spec(column = 1, width = '4cm') %>%
    column_spec(column = c(2:4), width = '3cm') %>%
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.2pc}',
           general = "Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\{80, 180, 280\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all number-of-measurement (NM) values (NM $\\\\in$ \\\\{5, 7, 9, 11\\\\}). Column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths.", 
           alphabet_title = '\\\\newline', alphabet = "Error bar length is longer than with other nature-of-change values because estimation procedure converges on larger $\\\\upgamma_{random}$ values with a nature-of-change value of $\\\\upbeta_{fixed}$ = 180 (see Figures \\\\ref{fig:density_gamma_equal}--\\\\ref{fig:density_gamma_equal_fixed} and Table \\\\ref{tab:equal-gamma-outlier}).") %>%
  kable_styling(position = 'left')
```

```{r density-nature-of-change-equal, include=F, eval=F}
compute_density <- function(error_bar_range, group, param_name, density_data) { 
  
  density_data <- density_data[density_data$group == group , ]
  
  density_lower_x <- min(which(density_data$x >= error_bar_range[1]))
  density_upper_x <- max(which(density_data$x <= error_bar_range[2]))
  
  day_values <- density_data$x[density_lower_x:density_upper_x]
  
  
  density_df <- data.frame('parameter' = param_name,
                           'day_value' = day_values,
                           'probability' = density_data$y[density_lower_x:density_upper_x], 
                           'max_density_value' = max(density_data$y),
                           'lower_ci' = error_bar_range[1], 
                           'upper_ci' = error_bar_range[2])

    return(density_df)
}

compute_ind_param_error_bar_range <- function(param_search_name, param_data) {
  
  #extract estimates from single parameter
  ind_param_data <-  param_data %>%
    filter(str_detect(string = param_data$parameter, pattern = param_search_name)) %>% 
    pull(estimate)
  
  param_range <- as.numeric(compute_middle_95_estimate(param_data = ind_param_data))
  
  return(param_range)
}

##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_1 <- read_csv('data/exp_1_data.csv') %>% filter(code == 0) #load data 
exp_1 <- convert_raw_var_to_sd(raw_data = exp_1) #var to sd conversion 

parameter_names <- c(bquote(expr = bold(A:~gamma[random]~"("~beta[fixed]~" = 80, NM = 5)")),
                     quote(expr = bold(B:~gamma[random]~"("~beta[fixed]~" = 180, NM = 5)")),
                     bquote(expr = bold(C:~gamma[random]~"("~beta[fixed]~" = 280, NM = 5)")))

                     
#1) Extract estimates for four parameter gamma_fixed and beta_rand when N =500 or 1000, num_measurements == 5, spacing == equal. 
##Convert to long format, with parameter name going into unique column and estimate becoming new column 
 param_data <- exp_1 %>%
  filter(number_measurements == 5, measurement_spacing == 'equal') %>%
  select(locate_ivs(exp_1),'gamma_rand') %>%
  pivot_longer(cols = c(gamma_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', c(midpoint,name)) #%>%
  #filter(estimate < 45)

#2) Replace parameter values with tag labels. 
param_data$parameter <- factor(param_data$parameter, 
                               levels = c("80_gamma_rand", "180_gamma_rand", "280_gamma_rand"), 
                               labels = parameter_names)


#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

param_search_names <- c("A\\:", "B\\:", "C\\:")

param_error_bar_ranges <- lapply(X = param_search_names, compute_ind_param_error_bar_range, param_data = param_data)


##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


example_plot <- base_density_plot +
  scale_x_continuous(limits = c(0, 50), breaks = seq(from = 0, to = 50, by = 10), 
                       name = 'Value of Parameter Estimate (Days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
  
  facet_wrap_custom( ~ parameter, scales = "free", ncol = 1, nrow = 3,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,scale_y_continuous(name =  'Density (Proportion of Estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))),
                                                                 scale_override(2, scale_y_continuous(name = 'Density (Proportion of Estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))), 
                                                                 scale_override(3, scale_y_continuous(name = 'Density (Proportion of Estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))))) + 
    
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 75, margin = unit(c(t = 0, r = 20, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  #create PDF of faceted plot
 set_panel_size(p = example_plot, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_equal_gamma_exp1.pdf')
 
 #set_panel_size(p = example_plot, height = unit(x = 28, units = 'cm'),
 #               width = unit(x = 40, units = 'cm'),
 #               file =  'Figures/density_plots_equal_gamma_filtered_exp1.pdf')
```


```{=tex}
\begin{figure} [H]
  \caption{Density Plots of the Random-Effect Halfway-Triquarter Delta ($\upgamma_{random}$; Figure \ref{fig:exp2_plot_equal}D) With Equal Spacing in Experiment 1 (95\% Error Bars)}
  \label{fig:density_gamma_equal}
  \includegraphics[height = 15cm, width = 25cm]{Figures/density_plots_equal_gamma_exp1} \hfill{}
  \caption*{Note. \textup{Regions shaded in in gray represent the the middle 95\% of estimated values and the width of the shaded regions is indicated by the length of the horizontal error bars. The error bar length if longest when the nature-of-change value is 180. $\upgamma_{random}$ = random-effect triquarter-halfway delta parameter, with population value of 4.00, NM = number of measurements.}}
\end{figure}
```

```{r equal-gamma-outlier, echo=F}
##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_1 <- read_csv('data/exp_1_data.csv') %>% filter(code == 0) #load data 
exp_1 <- convert_raw_var_to_sd(raw_data = exp_1) #var to sd conversion 


equal_gamma <- exp_1 %>%
  filter(number_measurements == 5, measurement_spacing == 'equal') %>%
  select(locate_ivs(exp_1),'gamma_rand') %>%
  pivot_longer(cols = c(gamma_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', c(midpoint,name))

table_ready <- equal_gamma %>% 
  group_by(parameter) %>%
  summarize(`Number of Maximum-Value Estimates`= sum(estimate == 45)) %>%
  separate(col = parameter, into = c('Nature-of-Change Value', 'Parameter'), extra = 'drop') %>%
  select(Parameter, `Nature-of-Change Value`, `Number of Maximum-Value Estimates`) %>% 
  arrange(as.numeric(`Nature-of-Change Value`))

table_ready$Parameter <- c('$\\upgamma_{random}$ (Figure \\ref{fig:density_gamma_equal}A)', 
                           '$\\upgamma_{random}$ (Figure \\ref{fig:density_gamma_equal}B)', 
                           '$\\upgamma_{random}$ (Figure \\ref{fig:density_gamma_equal}C)')


kbl(x = table_ready, format = 'latex',digits = 2, 
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c('l', rep('c', times = ncol(table_ready) - 1)),
    caption = 'Number of Number of Maximum-Value Estimates Obtained for $\\upgamma_{random}$ With Each Nature-of-Change Value Under Equal Spacing in Experiment 1') %>%
    #header
  column_spec(column = 1, width = '4cm') %>%
 column_spec(column = 2, width = '5cm') %>%
   column_spec(column = 3, width = '8cm') %>%

  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.1pc}',
           general = " $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter, with population value of 4. The maximum $\\\\upgamma_{random}$ value is 45.00.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```

```{=tex}
\begin{figure} [H]
  \caption{Density Plots of $\upgamma_{random}$ (Figure \ref{fig:exp2_plot_equal}D) With Equal Spacing in Experiment 1 (95\% Error Bars With Maximum-Value Estimates Removed)}
  \label{fig:density_gamma_equal_fixed}
  \includegraphics[height = 15cm, width = 25cm]{Figures/density_plots_equal_gamma_filtered_exp1} \hfill{}
  \caption*{Note. \textup{Regions shaded in in gray represent the the middle 95\% of estimated values and the width of the shaded regions is indicated by the length of the horizontal error bars. Maximum-value estimates correspond to $\upgamma_{random}$ estiamtes of 45.00. $\upgamma_{random}$ = random-effect triquarter-halfway delta parameter, with population value of 4.00 and NM = number of measurements. Maximum-value estimates of $\upgamma_{random}$ have a value of 45.00.}}
\end{figure}
```

In summary, under equal spacing, modelling accuracy for all the day-unit parameters (with one exception) is greatest when the nature-of-change value set by the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) has a value of 180. For the exception, modelling accuracy (as indicated by precision) is lower for the random-effect triquarter-halfway elevation parameter ($\upgamma_random$) with a nature-of-change value of 180 because of high-value estimates. 

##### Qualitative Summary  
```{r echo=F}
errorbar_lengths <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Equal spacing', num_measurements = 7)$errorbar_length

```

For equal spacing in Figure \ref{fig:exp1_plot_equal}, although no manipulated measurement number achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) are achieved using moderate measurements numbers. With respect to bias under equal spacing, the largest improvements in bias across all manipulated nature-of-change values occur with the following measurement numbers for the following day-unit parameters (note that only the random-effect triquarter halfway delta parameter [$\upgamma_{random}$] had instances of low bias): 

* random-effect triquarter-halfway delta parameters ($\upgamma_{random}$): seven measurements

\noindent With respect to precision under equal spacing, the largest improvements precision in the estimation of all day-unit parameters (except the fixed-effect days-to-halfway elevation parameter [$\upbeta_{fixed}$]) are achieved with following measurement numbers:

* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[2]` days.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements,which results in a maximum error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): seven measurements,which results in a maximum error bar length of `r errorbar_lengths[4]` days.

\noindent Therefore, for equal spacing, seven measurements number achieves the greatest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values. 

### Time-Interval Increasing Spacing

#### Concise Summary  

For time-interval increasing spacing, Table \ref{tab:summary-table-time-inc-exp1} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp1_plot_time_inc} for the corresponding parameter estimation plots). Text within the 'Low Bias' and 'High Precision' columns indicates the number of measurements needed to, respectively, achieve low bias and high precision across all manipulated nature-of-change values. Bolded text in the 'Low Bias' and 'Qualitative Summary' columns indicates the measurement number that, respectively, achieves low bias and the greatest improvements in bias and precision across all day-unit parameters and manipulated nature-of-change values. The 'Error Bar Length' column indicates the error bar length that results from using the measurement number that achieves the greatest improvements in bias and precision. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values.

With respect to bias under time-interval increasing spacing, it is low in all cells for every day-unit parameter except the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$), where bias is low across all manipulated nature-of-change values with nine measurements. Therefore, with time-interval increasing spacing, low bias can be achieved in the estimation of all day-unit parameters using using nine measurements. 

With respect to precision under time-interval increasing spacing, a pattern different from that with bias occurs. For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), precision is high across all manipulated nature-of-change values using seven or more measurements. For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$), precision is high across all manipulated nature-of-change values using nine or more measurements. For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$]), precision is low in all cells. Therefore, with time-interval increasing spacing, although the fixed-effect day-unit parameters can be estimated with high precision across all manipulated nature-of-change values using nine or more measurements, no manipulated measurement number allows the random-effect day-unit parameters to be modelled with high precision.  

In summarizing the results for time-interval increasing spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using nine or more measurements (see [bias](#bias-time-inc-exp1)). High precision is never achieved in the estimation of all day-unit parameters with any manipulated measurement (see [precision](#precision-time-inc-exp1)). With respect to modelling accuracy across the manipulated nature-of-change values, time-interval increasing spacing obtains the greatest modelling accuracy with a nature-of-change value of 80 (see [nature-of-change modelling accuracy]({#nature-change-time-inc-exp1})). Although it may be discouraging that no manipulated measurement number under time-interval increasing spacing achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters are achieved with moderate measurement numbers. With time-interval increasing spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved using nine measurements (for discussion, see [qualitative summary](#qualitative-time-inc-exp1)).  


```{r summary-table-time-inc-exp1, echo=F}
errorbar_lengths_nm7 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, 
                                             iv_level = 'Time-interval increasing', num_measurements = 7)
errorbar_lengths_nm9 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, 
                                             iv_level = 'Time-interval increasing', num_measurements = 9)

errorbar_lengths <- c(errorbar_lengths_nm7$errorbar_length[1], errorbar_lengths_nm9$errorbar_length[2], 
                     errorbar_lengths_nm7$errorbar_length[3], errorbar_lengths_nm9$errorbar_length[4])


summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_inc}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_inc}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_inc}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_inc}D)}'), 
                            'Low Bias' = c('All cells', 
                                       'All cells', 
                                       'NM $\\ge$ 7', 
                                       '\\textbf{NM $\\ge$ 9}'), 
                            'High Precision' = c('NM $\\ge$ 7', 
                                            'NM $\\ge$ 9', 
                                            'No cells',
                                            'No cells'), 
                            'Qualitative Summary' = c('Largest improvement in precision with NM = 7', 
                                                      'Largest improvement in precision with \\textbf{NM = 9}', 
                                                      'Largest improvement in bias and precision with NM = 7', 
                                                     'Largest improvements in bias and precision with \\textbf{NM = 9}'), 
                            'Error Bar Length' = errorbar_lengths,
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Concise Summary of Results for Time-Interval Increasing Spacing in Experiment 1', 
    align = c(rep('l', times = ncol(summary_table)))) %>%
     #header
 column_spec(column = 1, width = '2cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '4cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Summary' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.2pc}',
           general = "Bolded text in the `Low Bias' and `Qualitative Summary' columns indicates the number of measurements needed to, respectively, achieve low bias and the greatest improvements in bias and precision across all day-unit parameters (high precision not achieved in the estimation of all day-unit parameters with time-interval increasing spacing). `Error Bar Length' indicates the longest error bar length that results from using the measurement number in the `Qualitative Summary` column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')
```

```{r density-plot-functions, include=F, eval=F}
compute_ind_param_error_bar_range <- function(param_search_name, param_data) {
  
  #extract estimates from single parameter
  ind_param_data <-  param_data %>%
    filter(str_detect(string = param_data$parameter, pattern = param_search_name)) %>% 
    pull(estimate)
  
  param_range <- as.numeric(compute_middle_95_estimate(param_data = ind_param_data))
  
  return(param_range)
}

compute_80_ind_param_error_bar_range <- function(param_search_name, param_data) {
  
  #extract estimates from single parameter
  ind_param_data <-  param_data %>%
    filter(str_detect(string = param_data$parameter, pattern = param_search_name)) %>% 
    pull(estimate)
  
  param_range <- as.numeric(compute_middle_80_estimate(param_data = ind_param_data))
  
  return(param_range)
}

compute_90_ind_param_error_bar_range <- function(param_search_name, param_data) {
  
  #extract estimates from single parameter
  ind_param_data <-  param_data %>%
    filter(str_detect(string = param_data$parameter, pattern = param_search_name)) %>% 
    pull(estimate)
  
  param_range <- as.numeric(compute_middle_90_estimate(param_data = ind_param_data))
  
  return(param_range)
}

compute_density <- function(error_bar_range, group, param_name, density_data) { 
  
  density_data <- density_data[density_data$group == group , ]
  
  density_lower_x <- min(which(density_data$x >= error_bar_range[1]))
  density_upper_x <- max(which(density_data$x <= error_bar_range[2]))
  
  day_values <- density_data$x[density_lower_x:density_upper_x]
  
  
  density_df <- data.frame('parameter' = param_name,
                           'day_value' = day_values,
                           'probability' = density_data$y[density_lower_x:density_upper_x], 
                           'max_density_value' = max(density_data$y),
                           'lower_ci' = error_bar_range[1], 
                           'upper_ci' = error_bar_range[2])

    return(density_df)
}
```

```{r exp1-density-plot-time-inc, include=F, eval=F}
##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_1 <- read_csv('data/exp_1_data.csv') %>% filter(code == 0) #load data 
exp_1 <- convert_raw_var_to_sd(raw_data = exp_1) #var to sd conversion 

parameter_names <- c(bquote(expr = bold(A:~gamma[random]~(beta[fixed]~" = 280, 5 measurements"))),
                     bquote(expr =bold(B:~gamma[random]~(beta[fixed]~" = 280, 7 measurements"))))
                     
#1) Extract estimates for four parameter gamma_fixed and beta_rand when N =500 or 1000, num_measurements == 5, spacing == equal. 
##Convert to long format, with parameter name going into unique column and estimate becoming new column 
param_data <- exp_1 %>%
  filter(number_measurements <= 7, measurement_spacing == 'time_inc', midpoint == 280) %>%
  select(locate_ivs(exp_1),'gamma_rand') %>%
  pivot_longer(cols = c(gamma_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', c(number_measurements,name))

#2) Replace parameter values with tag labels. 
param_data$parameter <- factor(param_data$parameter, 
                               levels = c("5_gamma_rand", "7_gamma_rand"), 
                               labels = parameter_names)

base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

param_search_names <- c("A\\:", "B\\:")

param_error_bar_ranges <- lapply(X = param_search_names, compute_ind_param_error_bar_range, param_data = param_data)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


example_plot <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 1, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))),
                                                                 scale_override(2, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 55, margin = unit(c(t = 0, r = 6, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = example_plot, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_time_inc_exp1.pdf')

```

```{r exp1-density-plot-time-inc-fixed, include=F, eval=F}
param_error_bar_ranges <- lapply(X = param_search_names, compute_80_ind_param_error_bar_range, param_data = param_data)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


time_inc_fixed_density <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 1, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 55, margin = unit(c(t = 0, r = 6, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = time_inc_fixed_density, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_time_inc_exp1_fixed.pdf')

```

#### Detailed Report 

For time-interval increasing spacing, Figure \ref{fig:exp1_plot_time_inc} and Table \ref{tab:omega-exp1-time-inc} show the results. Figure \ref{fig:exp1_plot_time_inc} shows the parameter estimation plots for each day-unit parameter and Table \ref{tab:omega-exp1-time-inc} provides the partial $\upomega^2$ values for each independent variable of each day-unit parameter. In Figure \ref{fig:exp1_plot_time_inc}, error bars represent the middle 95% of estimated values, blue horizontal lines indicate the population values for each parameter (with population values of $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00), and gray bands specify the acceptable margins of error (i.e., 10% of the parameter's population value). I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20% of the parameter's population value as indicative of low-precision estimation. Panels A--B show the parameter estimation plots for the fixed- and random-effect days-to-halfway elevation parameters ($\upbeta_{fixed}$ and $\upbeta_{random}$, respectively). Panels C--D show the parameter estimation plots for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively). Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Importantly, across all population values used for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180. 

##### Bias 

For all simulations pertaining to time-interval increasing spacing (see Figure \ref{fig:exp1_plot_time_inc}), instances of high bias occur in the estimation of the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] and the random-effect triquarter-halfway delta parameter [$\upgamma_{fixed}$]). The gray bands indicate the $\pm 10\%$ margin of error. I classified dots that fell outside the gray band as biased and these dots remained unfilled. Note that the gray 10% margin of error bands for the random-effect parameters in Figures \ref{fig:exp1_plot_time_inc}C--D are difficult to see because 10% of the parameters' population values yield small values relative to the range of the y-axis (i.e., 10% of 4.00 is 0.40 and 10% of 10 is 1.00, which are both small relative to the y-axis range of 55). 

For the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp1_plot_time_inc}C), dots only fall outside the gray 10% margin of error band on the five-measurements line (squares) at a nature-of-change value of 280 (shown on x-axis). Therefore, using time-interval increasing spacing, low bias can be achieved in the estimation of the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$) across all nature-of-change values by using seven or more measurements. 
For the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_inc}D), dots fall outside the gray 10% margin of error band at on the five-measurements line (squares) across all manipulated nature-of-change values (shown on x-axis) and on the seven-measurements line (circles) at nature-of-change values of 180 and 280. Therefore, using time-interval increasing spacing, low bias can be achieved in the estimation of the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) across all nature-of-change values by using seven or more measurements. 

In summary, with time-interval increasing spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using nine or more measurements. 

```{r plots-time-increasing-exp1, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval increasing',
                                x_axis_name = expression("Population Value Set for"~beta[fixed]), 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -60, beta_upper = 60, beta_ticks = 10)
```

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Time-Interval Increasing Spacing in Experiment 1}
  \label{fig:exp1_plot_time_inc}
  \includegraphics{Figures/exp1_plot_days_time-interval increasing_mod} \hfill{}
\end{figure}
\begin{figure}[H]
\caption*{Note. \textup{Panel A: Parameter estimation plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Parameter estimation plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Parameter estimation plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Parameter estimation plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating cells with variability greater than 20\% of the parameter's population value. I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20\% of the parameter's population value as indicative of low-precision estimation. Note that random-effect parameter units are in standard deviation units. Importantly, across all nature-of-change values (i.e., population values used for $\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:omega-exp1-time-inc} for $\upomega^2$ effect size values.}}
\end{figure}
```

\newpage 
```{r omega-exp1-time-inc, echo=F}
print_bias_var_omega_table(exp_data = exp_1_raw, target_col = 'measurement_spacing', target_value = 'time_inc', 
ind_vars = c('number_measurements', 'midpoint'), 
ind_var_acronyms = c('NM', 'NC', 'NM x NC'), 
caption = 'Partial $\\upomega^2$ Values for Manipulated Variables With Time-Interval Decreasing Spacing in Experiment 1',
footnote = 'NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, NC = nature of change (population value set for $\\\\upbeta_{fixed}$ $\\\\in$ \\\\{80, 180, 280\\\\}), NM x NC = interaction between number of measurements and population value set for $\\\\upbeta_{fixed}$. $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter.', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_time_inc}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_time_inc}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_time_inc}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_time_inc}D)'))
```


##### Precision

For all simulations pertaining to time-interval increasing spacing (see Figure \ref{fig:exp1_plot_time_inc}), instances of low precision occurred in the estimation of all parameters. I considered precision to be low if the length of an error bar covered a range of values larger than 20% of the parameter's population value. Error bars indicating low precision are coloured in light blue. 

For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_inc}A), error bar lengths are longer than the 20% acceptable amount with five measurements (squares) and a nature-of-change value of 280 (shown on x-axis). Therefore, with time-interval increasing spacing, seven or more measurements are needed to estimate the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) with high precision across all manipulated nature of change values.

For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_inc}B), error bar lengths are longer than the 20% tolerated amount with five measurements (squares) across all manipulated nature-of-change values (shown on x-axis) with seven measurements (circles) across all nature-of-change values. Therefore, with time-interval increasing spacing, the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) can be estimated with high precision across all manipulated nature-of-change values using nine or more measurements. 

For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] in Figure \ref{fig:exp1_plot_time_inc}C and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp1_plot_time_inc}D), error bar lengths are longer than the acceptable 20% amount in all cells. Therefore, with time-interval increasing spacing, precision remains low for the estimation of the random-effect day-unit parameters across all measurement number values. 

In summary, with time-interval increasing spacing, high precision is achieved in the estimation of the fixed-effect day-unit parameters across all manipulated nature-of-change values with nine or more measurements, but no manipulated measurement number achieves high precision in the estimation of the random-effect day-unit parameters. 

One additional minor point should be mentioned. In Figure \ref{fig:exp1_plot_time_inc}D when the population value set for the days-to-halfway elevation parameter ($\upbeta_{fixed}$) is 80 (within the dashed rectangle), error bar lengths counterintuitively increase in the estimation of the the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) as the number of measurements increases from five to seven. Inspection of the underlying density plots for the random-effect triquarter-halfway delta parameter in Figure \ref{fig:exp1_density_time_increasing}C shows that the increase in error bar length is not due to outliers and, rather, occurs because of a slight increase in the variability of estimated values estimates (see the shaded portion of the density distributions).

```{=tex}
\begin{figure} [H]
  \caption{Density Plots of the Random-Effect Halfway-Triquarter Delta ($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_inc}D) With Time-Interval Increasing Spacing in Experiment 1 (95\% Error Bars)}
  \label{fig:exp1_density_time_increasing}
  \includegraphics[height = 15cm, width = 25cm]{Figures/density_plots_time_inc_exp1} \hfill{}
  \caption*{Note. \textup{Regions shaded in in gray represent the the middle 95\% of estimated values and the width of the shaded regions is indicated by the length of the horizontal error bars. The error bar length increases as the number of measurements increases from five to seven.}}
\end{figure}
```


##### Modelling Accuracy Across Nature-of-Change Values {#nature-change-time-inc-exp1}

For time-interval increasing spacing, Table \ref{tab:errorbar-time-inc-nc} lists the error bar lengths for each day-unit parameter and nature-of-change value. Although modelling accuracy is determined by bias and precision, results for bias are not discussed or computed because the differences in bias across the nature-of-change values are negligible. Note that error bar lengths are computed by computing the average length across all manipulated number-of-measurement values. The column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths under equal spacing. Across all the manipulated nature-of-change values, errorbar lengths are shortest with a nature-of-change value of 80. 

```{r errorbar-time-inc-nc, echo=F}
param_midpoint_time_inc <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'increasing')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)

param_midpoint_time_inc$parameter <- factor(x = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_time_inc}A)', 
                                        '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_time_inc}B)', 
                                        '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_time_inc}C)', 
                                       '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_time_inc}D)'))



kbl(x = param_midpoint_time_inc, format = 'latex',digits = 2, 
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c('l', rep('c', times = ncol(param_midpoint_time_inc) - 1)), 
    col.names = c('Parameter', '80', '180', '280'), 
    caption = 'Error Bar Lengths Across Nature-of-Change Values Under Time-Interval Increasing Spacing in Experiment 1') %>%
  
    #header
    add_header_above(header = c(' ' = 1, 'Population Value of $\\\\upbeta_{fixed}$' = 3), escape = F) %>%
    column_spec(column = 2, background = '#DFDEDE') %>%
    column_spec(column = 1, width = '4cm') %>%
    column_spec(column = c(2:4), width = '3cm') %>%

  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1pc}',
           general = "Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\{80, 180, 280\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all number-of-measurement (NM) values (NM $\\\\in$ \\\\{5, 7, 9, 11\\\\}). Column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths.") %>%
  kable_styling(position = 'left')
```

##### Qualitative Summary 
```{r echo=F} 
errorbar_lengths <- c(errorbar_lengths_nm7$errorbar_length[1], errorbar_lengths_nm9$errorbar_length[2], 
                     errorbar_lengths_nm7$errorbar_length[3], errorbar_lengths_nm9$errorbar_length[4])
```

For time-interval increasing spacing in Figure \ref{fig:exp1_plot_equal}, although no manipulated measurement number achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) are achieved using moderate measurements numbers. With respect to bias under time-interval increasing spacing, the largest improvements across all manipulated nature-of-change values in bias occur with the following measurement numbers for the random-effect day-unit parameters: 

* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements
* random-effect triquarter-halfway delta parameters ($\upgamma_{random}$): nine measurements

\noindent With respect to precision under time-interval increasing spacing, the largest improvements precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved with following measurement numbers:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[1]` days.
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[2]` days.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[4]` days. 

\noindent Therefore, for time-interval increasing spacing, nine measurements achieves the greatest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values. 


### Time-Interval Decreasing Spacing
#### Concise Summary  

For time-interval decreasing spacing, Table \ref{tab:summary-table-time-dec-exp1} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp1_plot_time_dec} for the corresponding parameter estimation plots). Text within the 'Low Bias' and 'High Precision' columns indicates the number of measurements needed to, respectively, achieve low bias and high precision across all manipulated nature-of-change values.  Bolded text in the 'Low Bias' and 'Qualitative Summary' columns indicates the measurement number that, respectively, achieves low bias and the greatest improvements in bias and precision across all day-unit parameters and manipulated nature-of-change values. The 'Error Bar Length' column indicates the error bar length that results from using the measurement number that achieves the greatest improvements in bias and precision. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values.

With respect to bias under time-interval decreasing spacing, it is low in all cells for every day-unit parameter except the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$), where bias is low across all manipulated nature-of-change values with eleven measurements. Therefore, with time-interval decreasing spacing, low bias can be achieved in the estimation of all day-unit parameters using using nine measurements. 

With respect to precision under time-interval decreasing spacing, a pattern different from that with bias occurs. For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), precision is high across all manipulated nature-of-change values using seven or more measurements. For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$), precision is high across all manipulated nature-of-change values using nine or more measurements. For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$]), precision is low in all cells. Therefore, with time-interval decreasing spacing, although the fixed-effect day-unit parameters can be estimated with high precision across all manipulated nature-of-change values using nine or more measurements, no manipulated measurement number allows the random-effect day-unit parameters to be modelled with high precision.  

In summarizing the results for time-interval decreasing spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using nine or more measurements (see [bias](#bias-time-dec-exp1)). High precision is never achieved in the estimation of all day-unit parameters with any manipulated measurement (see [precision](#precision-time-dec-exp1)). With respect to modelling accuracy across the manipulated nature-of-change values, time-interval decreasing spacing obtains the greatest modelling accuracy with a nature-of-change value of 280 (see [nature-of-change modelling accuracy]({#nature-change-time-dec-exp1})). Although it may be discouraging that no manipulated measurement number under time-interval decreasing spacing achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters are achieved with moderate measurement numbers. With time-interval decreasing spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved using nine measurements (for discussion, see [qualitative summary](#qualitative-time-dec-exp1)). 


```{r summary-table-time-dec-exp1, echo=F}
errorbar_lengths_nm7 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 7)
errorbar_lengths_nm9 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 7)

errorbar_lengths <- c(errorbar_lengths_nm7$errorbar_length[1], 
                      errorbar_lengths_nm9$errorbar_length[2], 
                      errorbar_lengths_nm7$errorbar_length[3], 
                      errorbar_lengths_nm9$errorbar_length[4])

summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_dec}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_dec}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_dec}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_dec}D)}'), 
                            
                            'Low Bias' = c('All cells', 
                                       'NM $\\ge$ 7', 
                                       'NM $\\ge$ 7', 
                                       '\\textbf{NM $\\boldsymbol{\\ge}$ 9}'), 
                            
                            'High Precision' = c('NM $\\ge$ 7', 
                                            'NM $\\ge$ 9', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Summary' = c('Largest improvements in precision with \\textbf{NM = 9}', 
                                                      'Largest improvement in precision with \\textbf{NM = 9}', 
                                                      'Largest improvement in bias and precision with \\textbf{NM = 9}', 
                                                      'Largest improvements in bias and precision with \\textbf{NM = 9}'), 
                            'Error Bar Length' = errorbar_lengths,
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Concise Summary of Results for Time-Interval Decreasing Spacing in Experiment 1', 
 align = c(rep('l', times = ncol(summary_table)))) %>%
   #header
  column_spec(column = 1, width = '2cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '4cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Summary' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.2pc}',
           general = "Bolded text in the `Low Bias' and `Qualitative Summary' columns indicates the number of measurements needed to, respectively, achieve low bias and the greatest improvements in bias and precision across all day-unit parameters (high precision not achieved in the estimation of all day-unit parameters with time-interval decreasing spacing). `Error Bar Length' indicates the longest error bar length that results from using the measurement number in the `Qualitative Summary` column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')
```

#### Detailed Report

For time-interval decreasing spacing, Figure \ref{fig:exp1_plot_time_dec} and Table \ref{tab:omega-exp1-time-dec} show the results. Figure \ref{fig:exp1_plot_time_dec} shows the parameter estimation plots for each day-unit parameter and  Table \ref{tab:omega-exp1-time-dec} provides the partial $\upomega^2$ values for each independent variable of each day-unit parameter. In Figure \ref{fig:exp1_plot_time_dec}, error bars represent the middle 95% of estimated values, blue horizontal lines indicate the population values for each parameter (with population values of $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00), and gray bands specify the acceptable margins of error (i.e., 10% of the parameter's population value). I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20% of the parameter's population value as indicative of low-precision estimation. Panels A--B show the parameter estimation plots for the fixed- and random-effect days-to-halfway elevation parameters ($\upbeta_{fixed}$ and $\upbeta_{random}$, respectively). Panels C--D show the parameter estimation plots for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively). Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Importantly, across all population values used for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180.

##### Bias {#bias-time-dec-exp1}

For all simulations pertaining to time-interval decreasing spacing (see Figure \ref{fig:exp1_plot_time_dec}), instances of high bias occur in the estimation of all day-unit parameters except the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_dec}). The gray bands indicate the $\pm 10\%$ margin of error. I classified dots that fell outside the gray band as biased and these dots remained unfilled. Note that the gray 10% margin of error bands for the random-effect parameters in Figures \ref{fig:exp1_plot_time_dec}C--D are difficult to see because 10% of the parameters' population values yield small values relative to the range of the y-axis (i.e., 10% of 4.00 is 0.40 and 10% of 10 is 1.00, which are both small relative to the y-axis range of 55). 

For the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_dec}B), dots only fall outside the gray 10% margin of error band on the five-measurements line (squares) at a nature-of-change value of 80 (shown on x-axis). Therefore, using time-interval decreasing spacing, low bias can be achieved in the estimation of the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$) across all nature-of-change values by using seven or more measurements.

For the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp1_plot_time_dec}C), dots only fall outside the gray 10% margin of error band on the five-measurements line (squares) at a nature-of-change value of 80 (shown on x-axis). Therefore, using time-interval decreasing spacing, low bias can be achieved in the estimation of the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$) across all nature-of-change values by using seven or more measurements.

For the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_dec}D), dots fall outside the gray 10% margin of error band at on the five-measurements line (squares) across all manipulated nature-of-change values (shown on x-axis) and on the seven-measurements line (circles) at nature-of-change values of 80 and 180. Therefore, using time-interval decreasing spacing, low bias can be achieved in the estimation of the random-effect halfway-triquarter delta parameter ($\upgamma_{random}$) across all nature-of-change values by using nine or more measurements. 

In summary, with time-interval decreasing spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using nine or more measurements. 

```{r plots-time-decreasing-exp1, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Time-interval decreasing',
                                x_axis_name = expression("Population Value Set for"~beta[fixed]),
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -60, beta_upper = 80,  beta_ticks = 10)
```

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Time-Interval Decreasing Spacing in Experiment 1}
  \label{fig:exp1_plot_time_dec}
  \includegraphics{Figures/exp1_plot_days_time-interval decreasing_mod} \hfill{}
\end{figure}
\begin{figure}[H]
\caption*{Note. \textup{Panel A: Parameter estimation plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Parameter estimation plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Parameter estimation plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Parameter estimation plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating cells with variability greater than 20\% of the parameter's population value. I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20\% of the parameter's population value as indicative of low-precision estimation. Note that random-effect parameter units are in standard deviation units. Importantly, across all nature-of-change values (i.e., population values used for $\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180. See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:omega-exp1-time-dec} for $\upomega^2$ effect size values.}}
\end{figure}
```

\newpage
```{r omega-exp1-time-dec, echo=F}
print_bias_var_omega_table(exp_data = exp_1_raw, target_col = 'measurement_spacing', target_value = 'time_dec', 
ind_vars = c('number_measurements', 'midpoint'), 
ind_var_acronyms = c('NM', 'NC', 'NM x NC'), 
caption = 'Partial $\\upomega^2$ Values for Manipulated Variables With Time-Interval Decreasing Spacing in Experiment 1',
footnote = 'NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, NC = nature of change (population value set for $\\\\upbeta_{fixed}$ $\\\\in$ \\\\{80, 180, 280\\\\}), NM x NC = interaction between number of measurements and population value set for $\\\\upbeta_{fixed}$. $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter.', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_time_dec}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_time_dec}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_time_dec}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_time_dec}D)'))
```


##### Precision {#precision-time-dec-exp1}

For all simulations pertaining to time-interval decreasing spacing (see Figure \ref{fig:exp1_plot_time_dec}), instances of low precision occurred in the estimation of all parameters. I considered precision to be low if the length of an error bar covered a range of values larger than 20% of the parameter's population value. Error bars indicating low precision are coloured in light blue. 

For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_dec}A), error bar lengths are longer than the 20% acceptable amount with five measurements (squares) and a nature-of-change value of 80 (shown on x-axis). Therefore, with time-interval decreasing spacing, seven or more measurements are needed to estimate the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) with high precision across all manipulated nature-of-change values.

For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_dec}B), error bar lengths are longer than the 20% tolerated amount with five measurements (squares) across all manipulated nature-of-change values (shown on x-axis) and with seven measurements (circles) across all nature-of-change values. Therefore, with time-interval decreasing spacing, the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) can be estimated with high precision across all manipulated nature-of-change values using nine or more measurements. 

For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] in Figure \ref{fig:exp1_plot_time_dec}C and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp1_plot_time_dec}D), error bar lengths are longer than the acceptable 20% amount in all cells. Therefore, with time-interval decreasing spacing, precision remains low for the estimation of the random-effect day-unit parameters across all measurement number values. 

In summary, with time-interval decreasing spacing, high precision is achieved in the estimation of the fixed-effect day-unit parameters across all manipulated nature-of-change values with nine or more measurements, but no manipulated measurement number achieves high precision in the estimation of the random-effect day-unit parameters. 

```{r exp1-density-plot-time-dec, include=F, eval=F}
##generate figure showing density distributions if gamma_fizxd at N = 500 and N = 1000 with middle 95% area shaded. Emphasize
##that longer error bars in  N = 1000 are likely a statistical artifact of the random number generating procedure. 
exp_1 <- read_csv('data/exp_1_data.csv') %>% filter(code == 0) #load data 
exp_1 <- convert_raw_var_to_sd(raw_data = exp_1) #var to sd conversion 

parameter_names <- c(bquote(expr = bold(A:~gamma[random]~(beta[fixed]~" = 80, 5 measurements"))),
                     bquote(expr =bold(B:~gamma[random]~(beta[fixed]~" = 80, 7 measurements"))))
                     
#1) Extract estimates for four parameter gamma_fixed and beta_rand when N =500 or 1000, num_measurements == 5, spacing == equal. 
##Convert to long format, with parameter name going into unique column and estimate becoming new column 
param_data <- exp_1 %>%
  filter(number_measurements <= 7, measurement_spacing == 'time_dec', midpoint == 80) %>%
  select(locate_ivs(exp_1),'gamma_rand') %>%
  pivot_longer(cols = c(gamma_rand), values_to = 'estimate') %>%
  unite(col = 'parameter', c(number_measurements,name))

#2) Replace parameter values with tag labels. 
param_data$parameter <- factor(param_data$parameter, 
                               levels = c("5_gamma_rand", "7_gamma_rand"), 
                               labels = parameter_names)

base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3, alpha = 0) 

##create density data for each parameter 
density_data <- ggplot_build(plot = base_density_plot)$data[[1]]

param_search_names <- c("A\\:", "B\\:")

param_error_bar_ranges <- lapply(X = param_search_names, compute_ind_param_error_bar_range, param_data = param_data)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


density_time_dec_exp_1 <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 1, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 55, margin = unit(c(t = 0, r = 6, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = density_time_dec_exp_1, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_time_dec_exp1.pdf')

```

```{r exp1-density-plot-time-dec-fixed, include=F, eval=F}
param_error_bar_ranges <- lapply(X = param_search_names, compute_80_ind_param_error_bar_range, param_data = param_data)

#3) Create base density plot so that density data can be created
base_density_plot <- ggplot(data = param_data, mapping = aes(x = estimate, group = parameter)) +
   geom_density(size = 3) 

##create density data for each parameter 
plot_ready_data <- rbindlist(pmap(.l = list(error_bar_range = param_error_bar_ranges, 
               group = 1:length(param_error_bar_ranges), 
               param_name =  as.character(parameter_names)), .f = compute_density, density_data = density_data))
plot_ready_data$parameter <- factor(plot_ready_data$parameter)


time_dec_fixed_density <- base_density_plot +
    scale_x_continuous(limits = c(0, 30), breaks = seq(from = 0, to = 30, by = 5), 
                       name = 'Value of parameter estimate (days)') + 
  
  #shaded filling
      geom_area(data = plot_ready_data, mapping = aes(x = day_value, y = probability), 
                show.legend = 'bin',  fill="grey", alpha = 1, color = 'black', size = 3) + 
    #error bar
    geom_errorbarh(data = plot_ready_data, inherit.aes = F,
                   mapping = aes(xmin = lower_ci, xmax = upper_ci, 
                                 y = max_density_value, height = 0.05), size = 3) + 

    #vertical dashed lines for error bars
    ##lower limit 
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$lower_ci, xend = plot_ready_data$lower_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +
    ##upper limit
    geom_segment(inherit.aes = F, data = plot_ready_data, x = plot_ready_data$upper_ci, xend = plot_ready_data$upper_ci,
                 y = 0, yend = plot_ready_data$max_density_value, linetype = 2, size = 2) +  
    
    #facet_wrap(facets = ~ parameter, nrow = 2, ncol = 2) + 
    
    facet_wrap_custom( ~ parameter, scales = "free", ncol = 1, nrow = 2 ,
                                          dir = 'h', labeller = label_parsed,
                                          scale_overrides = list(scale_override(1,
                                                                                scale_y_continuous(name =  'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, .60))),
                                                                 scale_override(2, scale_y_continuous(name = 'Density (proportion of estimates)',
                                                                                                   breaks = seq(from = 0, to = 0.60, by = 0.10),
                                                                                                   limits = c(0, 0.60))))) + 
  
    #plot aesthetics
    theme_classic() +

    theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 55, margin = unit(c(t = 0, r = 6, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
      axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #panel details
      panel.spacing.y = unit(x = 4, units = 'cm'),
      panel.spacing.x = unit(x = 2, units = 'cm'))
  
  
  #create PDF of faceted plot
  set_panel_size(p = time_dec_fixed_density, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/density_plots_time_dec_exp1_fixed.pdf')

```

One additional minor point should be mentioned. In Figure
\ref{fig:exp1_density_time_decreasing}D when the population value set for the days-to-halfway elevation parameter ($\upbeta_{fixed}$) is 80 (within the dashed rectangle), error bar lengths counterintuitively increase in the estimation of the the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$) as the number of measurements increases from five to seven. Inspection of the underlying density plots for the random-effect triquarter-halfway delta parameter in Figure \ref{fig:exp1_density_time_decreasing}C shows that the increase in error bar length is not due to outliers and, rather, occurs because of a slight increase in the variability of estimated values estimates (see the shaded portion of the density distributions).

```{=tex}
\begin{figure} [H]
  \caption{Density Plots of the Random-Effect Halfway-Triquarter Delta ($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_decreasing}D) With Time-Interval Decreasing Spacing in Experiment 1 (95\% Error Bars)}
  \label{fig:exp1_density_time_decreasing}
  \includegraphics[height = 15cm, width = 30cm]{Figures/density_plots_time_dec_exp1} \hfill{}
  \caption*{Note. \textup{Regions shaded in in gray represent the the middle 95\% of estimated values and the width of the shaded regions is indicated by the length of the horizontal error bars. The error bar length increases as the number of measurements increases from five to seven.}}
\end{figure}
```


##### Modelling Accuracy Across Nature-of-Change Values {#nature-change-time-dec-exp1}

For time-interval decreasing spacing, Table \ref{tab:errorbar-time-dec-nc} lists the error bar lengths for each day-unit parameter and nature-of-change value. Although modelling accuracy is determined by bias and precision, results for bias are not discussed or computed because the differences in bias across the nature-of-change values are negligible. Note that error bar lengths are computed by computing the average length across all manipulated number-of-measurement values. The column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths under equal spacing. Across all the manipulated nature-of-change values, errorbar lengths are shortest with a nature-of-change value of 280. 

```{r errorbar-time-dec-nc, echo=F}
param_midpoint_time_dec <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'decreasing')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)

param_midpoint_time_dec$parameter <- factor(x = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_time_dec}A)', 
                                        '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_time_dec}B)', 
                                        '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_time_dec}C)', 
                                       '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_time_dec}D)'))



kbl(x = param_midpoint_time_dec, format = 'latex',digits = 2, 
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c('l', rep('c', times = ncol(param_midpoint_time_dec) - 1)), 
    col.names = c('Parameter', '80', '180', '280'), 
    caption = 'Error Bar Lengths Across Nature-of-Change Values Under Time-Interval Decreasing Spacing in Experiment 1') %>%
  
    #header
    add_header_above(header = c(' ' = 1, 'Population Value of $\\\\upbeta_{fixed}$' = 3), escape = F) %>%
    column_spec(column = 4, background = '#DFDEDE') %>%
    column_spec(column = 1, width = '4cm') %>%
    column_spec(column = c(2:4), width = '3cm') %>%

  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1pc}',
           general = "Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\{80, 180, 280\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all number-of-measurement (NM) values (NM $\\\\in$ \\\\{5, 7, 9, 11\\\\}). Column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths.") %>%
  kable_styling(position = 'left')
```

##### Qualitative Summary
```{r echo=F}
errorbar_lengths <- c(errorbar_lengths_nm7$errorbar_length[1], 
                      errorbar_lengths_nm9$errorbar_length[2], 
                      errorbar_lengths_nm7$errorbar_length[3], 
                      errorbar_lengths_nm9$errorbar_length[4])
```
For time-interval decreasing spacing in Figure \ref{fig:exp1_plot_time_dec}, although no manipulated measurement number achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) are achieved using moderate measurements numbers. With respect to bias under time-interval decreasing spacing, the largest improvements across all manipulated nature-of-change values in bias occur with the following measurement numbers for the random-effect day-unit parameters: 

* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): seven measurements
* random-effect triquarter-halfway delta parameters ($\upgamma_{random}$): nine measurements

\noindent With respect to precision under time-interval decreasing spacing, the largest improvements precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved with following measurement numbers:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[1]` days.
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[2]` days.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): nine measurements, which results in a maximum bar length of `r errorbar_lengths[4]` days.

\noindent Therefore, for time-interval decreasing spacing, nine measurements achieves the greatest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values. 

### Middle-and-Extreme Spacing

#### Concise Summary 

For middle-and-extreme spacing, Table \ref{tab:summary-table-mid-ext-exp1} provides a concise summary of the results for the day-unit parameters (see Figure \ref{fig:exp1_plot_mid_ext} for the corresponding parameter estimation plots). Text within the 'Low Bias' and 'High Precision' columns indicates the number of measurements needed to, respectively, achieve low bias and high precision across all manipulated nature-of-change values. Bolded text in the 'Low Bias' and 'Qualitative Summary' columns indicates the measurement number that, respectively, achieves low bias and the greatest improvements in bias and precision across all day-unit parameters and manipulated nature-of-change values. The 'Error Bar Length' column indicates the error bar length that results from using the measurement number that achieves the greatest improvements in bias and precision. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values.

With respect to bias under middle-and-extreme spacing, instances of low bias occur for all day-unit parameters except the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$), low bias can be achieved across all manipulated nature-of-change values using seven or more measurements. For the random-effect days-to-halfway elevation parameter  ($\upbeta_{random}$), low bias can be achieved across all manipulated nature-of-change values using nine or more measurements. For the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$), low bias can be achieved across all manipulated nature-of-change values using 11 more measurements.  Therefore, with middle-and-extreme spacing, low bias can be achieved in the estimation of all day-unit parameters using using nine measurements. 

With respect to precision under middle-and-extreme spacing, a pattern different from that with bias occurs. For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), precision is high across all manipulated nature-of-change values using seven or more measurements. For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$), precision is high across all manipulated nature-of-change values using 11 measurements. For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$]), precision is low in all cells. Therefore, with middle-and-extreme spacing, although the fixed-effect day-unit parameters can be estimated with high precision across all manipulated nature-of-change values using 11 measurements, no manipulated measurement number allows the random-effect day-unit parameters to be modelled with high precision.  

In summarizing the results for middle-and-extreme spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using 11 measurements (see [bias](#bias-mid-ext-exp1)). High precision is never achieved in the estimation of all day-unit parameters with any manipulated measurement (see [precision](#precision-mid-ext-exp1)). With respect to modelling accuracy across the manipulated nature-of-change values, middle-and-extreme spacing obtains the greatest modelling accuracy with a nature-of-change value of 80 (see [nature-of-change modelling accuracy]({#nature-change-mid-ext-exp1})). Although it may be discouraging that no manipulated measurement number under middle-and-extreme spacing achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) across all day-unit parameters are achieved with a measurement number value manipulated in the current simulation experiment.  With middle-and-extreme spacing, the largest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved using nine measurements (for discussion, see [qualitative summary](#qualitative-mid-ext-exp1)).


```{r summary-table-mid-ext-exp-1, echo=F}
errorbar_lengths_nm7 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 7)
errorbar_lengths_nm11 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 11)

errorbar_lengths <- c(errorbar_lengths_nm7$errorbar_length[1], 
                      errorbar_lengths_nm7$errorbar_length[2], 
                      errorbar_lengths_nm11$errorbar_length[3], 
                      errorbar_lengths_nm11$errorbar_length[4])

summary_table <- data.frame('Parameter' = c('\\thead[lt]{$\\upbeta_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_mid_ext}A)}',
                                            '\\thead[lt]{$\\gamma_{fixed}$ \\\\ (Figure \\ref{fig:exp1_plot_time_mid_ext}B)}', 
                                            '\\thead[lt]{$\\upbeta_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_mid_ext}C)}', 
                                            '\\thead[lt]{$\\upgamma_{random}$ \\\\ (Figure \\ref{fig:exp1_plot_time_mid_ext}D)}'), 
                            'Low Bias' = c('All cells', 
                                       'NM $\\ge$ 7',
                                       'NM $\\ge$ 9', 
                                       '\\textbf{NM = 11}'), 
                            
                            'High Precision' = c('NM $\\ge$ 7', 
                                            'NM = 11', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Summary' = c('Largest improvements in precision with NM = 7', 
                                                      'Largest improvements in bias and precision with NM = 7', 
                                                      'Largest improvements in bias and precision with \\textbf{NM = 9}', 
                                                      'Largest improvements in bias and precision with NM = 7'), 
                            'Error Bar Length' = errorbar_lengths, 
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Concise Summary of Results for Middle-and-Extreme Spacing in Experiment 1', 
    align = c(rep('l', times = ncol(summary_table)))) %>%
   #header
  column_spec(column = 1, width = '2cm') %>%
  column_spec(column = 2, width = '5cm') %>%
  column_spec(column = 3, width = '4cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5, width = '3cm') %>%
  add_header_above(header = c(' ' = 3, 'Summary' = 2)) %>%
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.2pc}',
           general = "Bolded text in the `Low Bias' and `Qualitative Summary' columns indicates the number of measurements needed to, respectively, achieve low bias and the greatest improvements in bias and precision across all day-unit parameters (high precision not achieved in the estimation of all day-unit parameters with middle-and-extreme spacing). `Error Bar Length' indicates the longest error bar length that results from using the measurement number in the `Qualitative Summary` column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all nature-of-change values. NM = number of measurements.") %>% 
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')
```

#### Detailed Report

For middle-and-extreme spacing, Figure \ref{fig:exp1_plot_time_mid_ext} and Table \ref{tab:omega-exp1-mid-ext} show the results. Figure \ref{fig:exp1_plot_time_mid_ext} shows the parameter estimation plots for each day-unit parameter and  Table \ref{tab:omega-exp1-time-dec} provides the partial $\upomega^2$ values for each independent variable of each day-unit parameter. In Figure \ref{fig:exp1_plot_time_mid_ext}, error bars represent the middle 95% of estimated values, blue horizontal lines indicate the population values for each parameter (with population values of $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, and $\upgamma_{random}$ = 4.00), and gray bands specify the acceptable margins of error (i.e., 10% of the parameter's population value). I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20% of the parameter's population value as indicative of low-precision estimation. Panels A--B show the parameter estimation plots for the fixed- and random-effect days-to-halfway elevation parameters ($\upbeta_{fixed}$ and $\upbeta_{random}$, respectively). Panels C--D show the parameter estimation plots for the fixed- and random-effect triquarter-halfway delta parameters ($\upgamma_{fixed}$ and $\upgamma_{random}$, respectively). Note that, in Panel A, estimates for $\upbeta_{fixed}$ are centered around their corresponding population values (80, 180, and 280 days), and so the y-axis represents error (in number of days) from the population value. Importantly, across all population values used for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180.


##### Bias {#bias-mid-ext-exp1}

For all simulations pertaining to middle-and-extreme spacing (see Figure \ref{fig:exp1_plot_time_mid_ext}), instances of high bias occur in the estimation of all day-unit parameters except the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). The gray bands indicate the $\pm 10\%$ margin of error. I classified dots that fell outside the gray band as biased and these dots remained unfilled. Note that the gray 10% margin of error bands for the random-effect parameters in Figures \ref{fig:exp1_plot_time_mid_ext}C--D are difficult to see because 10% of the parameters' population values yield small values relative to the range of the y-axis (i.e., 10% of 4.00 is 0.40 and 10% of 10 is 1.00, which are both small relative to the y-axis range of 55). 

For the fixed-effect halfway-triquarter delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_mid_ext}B), dots fall outside the gray 10% margin of error band on the five-measurements line (squares) at a nature-of-change value of 80 and 280 (shown on x-axis). Therefore, using middle-and-extreme spacing, low bias can be achieved in the estimation of the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$) across all nature-of-change values by using seven or more measurements.

For the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$; Figure \ref{fig:exp1_plot_time_mid_ext}C), dots fall outside the gray 10% margin of error band on the five-measurements line (squares) at nature-of-change values of 80 and 280 (shown on x-axis) and on the seven-measurements line (circles) at nature-of-change values of 80 and 280. Therefore, using middle-and-extreme spacing, low bias can be achieved in the estimation of the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$) across all nature-of-change values by using seven or more measurements. 

For the random-effect triquarter-halfway delta parameter ($\upgamma_{random}$; Figure \ref{fig:exp1_plot_time_mid_ext}C), dots fall outside the gray 10% margin of error band on the five-measurements line (squares) at nature-of-change values of 80 and 280 (shown on x-axis), on the seven-measurements line (circles) at nature-of-change values of 80 and 280, and on the nine-measurements line (triangles) at nature-of-change values of 80 and 280. Therefore, using middle-and-extreme spacing, low bias can be achieved in the estimation of the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$) across all nature-of-change values by using 11 measurements. 

In summary, with middle-and-extreme spacing, low bias is achieved in the estimation of all day-unit parameters across all manipulated nature-of-change values using 11 measurements. 

```{r plots-mid-ext-exp1, include=F, eval=F}
generate_day_likert_facet_plot(analytical_data = exp_1_analytical, target_col = 'measurement_spacing', target_value = 'Middle-and-extreme spacing',
                                x_axis_name = expression("Population Value Set for"~beta[fixed]), 
                                x_axis_var = 'midpoint', exp_num = 'exp1_', beta_lower = -80, beta_upper = 80, beta_ticks = 20)
```

```{=tex}
\begin{figure}[H]
  \caption{Parameter Estimation Plots for Day-Unit Parameters With Middle-and-Extreme Spacing in Experiment 1}
  \label{fig:exp1_plot_time_mid_ext}
  \includegraphics{Figures/exp1_plot_days_middle-and-extreme spacing} 
\end{figure}
\begin{figure}[H]
\caption*{Note. \textup{Panel A: Parameter estimation plot for the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$). Panel B: Parameter estimation plot for the fixed-effect triquarter-halfway elevation parameter ($\upgamma_{fixed}$). Panel C: Parameter estimation plot for the random-effect days-to-halfway elevation parameter ($\upbeta_{random}$). Panel D: Parameter estimation plot for the random-effect triquarter-halfway elevation parameter ($\upgamma_{random}$). Blue horizontal lines in each panel represent the population value for each parameter. Population values for each day-unit parameter are as follows: $\upbeta_{fixed}$ = 180.00, $\upbeta_{random}$ = 10.00, $\upgamma_{fixed}$ = 20.00, $\upgamma_{random}$ = 4.00. Gray bands indicate the $\pm 10\%$ margin of error for each parameter and unfilled dots indicate cells with average parameter estimates outside of the margin. Error bars represent the middle 95\% of estimated values, with light blue error bars indicating cells with variability greater than 20\% of the parameter's population value. I considered dots that fell outside the gray bands as biased and error bar lengths that exceeded 20\% of the parameter's population value as indicative of low-precision estimation. Note that random-effect parameter units are in standard deviation units. Importantly, across all nature-of-change values (i.e., population values used for $\upbeta_{fixed}$), the acceptable amount of bias and precision was based on a population value of 180.See Table \ref{tab:exp1-alpha-theta-param-est} for specific values estimated for each parameter and Table \ref{tab:omega-exp1-mid-ext} for $\upomega^2$ effect size values.}}
\end{figure}
```

\newpage
```{r omega-exp1-mid-ext, echo=F}
print_bias_var_omega_table(exp_data = exp_1_raw, target_col = 'measurement_spacing', target_value = 'mid_ext', 
ind_vars = c('number_measurements', 'midpoint'), 
ind_var_acronyms = c('NM', 'NC', 'NM x NC'), 
caption = 'Partial $\\upomega^2$ Values for Manipulated Variables With Middle-and-Extreme Spacing in Experiment 1',
footnote = 'NM = number of measurements $\\\\in$ \\\\{5, 7, 9, 11\\\\}, NC = nature of change (population value set for $\\\\upbeta_{fixed}$ $\\\\in$ \\\\{80, 180, 280\\\\}), NM x NC = interaction between number of measurements and population value set for $\\\\upbeta_{fixed}$. $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter,
           $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter, 
           $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter, and 
           $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter.', 
parameter_labels = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_time_mid_ext}A)',
                     '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_time_mid_ext}B)',
                     '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_time_mid_ext}C)',
                     '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_time_mid_ext}D)'))
```

##### Precision {#precision-mid-ext-exp1}

For all simulations pertaining to middle-and-extreme spacing (see Figure \ref{fig:exp1_plot_time_mid_ext}), instances of low precision occurred in the estimation of all parameters. I considered precision to be low if the length of an error bar covered a range of values larger than 20% of the parameter's population value. Error bars indicating low precision are coloured in light blue. 

For the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$; Figure \ref{fig:exp1_plot_time_mid_ext}A), error bar lengths are longer than the 20% acceptable amount with five measurements (squares) at nature-of-change values of 80 and 280 (shown on x-axis). Therefore, with time-interval decreasing spacing, seven or more measurements are needed to estimate the fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$) with high precision across all manipulated nature-of-change values.

For the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$; Figure \ref{fig:exp1_plot_time_mid_ext}B), error bar lengths are longer than the 20% tolerated amount with five measurements (squares), seven measurements (circles), and nine measurements (triangles) at nature-of-change values of 80 and 280 (shown on x-axis). Therefore, with middle-and-extreme spacing, the fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$) can be estimated with high precision across all manipulated nature-of-change values using 11 measurements. 

For the random-effect day-unit parameters (random-effect days-to-halfway elevation parameter [$\upbeta_{random}$] in Figure \ref{fig:exp1_plot_time_mid_ext}C and the random-effect triquarter-halfway delta parameter [$\upgamma_{random}$] in Figure \ref{fig:exp1_plot_time_mid_ext}D), error bar lengths are longer than the acceptable 20% amount in all cells. Therefore, with middle-and-extreme spacing, precision remains low for the estimation of the random-effect day-unit parameters across all measurement number values. 

In summary, with middle-and-extreme spacing, high precision is achieved in the estimation of the fixed-effect day-unit parameters across all manipulated nature-of-change values with 11 measurements, but no manipulated measurement number achieves high precision in the estimation of the random-effect day-unit parameters. 

##### Modelling Accuracy Across Nature-of-Change Values {#nature-change-mid-ext-exp1}


For middle-and-extreme spacing, Table \ref{tab:errorbar-mid-ext-nc} lists the error bar lengths for each day-unit parameter and nature-of-change value. Although modelling accuracy is determined by bias and precision, results for bias are not discussed or computed because the differences in bias across the nature-of-change values are negligible. Note that error bar lengths are computed by computing the average length across all manipulated number-of-measurement values. The column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths under equal spacing. Across all the manipulated nature-of-change values, errorbar lengths are shortest with a nature-of-change value of 180. 

```{r errorbar-mid-ext-nc, echo=F}
param_midpoint_mid_ext <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'Middle-and')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)

param_midpoint_mid_ext$parameter <- factor(x = c('$\\upbeta_{fixed}$ (Figure \\ref{fig:exp1_plot_mid_extt}A)', 
                                        '$\\upgamma_{fixed}$ (Figure \\ref{fig:exp1_plot_mid_ext}B)', 
                                        '$\\upbeta_{random}$ (Figure \\ref{fig:exp1_plot_mid_ext}C)', 
                                       '$\\upgamma_{random}$ (Figure \\ref{fig:exp1_plot_mid_ext}D)'))


kbl(x = param_midpoint_mid_ext, format = 'latex',digits = 2, 
       longtable = T, booktabs = T, centering = T, escape = F,
       align = c('l', rep('c', times = ncol(param_midpoint_mid_ext) - 1)), 
    col.names = c('Parameter', '80', '180', '280'), 
    caption = 'Error Bar Lengths Across Nature-of-Change Values Under Middle-and-Extreme Spacing in Experiment 1') %>%
  
    #header
    add_header_above(header = c(' ' = 1, 'Population Value of $\\\\upbeta_{fixed}$' = 3), escape = F) %>%
    column_spec(column = 3, background = '#DFDEDE') %>%
    column_spec(column = 1, width = '4cm') %>%
    column_spec(column = c(2:4), width = '3cm') %>%

  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1pc}',
           general = "Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter = \\{80, 180, 280\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. Note that error bar lengths were calculated by computing the average error bar length value across all number-of-measurement (NM) values (NM $\\\\in$ \\\\{5, 7, 9, 11\\\\}). Column shaded in gray indicates the nature-of-change value that results in the shortest error bar lengths.") %>%
  kable_styling(position = 'left')
```


##### Qualitative Summary {#qualitative-mid-ext-exp1}

For middle-and-extreme spacing in Figure \ref{fig:exp1_plot_time_mid_ext}, although no manipulated measurement number achieves high precision in the estimation of all day-unit parameters, the largest improvements in precision (and bias) are achieved using moderate measurements numbers. With respect to bias under middle-and-extreme spacing, the largest improvements across all manipulated nature-of-change values in bias occur with the following measurement numbers for the following day-unit parameters:

* random-effect days-to-halfway elevation parameter ($\upgamma_{fixed}$): seven measurements
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): nine measurements
* random-effect triquarter-halfway delta parameters ($\upgamma_{random}$): 11 measurements

\noindent With respect to precision under middle-and-extreme spacing, the largest improvements precision in the estimation of all day-unit parameters across all manipulated nature-of-change values are achieved with following measurement numbers:

* fixed-effect days-to-halfway elevation parameter ($\upbeta_{fixed}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[1]` days.
* fixed-effect triquarter-halfway delta parameter ($\upgamma_{fixed}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[2]` days.
* random-effect days-to-halfway elevation parameter ($\upbeta_{random}$): nine measurements, which results in a maximum error bar length of `r errorbar_lengths[3]` days.
* random-effect triquarter-halfway delta parameter ($\upgamma_{random}$): seven measurements, which results in a maximum error bar length of `r errorbar_lengths[4]` days.

\noindent Therefore, for middle-and-extreme spacing, nine measurements achieves the greatest improvements in bias and precision in the estimation of all day-unit parameters across all manipulated nature-of-change values. 


## Summary of Results Across All Spacing Schedule Levels 

Summary paragraph (what I will present)... 

### When the Nature of Change is Suspected, How Should Measurements be Spaced?

Table \ref{tab:summary-table-exp1-nc} lists the nature-of-change value that results in the highest modelling accuracy for each spacing schedule. Text in the 'Optimal Nature-of-Change Value' column indicates the nature-of-change value that results in the highest modelling accuracy for each spacing schedule. The 'Error Bar Summary' columns list the error bar lengths obtained for each day-unit parameter using the nature-of-change value listed in the 'Optimal Nature-of-Change Value' column.\footnote{Bias values are not presented because the differences across the schedules are negligible.} Note that the error bar lengths are obtained by computing the average error bar length across all manipulated measurement numbers for the optimal nature-of-change value. The following nature-of-change values yield the highest modelling accuracy for each spacing schedule:  

* equal spacing: $\upbeta_{fixed}$ = 180
* time-interval increasing spacing: $\upbeta_{fixed}$ = 80
* time-interval decreasing spacing: $\upbeta_{fixed}$ = 280
* middle-and-extreme spacing: $\upbeta_{fixed}$ = 180

To understand why the modelling accuracy of each spacing schedule is highest with a specific nature-of-change value, it is important to consider the locations on the curve where each schedule samples data points. Figure \ref{fig:midpoint_plot} shows the curves corresponding to the nature-of-change values that result in the highest modelling accuracy for each spacing schedule. Within each panel, points on each curve indicate where each spacing schedule samples data. In Figure \ref{fig:midpoint_plot}A, data are sampled according to the equal spacing schedule. In Figure \ref{fig:midpoint_plot}B, data are sampled according to the time-interval increasing spacing schedule. In Figure \ref{fig:midpoint_plot}C, data are sampled according to the time-interval decreasing spacing schedule. In Figure \ref{fig:midpoint_plot}D, data are sampled according to the middle-and-extreme spacing schedule. Error bar lengths from Table \ref{tab:summary-table-exp1-nc} have been printed on each panel to provide a reference. 

modelling accuracy and nature of change across the spacing schedules, consider Figure  Modelling accuracy benefits when measurements are taken near periods of change \footnote{}.  Two findings to mention: equal vs middle-and-extreme, increasing vs decreasing are mirror images of each other, which explains near-identical error bar lengths. 


```{r summary-table-exp1, echo=F}
#error bar lengths for each spacing schedule
errorbar_lengths_equal <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Equal spacing', num_measurements = 7)$errorbar_length

errorbar_lengths_time_inc_nm9 <- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 9)$errorbar_length

errorbar_lengths_time_dec_nm9<- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 9)$errorbar_length

errorbar_lengths_mid_ext_nm9<- compute_errorbar_lengths(exp_analytical_days = exp_1_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 9)$errorbar_length

#combine vectors into a list 
errorbar_lengths_list <- list('equal' = errorbar_lengths_equal, 
                              'time_inc' = errorbar_lengths_time_inc_nm9, 
                              'time_dec' = errorbar_lengths_time_dec_nm9, 
                              'mid_ext' = errorbar_lengths_mid_ext_nm9)

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))


summary_table <- data.frame('Spacing Schedule' = c('\\thead[lt]{Equal \\\\ Figure \\ref{fig:exp1_plot_equal}}',
                                                   '\\thead[lt]{Time-interval increasing \\\\ Figure \\ref{fig:exp1_plot_time_inc}}', 
                                                   '\\thead[lt]{Time-interval decreasing \\\\ Figure \\ref{fig:exp1_plot_time_dec}}', 
                                                   '\\thead[lt]{Middle-and-extreme \\\\ Figure \\ref{fig:exp1_plot_time_mid_ext}}'), 
                            'Low Bias' = c('NM $\\ge$ 9', 
                                           'NM $\\ge$ 9', 
                                           'NM $\\ge$ 9', 
                                           'NM = 11'), 
                            'High Precision' = c('No cells', 
                                            'No cells', 
                                            'No cells',
                                            'No cells'), 
                            'Qualitative Summary' = c('Largest improvements in bias and precision with NM = 7', 
                                                      'Largest improvements in bias and precision with NM = 9', 
                                                      'Largest improvements in bias and precision with NM = 9', 
                                                      'Largest improvements in bias and precision with NM = 9'), 
                            
                            '$\\upbeta_{fixed}$' = beta_fixed_errorbar_lengths, 
                            '$\\upgamma_{fixed}$' = gamma_fixed_errorbar_lengths, 
                            '$\\upbeta_{random}$' = beta_rand_errorbar_lengths, 
                            '$\\upgamma_{random}$' = gamma_rand_errorbar_lengths, 
                            
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex',
    linesep = c('\\cmidrule{1-8}', '\\cmidrule{1-8}', '\\cmidrule{1-8}'), #\\cmidrule(l{0.25cm}r{0.25cm}){1-8}
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Concise Summary of Results Across All Spacing Schedule Levels in Experiment 1', 
   align = c(rep('l', times = 4), rep('c', times = 4))) %>%
     #header
  column_spec(column = 1, width = '4.86cm') %>%
  column_spec(column = 2, width = '2cm') %>%
  column_spec(column = 3, width = '2cm') %>%
  column_spec(column = 4, width = '7cm') %>%
  column_spec(column = 5:8, width = '1cm') %>%
  add_header_above(header = c(' ' = 4, 'Error Bar Summary' = 4)) %>%
  
  #row highlighting 
  row_spec(1, background = "#DFDEDE") %>%

   #footnotes
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.1pc}',
           general = "`Qualitative Summary' column indicates the number of measurements that obtains the greatest improvements in bias and precision across all day-unit parameters and manipulated nature-of-change values. `Error Bar Summary' columns list the error bar lengths that result for each day-unit parameter using the measurement number listed in the `Qualitative Summary' column. Note that error bar lengths were calculated by computing the average length across all manipulated measurement numbers for the nature-of-chang value listed in the `Optimal Nature-of-Change Value` column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter $\\\\in$ \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. NM = number of measurements.") %>%
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')

```

```{r summary-table-exp1-nc, echo=F}

param_midpoint_equal <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'Equal')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)

#combine vectors into a list 
errorbar_lengths_list <- list('equal' = param_midpoint_equal[[3]], 
                              'time_inc' = param_midpoint_time_inc[[2]], 
                              'time_dec' =  param_midpoint_time_dec[[4]], 
                              'mid_ext' =  param_midpoint_mid_ext[[3]])

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))


summary_table <- data.frame('Spacing Schedule' = c('\\thead[lt]{Equal \\\\ 
                                                   (see Figure \\ref{fig:exp1_plot_equal} and Table \\ref{tab:errorbar-equal-nc})}',
                                                   '\\thead[lt]{Time-interval increasing \\\\ 
                                                   (see Figure \\ref{fig:exp1_plot_time_inc} and Table \\ref{tab:errorbar-time-inc-nc})}', 
                                                   '\\thead[lt]{Time-interval decreasing \\\\ 
                                                   (see Figure \\ref{fig:exp1_plot_time_dec} and Table \\ref{tab:errorbar-time-dec-nc})}', 
                                                   '\\thead[lt]{Middle-and-extreme \\\\ 
                                                   (see Figure \\ref{fig:exp1_plot_time_mid_ext} and Table \\ref{tab:errorbar-mid-ext-nc})}'), 
                            'Optimal Nature-of-Change Value' = c('$\\upbeta_{fixed}$ = 180', 
                                                         '$\\upbeta_{fixed}$ = 80', 
                                                         '$\\upbeta_{fixed}$ = 280', 
                                                         '$\\upbeta_{fixed}$ = 180'), 
                        
                            '$\\upbeta_{fixed}$' = beta_fixed_errorbar_lengths, 
                            '$\\upgamma_{fixed}$' = gamma_fixed_errorbar_lengths, 
                            '$\\upbeta_{random}$' = beta_rand_errorbar_lengths, 
                            '$\\upgamma_{random}$' = gamma_rand_errorbar_lengths, 
                            
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex', digits = 2,
    linesep = c('\\cmidrule{1-6}', '\\cmidrule{1-6}', '\\cmidrule{1-6}'), 
       longtable = T, booktabs = T, centering = T, escape = F,
    caption = 'Nature-of-Change Values That Lead to Highest Modelling Accuracy for Each Spacing Schedule in Experiment 1', 
   align = c(rep('l', times = 1), rep('c', times = 4))) %>%
     #header
    add_header_above(header = c(' ' = 2, 'Error Bar Summary' = 4)) %>%
  column_spec(column = 1, width = '4.86cm') %>%
  column_spec(column = 2, width = '6cm') %>%
  column_spec(column = 3:6, width = '1.5cm') %>%
    footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1pc}',
           general = "`Error Bar Summary' lists error bar lengths for each day-unit parameter such that error bar lenghts are computed by taking the average error bar length value across all the number-of-measurement (NM) values (NM $\\\\in$ \\\\{5, 7, 9, 11\\\\}). Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter $\\\\in$ \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4.") %>%
  kable_styling(position = 'left') %>%
  landscape(margin = '2.54cm')
```

```{r schedule-nc-plot, echo=F, eval=F}
#log function data 
t <- 0:360
theta <- 3
alpha <- 3.32
beta_80 <- 80
beta_180 <- 180
beta_280 <- 280
gamma <- 20

log_function_80 <- theta + (alpha - theta)/((1 + exp((beta_80 - t)/gamma)))
log_function_180 <- theta + (alpha - theta)/((1 + exp((beta_180 - t)/gamma)))
log_function_280 <- theta + (alpha - theta)/((1 + exp((beta_280 - t)/gamma)))
log_function_180b <- theta + (alpha - theta)/((1 + exp((beta_280 - t)/gamma)))

log_func_wide <- data.frame(cbind(t, log_function_180, log_function_80, log_function_280, log_function_180b,
                                  'midpoint_80' = log_function_80,
                                  'midpoint_180' = log_function_180,
                                  'midpoint_280' = log_function_280))

log_func_long <- log_func_wide %>%
  pivot_longer(cols = 2:5,
               #names_pattern = c('^log', '^midpoint'), 
               names_to = c('midpoint'),# 'midpoint_grouping'), 
               values_to = c('curve_value'), 
                names_transform = factor) %>% 
  pivot_longer(cols = 2:4, 
             names_to = c('midpoint_grouping'), 
            values_to = c('curve_value_group'), 
             names_transform = factor)

#add grouping variable for curve_value_group to indicate if the curve is the optimal one or not
##find the rows where the number in midpoint matches that in midpoint_grouping 
#1) Extract number from midpoint column 

log_func_long$optimal <- factor(extract_numeric(x = log_func_long$midpoint) != extract_numeric(x = log_func_long$midpoint_grouping))

log_func_long$midpoint <-  recode_factor(log_func_long$midpoint,   
                                    'log_function_180' = "atop(bold(A:beta[fixed]==180~With~Equal~Spacing), phantom(randomtextforalignment))",
                                    'log_function_80' = "atop(bold(B:beta[fixed]==80~With~`Time-Interval`~ phantom(randomtextfor)), bold(Increasing~Spacing)~phantom(text~forleftaligniextrattt))",
                                    'log_function_280' = "atop(bold(C:beta[fixed]==280~With~`Time-Interval`~ phantom(randomtextfor)), bold(Decreasing~Spacing)~phantom(text~forleftaligniextratta))",
                                    'log_function_180b' = "atop(bold(D:beta[fixed]==180~With~`Middle-and-`~phantom(text~forleftaligni)), bold(`Extreme`~Spacing)~phantom(text~forleftalandalmorerand))")


#spacing schedule data
num_measurements <- 5
time_period <- 360 
smallest_int_length <- 30
schedules <- c('equal', 'time_inc', 'time_dec', 'mid_ext')

list_out <- unlist(do.call(rbind, pmap(.l = list('num_measurements' = num_measurements, 
               'time_period' = time_period, 
               'smallest_int_length' = smallest_int_length, 
               measurement_spacing = schedules), 
     .f = compute_measurement_schedule))[, 2])

measurement_days_wide <- data.frame(matrix(data = list_out, nrow = 4, ncol = num_measurements, byrow = T, 
       dimnames = list(schedules, sprintf('measurement_day_%d', 1:num_measurements)))) %>%
  rownames_to_column(var = 'schedule')

measurement_days_wide$midpoint <- c('180', '80', '280', '180a')

#add midpoint 
measurement_days_wide$midpoint <-  recode_factor(measurement_days_wide$midpoint,  
                                    '180' = "atop(bold(A:beta[fixed]==180~With~Equal~Spacing), phantom(randomtextforalignment))",
                                    '80' = "atop(bold(B:beta[fixed]==80~With~`Time-Interval`~ phantom(randomtextfor)), bold(Increasing~Spacing)~phantom(text~forleftaligniextrattt))",
                                    '280' = "atop(bold(C:beta[fixed]==280~With~`Time-Interval`~ phantom(randomtextfor)), bold(Decreasing~Spacing)~phantom(text~forleftaligniextratta))",
                                    '180a' = "atop(bold(D:beta[fixed]==180~With~`Middle-and-`~phantom(text~forleftaligni)), bold(`Extreme`~Spacing)~phantom(text~forleftalandalmorerand))")

measurement_days_long <- measurement_days_wide %>% 
  pivot_longer(cols = 2:(num_measurements + 1), names_to = 'measurement_num', values_to = 'day_number') %>%
  mutate_if(.predicate = is.character, .funs = factor)

#add curve values; match log_func_long on midpoint and then add the corresponding curve value 
measurement_days_long <- left_join(x = measurement_days_long, y = log_func_long, by = c('midpoint', 'day_number' = 't'))

#data set containing error bar widths for each parameter under each spacing schedule 
param_midpoint_equal <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'Equal')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)


param_midpoint_time_inc <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'increasing')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)


param_midpoint_time_dec <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'decreasing')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)


param_midpoint_mid_ext <- exp_1_analytical$days %>%
  filter(str_detect(string = measurement_spacing, pattern = 'Middle-and')) %>%
  group_by(parameter, midpoint) %>%
  summarize(errorbar_length = mean(errorbar_length, digits = 2)) %>%
            #bias = round(mean(estimate) - mean(pop_value), digits = 2)) %>%
  pivot_wider(names_from = midpoint, values_from =  errorbar_length)


#combine vectors into a list 
errorbar_lengths_list <- list('equal' = round(param_midpoint_equal[[3]], digits = 2),  
                              'time_inc' = round(param_midpoint_time_inc[[2]], digits = 2), 
                              'time_dec' =  round(param_midpoint_time_dec[[4]], digits = 2), 
                              'mid_ext' =  round(param_midpoint_mid_ext[[3]], digits = 2))

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))

equation_data <- data.frame(
  midpoint =c(rep("atop(bold(A:beta[fixed]==180~With~Equal~Spacing), phantom(randomtextforalignment))", times = 4), 
               rep("atop(bold(B:beta[fixed]==80~With~`Time-Interval`~ phantom(randomtextfor)), bold(Increasing~Spacing)~phantom(text~forleftaligniextrattt))", times = 4), 
               rep("atop(bold(C:beta[fixed]==280~With~`Time-Interval`~ phantom(randomtextfor)), bold(Decreasing~Spacing)~phantom(text~forleftaligniextratta))", times = 4), 
               rep("atop(bold(D:beta[fixed]==180~With~`Middle-and-`~phantom(text~forleftaligni)), bold(`Extreme`~Spacing)~phantom(text~forleftalandalmorerand))", times = 4)),
  
  label = c(paste("beta[fixed] == ", beta_fixed_errorbar_lengths[1], sep = ''), 
            paste("gamma[fixed] == ", gamma_fixed_errorbar_lengths[1], sep = ''), 
            paste("beta[random] == ", beta_rand_errorbar_lengths[1], sep = ''), 
            paste("gamma[random] == ", gamma_rand_errorbar_lengths[1], sep = ''), 
            
            paste("beta[fixed] == ", beta_fixed_errorbar_lengths[2], sep = ''), 
            paste("gamma[fixed] == ", gamma_fixed_errorbar_lengths[2], sep = ''), 
            paste("beta[random] == ", beta_rand_errorbar_lengths[2], sep = ''), 
            paste("gamma[random] == ", gamma_rand_errorbar_lengths[2], sep = ''), 
            
            paste("beta[fixed] == ", beta_fixed_errorbar_lengths[3], sep = ''), 
            paste("gamma[fixed] == ", gamma_fixed_errorbar_lengths[3], sep = ''), 
            paste("beta[random] == ", beta_rand_errorbar_lengths[3], sep = ''), 
            paste("gamma[random] == ", gamma_rand_errorbar_lengths[3], sep = ''), 
            
            paste("beta[fixed] == ", beta_fixed_errorbar_lengths[4], sep = ''), 
            paste("gamma[fixed] == ", gamma_fixed_errorbar_lengths[4], sep = ''), 
            paste("beta[random] == ", beta_rand_errorbar_lengths[4], sep = ''), 
            paste("gamma[random] == ", gamma_rand_errorbar_lengths[4], sep = '')), 

  x = c(rep(c(-10, -10, -3, 0), times = 4)),
        #280, 280, 287, 290, 
        #rep(c(80, 80, 87, 90), times = 2)), 
  y = c(rep(c(3.24, 3.20, 3.16, 3.12), times = 4)))


#add optimal spacing midpoint column
midpoint_plot <- ggplot(data = log_func_long, mapping = aes(x = t, y = curve_value_group, 
                                                            group = midpoint_grouping, color = optimal, alpha = optimal)) + 
  geom_line(size = 4) +
  scale_y_continuous(name = 'Curve Value (Likert Units [Scale 1-5])') + 
  geom_point(data = measurement_days_long, aes(x = day_number, y = curve_value_group,
                                               group = midpoint_grouping, color = optimal, alpha = optimal), size = 15) +
  scale_color_manual(name = 'Optimal Curve?', values = c('#0C0301', '#e0e0e0'),  labels = c('Yes', 'No')) + 
  scale_alpha_manual(name = 'Optimal Curve?', values = c(1, 0.65),labels = c('Yes', 'No')) + 
  
  geom_text(data = equation_data, inherit.aes = F, mapping = aes(x = x, y = y, label = label), parse = T, size = 17.5) +
  facet_wrap_custom( ~ midpoint, scales = "free", ncol = 2, nrow = 2 , dir = 'h',
                     labeller = label_parsed,  

                            scale_overrides = list(
                            scale_override(1,
                              scale_x_continuous(name = 'Measurement Day', 
                                breaks = c(0, 80, 120, 180, 240, 300, 360),
                                limits = c(-60, 360))), 
                          
                             scale_override(which = 2,
                              scale_x_continuous(name = 'Measurement Day', 
                                breaks = c(0, 60, 120, 180, 240, 300, 360),
                                limits = c(-60, 360))), 
                            
                            scale_override(which = 3,
                              scale_x_continuous(name = 'Measurement Day', 
                                breaks = c(0, 60, 120, 180, 280, 360),
                                limits = c(-60, 360))), 
                            
                              
                            scale_override(which = 4,
                              scale_x_continuous(name = 'Measurement Day', 
                                breaks = c(0, 60, 120, 180, 240, 300, 360),
                                limits = c(-60, 360))))) +
  
     
                         
  theme_classic(base_family = 'Helvetica') + 
  theme(
      #panel details
      strip.background = element_rect(fill = "white", color = "white"),
      #original text size = 60, 150 for pre-results figures
      strip.text.x = element_text(face = 'bold', hjust = 0, size = 60, margin = unit(c(t = 0, r = 0, b = 1, l = 0), "cm")),

      #axis details
      axis.text = element_text(size = 60, color = 'black'),
      axis.title = element_text(size = 70),
       
      #axis.title.x.bottom = element_markdown(),
      axis.line = element_line(size = 2),
      axis.ticks.length.x = unit(x = 1, units = 'cm'),
      axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "cm")),
      axis.title.y = element_text(margin = unit(c(t = 0, r = 3, b = 0, l = 0), units = 'cm')),
      axis.ticks = element_line(size = 2, colour = 'black'),
      axis.ticks.length.y =  unit(x = 1, units = 'cm'),

      #legend details
      legend.text = element_text(size = 50),
      legend.margin = margin(unit(c(0, 0, 0, 10), "cm")),
      legend.title = element_text(size = 60),
      legend.key.size = unit(3, 'cm'),
      legend.position = c(0.5, 0.52), 
      legend.direction = 'vertical',
      legend.box.background = element_rect(colour = 'black', size = 3),

      #panel details
      panel.spacing.y = unit(x = 18, units = 'cm'), 
       panel.spacing.x = unit(x = 2, units = 'cm')) 


set_panel_size(p = midpoint_plot, height = unit(x = 28, units = 'cm'),
                 width = unit(x = 40, units = 'cm'),
                 file =  'Figures/midpoint_plot.pdf')
```

```{=tex}
\begin{figure}[H]
  \caption{Nature-of-Change Curves That Result in Highest Modelling Accuracy for Each Spacing Schedule in Experiment 1}
  \label{fig:midpoint_plot}
  \includegraphics{Figures/midpoint_plot} 
\end{figure}
\begin{figure}
 \caption*{Note. \textup{Panel A: Nature of change that results in the the highest modelling accuracy with equal spacing, with dots representing the days where measurements are taken when equal spacing is used. Panel B: Nature of change that results in the the highest modelling accuracy with time-interval increasing spacing, with dots representing the days where measurements are taken when time-interval increasing spacing is used. Panel C: Nature of change that results in the the highest modelling accuracy with time-interval decreasing spacing, with dots representing the days where measurements are taken when time-interval decreasing spacing is used. Panel D: Nature of change that results in the the highest modelling accuracy with middle-and-extreme spacing, with dots representing the days where measurements are taken when middle-and-extreme spacing is used.}}
\end{figure}
```



### When the Nature of Change is Unknown, How Should Measurements be Spaced?

Table \ref{tab:summary-table-exp1} provides a summary of the results for each spacing schedule. Text within the 'Low Bias' column indicates the number of measurements needed to obtain low bias in the estimation of all day-unit parameters across all manipulated nature-of-change values for each spacing schedule. Text within the 'Qualitative Summary' column indicates the number of measurements that obtains the largest improvements in bias and precision across all manipulated nature-of-change values for each spacing schedule. The 'Error Bar Summary' columns list the error bar lengths obtained for each day-unit parameter of the logistic function using the measurement number listed in the 'Qualitative Summary' column. Importantly, the error bar lengths in the 'Error Bar Summary' column are obtained by computing the average length across all manipulated nature-of-change values for the measurement number listed Qualitative Summary' column.  The following number of measurements are needed to obtain low bias and the greatest improvements in bias and precision across all manipulated nature-of-change values for all day-unit parameters under each spacing schedule: 

* equal spacing: nine or more measurements to obtain low bias and seven measurements to obtain the greatest improvements in bias and precision. 
* time-interval increasing spacing: nine or more measurements to obtain low bias and nine measurements to obtain the greatest improvements in bias and precision. 
* time-interval decreasing spacing: nine or more measurements to obtain low bias and nine measurements to obtain the greatest improvements in bias and precision. 
* middle-and-extreme spacing: 11  measurements to obtain low bias and nine measurements to obtain the greatest improvements in bias and precision. 

An important point to mention is that the error bar lengths for each day-unit parameter across each spacing schedule are comparable.  That is, each spacing schedule obtains similar modelling accuracy when using the number of measurements listed in the 'Qualitative Summary` column. Because modelling accuracy is similar across the spacing schedules, then the schedule that uses the fewest number of measurements to obtain the greatest improvements in bias and precision can be said to most effectively model change when the nature of change is unknown. With equal spacing using fewer measurements than all the other manipulated spacing schedules to obtain similar modelling accuracy---using seven measurements instead of the nine measurements use by all other spacing schedules---then equal spacing is the most effective schedule to use when the nature of change is unknown. 


The finding that equal spacing is best is certainly not unexpected.

Also mention that a longitudinal study may need far more measurements that three. 


## Summary of Results Across All Levels of Spacing Schedule Levels (Exp. 2)


```{r summary-table-exp2, echo=F}

#error bar lengths for each spacing schedule
errorbar_lengths_equal <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Equal spacing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_time_inc_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval increasing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_time_dec_nm9_s30 <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Time-interval decreasing', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_mid_ext <- compute_errorbar_lengths(exp_analytical_days = exp_2_analytical$days, iv_level = 'Middle-and-extreme spacing', num_measurements = 5, sample_size = 30)$errorbar_length

#combine vectors into a list 
errorbar_lengths_list <- list('equal' = errorbar_lengths_equal, 
                              'time_inc' = errorbar_lengths_time_inc_nm9_s30, 
                              'time_dec' = errorbar_lengths_time_dec_nm9_s30, 
                              'mid_ext' = errorbar_lengths_mid_ext)

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))


summary_table <- data.frame('Spacing Schedule' = c('Equal (Figure \\ref{fig:exp2_plot_equal})',
                                                   'Time-interval increasing (Figure \\ref{fig:exp2_plot_time_inc})', 
                                                   'Time-interval decreasing (Figure \\ref{fig:exp2_plot_time_dec})', 
                                                   'Middle and extreme (Figure \\ref{fig:exp2_plot_mid_ext})'), 
                            
                            'Low Bias' = c('\\thead[lt]{NM $\\ge$ 7 with \\textit{N}= 1000 or \\\\
                                           NM $\\ge$ 9 with \\textit{N} $\\ge$ 100}', 
                                           
                                           '\\thead[lt]{NM $\\ge$ 9 with \\textit{N} $\\ge$ 200 or \\\\
                                           NM = 11 with \\textit{N} = 1000}', 
                                           
                                           'NM $\\ge$ 9 with \\textit{N}  $\\in$ \\{200, 500\\} or
                                           NM = 11 with \\textit{N} $\\in$ \\{100, 500, 1000\\}', 
                                           
                                           'NM = 11'), 
                            
                            'High Precision' = c('No cells', 
                                            'No cells', 
                                            'No cells',
                                            'No cells'), 
                            
                            'Qualitative Summary' = c('Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100', 
                                                      
                                                       'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100',
                                                      
                                                     'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100',
                                                      
                                                      
                                                      'Largest improvements in bias and precision with NM = 5'), 
                            
                           
                            '$\\upbeta_{fixed}$' = beta_fixed_errorbar_lengths, 
                            '$\\upgamma_{fixed}$' = gamma_fixed_errorbar_lengths, 
                            '$\\upbeta_{random}$' = beta_rand_errorbar_lengths, 
                            '$\\upgamma_{random}$' = gamma_rand_errorbar_lengths, 
                            
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex', 
linesep = c('\\cmidrule{1-8}', '\\cmidrule{1-8}', '\\cmidrule{1-8}'), 
       longtable = T, booktabs = T, centering = T, escape = F,
   align = c(rep('l', times = 4), rep('c', times = 4)),
    caption = 'Concise Summary of Results Across All Spacing Schedule Levels in Experiment 2') %>%
  
     #header
  column_spec(column = 1, width = '4cm') %>%
  column_spec(column = 2, width = '4cm') %>%
  column_spec(column = 3, width = '2cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5:8, width = '1cm') %>%
  add_header_above(header = c(' ' = 4, 'Error Bar Summary' = 4)) %>%

  #footnotes
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.1pc}',
           general = "`Qualitative Summary' column indicates the number of measurements that obtains the greatest improvements in bias and precision across all day-unit parameters. `Error Bar Summary' columns list the longest error bar lengths that result for each day-unit parameter using the measurement number-sample size pairings listed in the `Qualitative Summary' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter $\\\\in$ \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. \\\\textit{N} = sample size, NM = number of measurements.") %>%
  landscape(margin = '2.54cm')

```



## Summary of Results Across All Levels of Time Structuredness (Exp. 3)


```{r summary-table-exp3, echo=F}

#error bar lengths for each spacing schedule
errorbar_lengths_time_struc <- compute_errorbar_lengths(exp_analytical_days = exp_3_analytical$days, iv_level = 'Time structured', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_fast <- compute_errorbar_lengths(exp_analytical_days = exp_3_analytical$days, iv_level = 'fast response', num_measurements = 9, sample_size = 30)$errorbar_length

errorbar_lengths_slow <- compute_errorbar_lengths(exp_analytical_days = exp_3_analytical$days, iv_level = 'slow response', num_measurements = 9, sample_size = 30)$errorbar_length

#combine vectors into a list 
errorbar_lengths_list <- list('time_struc' = errorbar_lengths_time_struc, 
                              'fast' = errorbar_lengths_fast, 
                              'slow' = errorbar_lengths_slow) 

beta_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[1])})))
gamma_fixed_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[2])})))
beta_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[3])})))
gamma_rand_errorbar_lengths <- as.numeric(unlist(lapply(X = errorbar_lengths_list, FUN = function(x){return(x[4])})))


summary_table <- data.frame('Time Structuredness' = c('\\thead[lt]{Time structured \\\\ (Figure \\ref{fig:exp3_plot_days_time_struc})}',
                                                      '\\thead[lt]{Time-unstructured (fast \\\\ response rate) \\\\ (Figure \\ref{fig:exp2_plot_time_inc})}', 
                                                      '\\thead[lt]{Time-unstructured (slow \\\\ response rate) \\\\ (Figure \\ref{fig:exp3_plot_days_slow})}'), 

                            'Low Bias' = c('\\thead[lt]{NM $\\ge$ 9 with \\textit{N} $\\ge$ 100}', 
                                           
                                           'NM = 7 with \\textit{N} = 1000,
                                            NM = 9 with \\textit{N} $\\in$ \\{200, 500\\}, or
                                            NM = 11 with \\textit{N} = 1000', 
                                           
                                           'No cells'), 
                                          
                            'High Precision' = c('No cells', 
                                            'No cells', 
                                            'No cells'), 
                            
                            'Qualitative Summary' = c('Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100', 
                                                      
                                                       'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100',
                                                      
                                                     'Largest improvements in bias and
                                                      precision using NM = 7 with \\textit{N} $\\ge$ 200 or
                                                      NM = 9 with \\textit{N} $\\le$ 100'), 
                            
                            '$\\upbeta_{fixed}$' = beta_fixed_errorbar_lengths, 
                            '$\\upgamma_{fixed}$' = gamma_fixed_errorbar_lengths, 
                            '$\\upbeta_{random}$' = beta_rand_errorbar_lengths, 
                            '$\\upgamma_{random}$' = gamma_rand_errorbar_lengths, 
                            
                            
                            check.names = F)

kbl(x = summary_table, format = 'latex', 
       longtable = T, booktabs = T, centering = T, escape = F,
   align = c(rep('l', times = 4), rep('c', times = 4)), 
   linesep = c('\\cmidrule{1-8}', '\\cmidrule{1-8}', '\\cmidrule{1-8}'), 
    caption = 'Concise Summary of Results Across All Time Structuredness Levels in Experiment 3') %>%
  
     #header
  column_spec(column = 1, width = '4cm') %>%
  column_spec(column = 2, width = '4cm') %>%
  column_spec(column = 3, width = '2cm') %>%
  column_spec(column = 4, width = '6cm') %>%
  column_spec(column = 5:8, width = '1cm') %>%
  add_header_above(header = c(' ' = 4, 'Error Bar Summary' = 4)) %>%

    #footnotes
  footnote(escape = F, threeparttable = T, general_title = '\\\\textit{Note.}\\\\hspace{-1.1pc}',
           general = "`Qualitative Summary' column indicates the number of measurements that obtains the greatest improvements in bias and precision across all day-unit parameters. `Error Bar Summary' columns list the longest error bar lengths that result for each day-unit parameter using the measurement number-sample size pairings listed in the `Qualitative Summary' column. Parameter names and population values are as follows: $\\\\upbeta_{fixed}$ = fixed-effect days-to-halfway elevation parameter $\\\\in$ \\\\{80, 180, 280\\\\}; $\\\\upgamma_{fixed}$ = fixed-effect halfway-triquarter delta parameter = 20; $\\\\upbeta_{random}$ = random-effect days-to-halfway elevation parameter = 10; $\\\\upgamma_{random}$ = random-effect halfway-triquarter delta parameter = 4. \\\\textit{N} = sample size, NM = number of measurements.") %>%
  landscape(margin = '2.54cm')

```


